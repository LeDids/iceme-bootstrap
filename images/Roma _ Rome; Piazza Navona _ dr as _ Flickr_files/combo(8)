YUI.add("hermes-template-footer-full",function(l,e){var t=l.Template.Handlebars.revive({1:function(l,e,t,a,n){var s,o=null!=e?e:{},i=t.helperMissing,r=l.escapeExpression;return'<div class="foot-mobile-banner">\n\t<a class="server-only-link" href="'+r((s=null!=(s=t.pageUrl||(null!=e?e.pageUrl:e))?s:i,"function"==typeof s?s.call(o,{name:"pageUrl",hash:{},data:n}):s))+'">'+r((t.intlMessage||e&&e.intlMessage||i).call(o,{name:"intlMessage",hash:{intlName:"common.TRY_MDOT"},data:n}))+"</a>\n</div>\n"},3:function(l,e,t,a,n){var s,o=null!=e?e:{};return'\t\t<div class="foot-top-row">\n\t\t\t<ul class="foot-nav-ul">\n\n'+(null!=(s=t.if.call(o,null!=e?e.hasNoOptOut:e,{name:"if",hash:{},fn:l.program(4,n,0),inverse:l.noop,data:n}))?s:"")+"\n"+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_about:s,{name:"if",hash:{},fn:l.program(6,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_jobs:s,{name:"if",hash:{},fn:l.program(8,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_blog:s,{name:"if",hash:{},fn:l.program(10,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_mobile:s,{name:"if",hash:{},fn:l.program(12,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_developers:s,{name:"if",hash:{},fn:l.program(14,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_guidelines:s,{name:"if",hash:{},fn:l.program(16,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_privacy:s,{name:"if",hash:{},fn:l.program(18,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_terms:s,{name:"if",hash:{},fn:l.program(20,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_yahoo_safely:s,{name:"if",hash:{},fn:l.program(22,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_feedback:s,{name:"if",hash:{},fn:l.program(24,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_report_abuse:s,{name:"if",hash:{},fn:l.program(26,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_help_forum:s,{name:"if",hash:{},fn:l.program(28,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_language:s,{name:"if",hash:{},fn:l.program(30,n,0),inverse:l.noop,data:n}))?s:"")+"\t\t\t</ul>\n\t\t</div>\n"},4:function(l,e,t,a,n){var s;return'\t\t\t\t<li class="foot-li">\n\t\t\t\t\t<a class="opt-out-www server-only-link" href="'+l.escapeExpression((s=null!=(s=t.pageUrl||(null!=e?e.pageUrl:e))?s:t.helperMissing,"function"==typeof s?s.call(null!=e?e:{},{name:"pageUrl",hash:{},data:n}):s))+'">flickr.com</a>\n\t\t\t\t</li>\n'},6:function(l,e,t,a,n){return'\t\t\t\t<li class="foot-li"><a href="/about" data-track="footer-about">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.ABOUT"},data:n}))+"</a></li>\n"},8:function(l,e,t,a,n){return'\t\t\t\t<li class="foot-li"><a href="/jobs" data-track="footer-jobs">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.JOBS"},data:n}))+"</a></li>\n"},10:function(l,e,t,a,n){return'\t\t\t\t<li class="foot-li"><a href="//blog.flickr.net/en" data-track="footer-blog">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.BLOG"},data:n}))+"</a></li>\n"},12:function(l,e,t,a,n){return'\t\t\t\t<li class="foot-li"><a href="//mobile.yahoo.com/flickr" data-track="footer-mobile">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.MOBILE"},data:n}))+"</a></li>\n"},14:function(l,e,t,a,n){return'\t\t\t\t<li class="foot-li"><a href="/services/developer" data-track="footer-developers">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.DEVELOPERS"},data:n}))+"</a></li>\n"},16:function(l,e,t,a,n){return'\t\t\t\t<li class="foot-li"><a href="/help/guidelines" data-track="footer-guidelines">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.GUIDELINES"},data:n}))+"</a></li>\n"},18:function(l,e,t,a,n){return'\t\t\t\t<li class="foot-li"><a href="//policies.yahoo.com/privacy/flickr" data-track="footer-privacy">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.PRIVACY"},data:n}))+"</a></li>\n"},20:function(l,e,t,a,n){return'\t\t\t\t<li class="foot-li"><a href="/help/terms" data-track="footer-terms">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.TERMS"},data:n}))+"</a></li>\n"},22:function(l,e,t,a,n){return'\t\t\t\t<li class="foot-li"><a href="//safely.yahoo.com" data-track="footer-safely">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.YAHOO_SAFELY"},data:n}))+"</a></li>\n"},24:function(l,e,t,a,n){return'\t\t\t\t<li class="foot-li"><a href="//yahoo.uservoice.com/forums/211185-us-flickr" data-track="footer-feedback">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.FEEDBACK"},data:n}))+"</a></li>\n"},26:function(l,e,t,a,n){return'\t\t\t\t<li class="foot-li"><a href="/abuse" data-track="footer-abuse">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.REPORT_ABUSE"},data:n}))+"</a></li>\n"},28:function(l,e,t,a,n){return'\t\t\t\t<li class="foot-li"><a href="/help/forum" data-track="footer-forum">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.HELP_FORUM"},data:n}))+"</a></li>\n"},30:function(l,e,t,a,n){var s,o=l.lambda,i=l.escapeExpression;return'\t\t\t\t<li class="foot-li lang-switcher">\n\t\t\t\t\t<a href="/change_language.gne?lang='+i(o(null!=(s=null!=e?e.selectedLang:e)?s.code:s,e))+"&csrf="+i(o(null!=(s=null!=e?e.selectedLang:e)?s.csrf:s,e))+'" data-track="footer-language">'+i(o(null!=(s=null!=e?e.selectedLang:e)?s.name:s,e))+'</a>\n\t\t\t\t\t<span class="arrow"></span>\n\t\t\t\t</li>\n'},32:function(l,e,t,a,n){var s,o=null!=e?e:{};return'\t\t<div class="foot-bottom-row">\n\t\t\t<div class="foot-yahoo">\n\t\t\t\t<ul class="foot-nav-ul">\n'+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.bottom_privacy:s,{name:"if",hash:{},fn:l.program(33,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.bottom_terms:s,{name:"if",hash:{},fn:l.program(35,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.bottom_yahoo_safely:s,{name:"if",hash:{},fn:l.program(38,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.bottom_help:s,{name:"if",hash:{},fn:l.program(40,n,0),inverse:l.noop,data:n}))?s:"")+"\t\t\t\t</ul>\n\t\t\t</div>\n\n"+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.bottom_yahoo_company:s,{name:"if",hash:{},fn:l.program(42,n,0),inverse:l.noop,data:n}))?s:"")+'\n\t\t\t<div class="foot-social">\n\t\t\t\t<ul class="foot-nav-ul">\n'+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.bottom_tumblr:s,{name:"if",hash:{},fn:l.program(44,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.bottom_facebook:s,{name:"if",hash:{},fn:l.program(46,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.bottom_twitter:s,{name:"if",hash:{},fn:l.program(48,n,0),inverse:l.noop,data:n}))?s:"")+"\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n"},33:function(l,e,t,a,n){return'\t\t\t\t\t<li class="foot-li"><a href="//policies.yahoo.com/privacy/flickr" data-track="footer-privacy">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.PRIVACY"},data:n}))+"</a></li>\n"},35:function(l,e,t,a,n){var s,o=null!=e?e:{};return'\t\t\t\t\t<li class="foot-li"><a href="/help/terms" data-track="footer-terms"'+(null!=(s=t.if.call(o,null!=e?e.highlightTerms:e,{name:"if",hash:{},fn:l.program(36,n,0),inverse:l.noop,data:n}))?s:"")+">"+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"common.TERMS"},data:n}))+"</a></li>\n"},36:function(l,e,t,a,n){return' class="highlighted"'},38:function(l,e,t,a,n){return'\t\t\t\t\t<li class="foot-li"><a href="//safely.yahoo.com" data-track="footer-safely">'+l.escapeExpression((t.intlMessage||e&&e.intlMessage||t.helperMissing).call(null!=e?e:{},{name:"intlMessage",hash:{intlName:"common.YAHOO_SAFELY"},data:n}))+"</a></li>\n"},40:function(l,e,t,a,n){var s,o=null!=e?e:{},i=t.helperMissing,r=l.escapeExpression;return'\t\t\t\t\t<li class="foot-li"><a href="//help.yahoo.com/kb/index?page=product&locale='+r((s=null!=(s=t.helpLocaleKey||(null!=e?e.helpLocaleKey:e))?s:i,"function"==typeof s?s.call(o,{name:"helpLocaleKey",hash:{},data:n}):s))+'&y=PROD_FLICKR_DESK&actp=productlink" data-track="footer-help">'+r((t.intlMessage||e&&e.intlMessage||i).call(o,{name:"intlMessage",hash:{intlName:"common.HELP"},data:n}))+"</a></li>\n"},42:function(l,e,t,a,n){return'\t\t\t<div class="foot-company">\n\t\t\t\t'+l.escapeExpression((t.intlHTMLMessage||e&&e.intlHTMLMessage||t.helperMissing).call(null!=e?e:{},{name:"intlHTMLMessage",hash:{intlName:"common.A_YAHOO_COMPANY_WITH_LINK"},data:n}))+"\n\t\t\t</div>\n"},44:function(l,e,t,a,n){return'\t\t\t\t\t<li><a target="_blank" href="http://flickr.tumblr.com/" aria-label="Tumblr" data-track="footer-tumblr">\n\t\t\t\t\t\t<svg class="ft-icon ft-tumblr"><use xlink:href="#icon-tumblr"></use></svg>\n\t\t\t\t\t</a></li>\n'},46:function(l,e,t,a,n){return'\t\t\t\t\t<li><a target="_blank" href="https://www.facebook.com/flickr" aria-label="Facebook" data-track="footer-facebook">\n\t\t\t\t\t\t<svg class="ft-icon ft-facebook"><use xlink:href="#icon-facebook"></use></svg>\n\t\t\t\t\t</a></li>\n'},48:function(l,e,t,a,n){return'\t\t\t\t\t<li><a target="_blank" href="https://twitter.com/flickr" aria-label="Twitter" data-track="footer-twitter">\n\t\t\t\t\t\t<svg class="ft-icon ft-twitter"><use xlink:href="#icon-twitter"></use></svg>\n\t\t\t\t\t</a></li>\n'},compiler:[7,">= 4.0.0"],main:function(l,e,t,a,n){var s,o=null!=e?e:{};return(null!=(s=t.if.call(o,null!=e?e.isOptedOutOfMobile:e,{name:"if",hash:{},fn:l.program(1,n,0),inverse:l.noop,data:n}))?s:"")+"\n"+l.escapeExpression((t.outlet||e&&e.outlet||t.helperMissing).call(o,null!=e?e["privacy-footer-view"]:e,{name:"outlet",hash:{},data:n}))+'\n\n<footer class="foot">\n\t<div class="foot-container" role="contentinfo">\n'+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.top_row:s,{name:"if",hash:{},fn:l.program(3,n,0),inverse:l.noop,data:n}))?s:"")+(null!=(s=t.if.call(o,null!=(s=null!=e?e.elements:e)?s.bottom_row:s,{name:"if",hash:{},fn:l.program(32,n,0),inverse:l.noop,data:n}))?s:"")+'\t</div>\n</footer>\n\n<span id="tgt"><div id="tgtRS"></div></span>\n'},useData:!0}),a={};l.Array.each([],function(e){var t=l.Template.get("hermes/"+e);t&&(a[e]=t)}),l.Template.register("hermes/footer-full",function(e,n){return n=n||{},n.partials=n.partials?l.merge(a,n.partials):a,t(e,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("dropdown",function(e){"use strict";var t;t={css:{closed:"ui-dropdown-closed",shim:"ui-dropdown-shim",label:'span[data-action="toggle"]',items:"[data-value]",itemSelected:"ui-dropdown-item-selected",hasDialogArrow:"ui-dropdown-has-dialog-arrow",dialogArrow:"ui-dialog-arrow",useCheckMarks:"ui-dropdown-use-checkboxes"},options:{hasDialogArrow:!1,useCheckMarks:!1}},e.namespace("Views").Dropdown=e.Base.create("Dropdown",e.FlickrView,[],{initializer:function(e){!1!==e.activate&&this.activate()},activate:function(){var s,i=this,a=this.get("container");if(this.close(),this._items={},e.Lang.isArray(this.get("selected"))||this.set("selected",[this.get("selected")]),a.all(t.css.items).each(function(e){var t=e.getData();i._items[t.value]={text:t.text||'no data-text for "'+t.value+'"',sub:t.sub,node:e}}),this.labelEl=a.one(t.css.label),this.labelEl||(this.labelEl=e.Node.create('<span class="truncate" data-action="toggle" tabindex="0" aria-haspopup="true" aria-expanded="false" />'),a.insert(this.labelEl,0)),s=this.get("staticLabel")||this.get("defaultLabel"),s&&(!0===s?this.labelEl.set("text","set staticLabel/defaultLabel to a string, not `true`"):this.labelEl.set("text",s)),this.get("hasDialogArrow")&&!a.hasClass(t.css.hasDialogArrow)&&a.addClass(t.css.hasDialogArrow),a.hasClass(t.css.hasDialogArrow)&&(this.dialogArrowEl=a.one(t.css.dialogArrow),this.dialogArrowEl||(this.dialogArrowEl=e.Node.create('<span class="ui-dialog-arrow" />'),a.insert(this.dialogArrowEl,1))),this.get("useCheckMarks")&&!a.hasClass(t.css.useCheckMarks)&&a.addClass(t.css.useCheckMarks),this.select(),this.get("disabled"))return this.disable();this.attachEvents({":toggle":this.toggle.bind(this),":set":this.setData.bind(this)}),this.registerEventHandler(this.labelEl.on("key",this.toggle,"down:13",this)),this.registerEventHandler(this.labelEl.on("key",this.enterDropdown,"down:40",this));var l=this.labelEl.next("ul");l&&(this.registerEventHandler(l.on("keydown",this.keyboardNavigation,this)),this.registerEventHandler(l.delegate("key",function(e){document.activeElement.dataset&&this.setData(e,document.activeElement.dataset)},"down:13","li",this)))},setData:function(t,s){if(t.halt(),!this.get("multiSelect")&&!this.get("multiSelectSub")&&e.Array.indexOf(this.get("selected"),s.value)>=0)return this.close();this.select(s.value,s)},select:function(s,i,a){var l,n=this,h=s?this._items[s]:null,o=!0,c=[];h&&e.Array.indexOf(this.get("selected"),s)>=0&&(this.get("multiSelect")||this.get("multiSelectSub"))?(c=this.get("selected"),!h.sub&&this.get("multiSelect")&&c.length>this.get("minimumSelected")?(c.splice(e.Array.indexOf(this.get("selected"),s),1),o=!1):h.sub&&(c.splice(e.Array.indexOf(this.get("selected"),s),1),o=!1),this.set("selected",c)):h&&(h.sub?(c.push(s),this.get("selectParent")&&c.push(h.sub),e.Array.each(this.get("selected"),function(e){n._items[e].sub===h.sub?c.push(e):n.get("multiSelect")&&!n._items[e].sub&&c.push(e)})):this.get("multiSelect")?(c=this.get("selected"),c.push(s)):c.push(s),this.set("selected",c)),a||this.close(),l={clicked:h?{text:h.text,value:s,sub:h.sub,itemEl:h.node,isChecked:o}:null,data:i,selections:c},this.fire("selected",l),this.update(s,l,t)},update:function(t,s,i){var a=this,l=s.clicked,n=this.get("selected"),h=this.get("defaultLabel")||"[Unable to select a default item]";this.get("staticLabel")||(this.get("labelFunction")?h=this.get("labelFunction").apply(this,[t]):l?h=s.data&&s.data.text&&s.data.text!==l.text?s.data.text:l.text:n.length>0&&a._items[n[0]]&&(h=a._items[n[0]].text),this.labelEl.set("textContent",h||"[!empty data-text!]")),this.get("container").all(i.css.items).removeClass(i.css.itemSelected),e.Array.each(n,function(e){a._items[e]&&a._items[e].node.addClass(i.css.itemSelected)})},toggle:function(e){e&&e.halt(),this._open?this.close(e):this.open(e)},open:function(e){var s=this.get("container"),i=0,a=0;this._open=!0,this.get("shouldCreateShim")&&this._shimUp(),s.removeClass(t.css.closed),this.get("autoSizeMenu")&&(i=parseInt(this.labelEl.getComputedStyle("width"),10),a=parseInt(s.one("ul").getComputedStyle("width"),10),i+30>a&&s.one("ul").setStyles({width:i+30})),e&&e.silent||this.fire("open",e);var l=s.one("span:first-child");l&&l.setAttribute("aria-expanded","true")},close:function(e){var s=this.get("container");e&&e.halt(),this._open=!1,this._shimUp(!1),this.fire("close",e),s.addClass(t.css.closed);var i=this.labelEl;i&&i.setAttribute("aria-expanded","false")},enterDropdown:function(e){e.preventDefault();var t=this.labelEl.next("ul").one("li");t&&t.focus()},keyboardNavigation:function(e){var t=e.keyCode,s=38===t||9===t&&e.shiftKey,i=40===t||9===t&&!e.shiftKey,a=e.target.ancestor("li",!0);s&&a&&a.previous("li")?(e.preventDefault(),this.focusOnPreviousItem(e)):i?(e.preventDefault(),a&&a.next("li")&&this.focusOnNextItem(e)):(27===t||s)&&(e.preventDefault(),this.labelEl&&(this.labelEl.focus(),this.close()))},focusOnPreviousItem:function(e){var t=e.target.ancestor("li",!0);if(t){var s=t.previous("li");s&&(s.one("a")?s.one("a").focus():s.focus())}},focusOnNextItem:function(e){var t=e.target.ancestor("li",!0);if(t){var s=t.next("li");s&&(s.one("a")?s.one("a").focus():s.focus())}},_shimUp:function(s){if(!1===s){if(!this._shim)return;return this._shim.detach("click").remove(),void(this._shim=null)}this._shim=e.Node.create("<div />"),this._shim.addClass(t.css.shim),this._shim.on("click",this.close.bind(this)),this.get("container").appendChild(this._shim)},disable:function(){var e=this.get("container");this.set("disabled",!0),this.close(),e.addClass(t.css.disabled),e.detach()},destructor:function(){this._shimUp(!1),this._items=null,this.labelEl=null,this.set("selected",null),this.detachAll()}},{ATTRS:{selected:{value:[]},disabled:{value:!1},hasDialogArrow:{value:!1},useCheckMarks:{value:!1},multiSelect:{value:!1},multiSelectSub:{value:!1},selectParent:{value:!0},minimumSelected:{value:0},staticLabel:{value:!1},defaultLabel:{value:!1},labelFunction:function(){},shouldCreateShim:{value:!0},autoSizeMenu:{value:!0}}})},"@VERSION@",{requires:["flickr-view"]});
YUI.add("hermes-template-fluid-droparound",function(n,e){var t=n.Template.Handlebars.revive({1:function(n,e,t,a,l){return" html"},3:function(n,e,t,a,l){return" subview-droparound"},5:function(n,e,t,a,l){return" menu"},7:function(n,e,t,a,l){return" auto-size"},9:function(n,e,t,a,l){var i,s=null!=e?e:{},r=t.helperMissing,o=n.escapeExpression;return"max-height: "+o((i=null!=(i=t.staticHeight||(null!=e?e.staticHeight:e))?i:r,"function"==typeof i?i.call(s,{name:"staticHeight",hash:{},data:l}):i))+"px; min-height: "+o((i=null!=(i=t.staticHeight||(null!=e?e.staticHeight:e))?i:r,"function"==typeof i?i.call(s,{name:"staticHeight",hash:{},data:l}):i))+"px; "},11:function(n,e,t,a,l){var i;return"width: "+n.escapeExpression((i=null!=(i=t.staticWidth||(null!=e?e.staticWidth:e))?i:t.helperMissing,"function"==typeof i?i.call(null!=e?e:{},{name:"staticWidth",hash:{},data:l}):i))+"px;"},13:function(n,e,t,a,l){return"position: fixed;"},15:function(n,e,t,a,l){return"hide-head"},17:function(n,e,t,a,l){var i,s,r=null!=e?e:{},o=t.helperMissing;return'\t\t\t<div class="content text-only'+(null!=(i=t.if.call(r,null!=e?e.autoSizeToContent:e,{name:"if",hash:{},fn:n.program(7,l,0),inverse:n.noop,data:l}))?i:"")+'" style="'+(null!=(i=(t.ifDefined||e&&e.ifDefined||o).call(r,null!=e?e.contentPadding:e,{name:"ifDefined",hash:{},fn:n.program(18,l,0),inverse:n.noop,data:l}))?i:"")+'">\n\t\t\t\t'+n.escapeExpression((s=null!=(s=t.textMessage||(null!=e?e.textMessage:e))?s:o,"function"==typeof s?s.call(r,{name:"textMessage",hash:{},data:l}):s))+"\n\t\t\t</div>\n"},18:function(n,e,t,a,l){var i;return"padding: "+n.escapeExpression((i=null!=(i=t.contentPadding||(null!=e?e.contentPadding:e))?i:t.helperMissing,"function"==typeof i?i.call(null!=e?e:{},{name:"contentPadding",hash:{},data:l}):i))+"px;"},20:function(n,e,t,a,l){var i,s=null!=e?e:{},r=t.helperMissing;return'\t\t\t<div class="content html-only'+(null!=(i=t.if.call(s,null!=e?e.autoSizeToContent:e,{name:"if",hash:{},fn:n.program(7,l,0),inverse:n.noop,data:l}))?i:"")+'" style="'+(null!=(i=(t.ifDefined||e&&e.ifDefined||r).call(s,null!=e?e.contentPadding:e,{name:"ifDefined",hash:{},fn:n.program(18,l,0),inverse:n.noop,data:l}))?i:"")+'">\n\t\t\t\t'+n.escapeExpression((t.renderTrustedMarkup||e&&e.renderTrustedMarkup||r).call(s,null!=e?e.htmlMessage:e,{name:"renderTrustedMarkup",hash:{},data:l}))+"\n\t\t\t</div>\n"},22:function(n,e,t,a,l){var i,s=null!=e?e:{};return'\t\t\t<div class="content subview'+(null!=(i=t.if.call(s,null!=e?e.autoSizeToContent:e,{name:"if",hash:{},fn:n.program(7,l,0),inverse:n.noop,data:l}))?i:"")+'" style="'+(null!=(i=(t.ifDefined||e&&e.ifDefined||t.helperMissing).call(s,null!=e?e.contentPadding:e,{name:"ifDefined",hash:{},fn:n.program(18,l,0),inverse:n.noop,data:l}))?i:"")+'"></div>\n'},24:function(n,e,t,a,l,i,s){var r,o=null!=e?e:{};return'\t\t\t<div class="content menu" style="'+(null!=(r=(t.ifDefined||e&&e.ifDefined||t.helperMissing).call(o,null!=e?e.contentPadding:e,{name:"ifDefined",hash:{},fn:n.program(18,l,0,i,s),inverse:n.noop,data:l}))?r:"")+'">\n\t\t\t\t<ul role="menu">\n'+(null!=(r=t.each.call(o,null!=e?e.menuItems:e,{name:"each",hash:{},fn:n.program(25,l,0,i,s),inverse:n.noop,data:l}))?r:"")+"\t\t\t\t</ul>\n\t\t\t</div>\n"},25:function(n,e,t,a,l,i,s){var r;return null!=(r=t.if.call(null!=e?e:{},null!=s[1]?s[1].multiSelect:s[1],{name:"if",hash:{},fn:n.program(26,l,0,i,s),inverse:n.program(31,l,0,i,s),data:l}))?r:""},26:function(n,e,t,a,l){var i,s,r=null!=e?e:{};return'\t\t\t\t\t\t\t<li role="menuitem" '+(null!=(i=t.if.call(r,null!=e?e.selected:e,{name:"if",hash:{},fn:n.program(27,l,0),inverse:n.noop,data:l}))?i:"")+'>\n\t\t\t\t\t\t\t\t<span class="selection"></span>\n\t\t\t\t\t\t\t\t'+n.escapeExpression((s=null!=(s=t.text||(null!=e?e.text:e))?s:t.helperMissing,"function"==typeof s?s.call(r,{name:"text",hash:{},data:l}):s))+(null!=(i=t.if.call(r,null!=e?e.itemFlag:e,{name:"if",hash:{},fn:n.program(29,l,0),inverse:n.noop,data:l}))?i:"")+"\n\t\t\t\t\t\t\t</li>\n"},27:function(n,e,t,a,l){return'class="selected"'},29:function(n,e,t,a,l){var i,s=null!=e?e:{},r=t.helperMissing,o=n.escapeExpression;return" - "+o((i=null!=(i=t.itemFlag||(null!=e?e.itemFlag:e))?i:r,"function"==typeof i?i.call(s,{name:"itemFlag",hash:{},data:l}):i))+'<div class="label-new">'+o((i=null!=(i=t.itemFlag||(null!=e?e.itemFlag:e))?i:r,"function"==typeof i?i.call(s,{name:"itemFlag",hash:{},data:l}):i))+"</div>"},31:function(n,e,t,a,l){var i,s,r=null!=e?e:{};return'\t\t\t\t\t\t\t<li role="menuitem" '+(null!=(i=t.if.call(r,null!=e?e.isSelected:e,{name:"if",hash:{},fn:n.program(32,l,0),inverse:n.noop,data:l}))?i:"")+" "+(null!=(i=t.if.call(r,null!=e?e.href:e,{name:"if",hash:{},fn:n.noop,inverse:n.program(34,l,0),data:l}))?i:"")+">\n\t\t\t\t\t\t\t\t"+(null!=(i=t.if.call(r,null!=e?e.href:e,{name:"if",hash:{},fn:n.program(36,l,0),inverse:n.noop,data:l}))?i:"")+"\n\t\t\t\t\t\t\t\t\t"+n.escapeExpression((s=null!=(s=t.text||(null!=e?e.text:e))?s:t.helperMissing,"function"==typeof s?s.call(r,{name:"text",hash:{},data:l}):s))+(null!=(i=t.if.call(r,null!=e?e.itemFlag:e,{name:"if",hash:{},fn:n.program(39,l,0),inverse:n.noop,data:l}))?i:"")+"\n\t\t\t\t\t\t\t\t"+(null!=(i=t.if.call(r,null!=e?e.href:e,{name:"if",hash:{},fn:n.program(41,l,0),inverse:n.noop,data:l}))?i:"")+"\n\t\t\t\t\t\t\t</li>\n"},32:function(n,e,t,a,l){return'class="selected-item"'},34:function(n,e,t,a,l){return'tabindex="0"'},36:function(n,e,t,a,l){var i,s,r=null!=e?e:{};return'<a href="'+n.escapeExpression((s=null!=(s=t.href||(null!=e?e.href:e))?s:t.helperMissing,"function"==typeof s?s.call(r,{name:"href",hash:{},data:l}):s))+'"'+(null!=(i=t.if.call(r,null!=e?e.className:e,{name:"if",hash:{},fn:n.program(37,l,0),inverse:n.noop,data:l}))?i:"")+">"},37:function(n,e,t,a,l){var i;return' class="'+n.escapeExpression((i=null!=(i=t.className||(null!=e?e.className:e))?i:t.helperMissing,"function"==typeof i?i.call(null!=e?e:{},{name:"className",hash:{},data:l}):i))+'"'},39:function(n,e,t,a,l){var i;return'<div class="label-new">'+n.escapeExpression((i=null!=(i=t.itemFlag||(null!=e?e.itemFlag:e))?i:t.helperMissing,"function"==typeof i?i.call(null!=e?e:{},{name:"itemFlag",hash:{},data:l}):i))+"</div>"},41:function(n,e,t,a,l){return"</a>"},43:function(n,e,t,a,l){return"hide-foot"},45:function(n,e,t,a,l){return'\t\t<div class="droparrow up"></div>\n'},compiler:[7,">= 4.0.0"],main:function(n,e,t,a,l,i,s){var r,o,u=null!=e?e:{},f=t.helperMissing,c=n.escapeExpression;return'<div class="droparound'+(null!=(r=t.if.call(u,null!=e?e.htmlMessage:e,{name:"if",hash:{},fn:n.program(1,l,0,i,s),inverse:n.noop,data:l}))?r:"")+(null!=(r=t.if.call(u,null!=e?e.subview:e,{name:"if",hash:{},fn:n.program(3,l,0,i,s),inverse:n.noop,data:l}))?r:"")+(null!=(r=t.if.call(u,null!=e?e.menuItems:e,{name:"if",hash:{},fn:n.program(5,l,0,i,s),inverse:n.noop,data:l}))?r:"")+(null!=(r=t.if.call(u,null!=e?e.autoSizeToContent:e,{name:"if",hash:{},fn:n.program(7,l,0,i,s),inverse:n.noop,data:l}))?r:"")+" "+c((o=null!=(o=t.classList||(null!=e?e.classList:e))?o:f,"function"==typeof o?o.call(u,{name:"classList",hash:{},data:l}):o))+'"\nstyle="'+(null!=(r=t.if.call(u,null!=e?e.staticHeight:e,{name:"if",hash:{},fn:n.program(9,l,0,i,s),inverse:n.noop,data:l}))?r:"")+"\n"+(null!=(r=t.if.call(u,null!=e?e.staticWidth:e,{name:"if",hash:{},fn:n.program(11,l,0,i,s),inverse:n.noop,data:l}))?r:"")+"\n"+(null!=(r=t.if.call(u,null!=e?e.positionFixed:e,{name:"if",hash:{},fn:n.program(13,l,0,i,s),inverse:n.noop,data:l}))?r:"")+'">\n\t<div class="head '+(null!=(r=t.unless.call(u,null!=e?e.headContent:e,{name:"unless",hash:{},fn:n.program(15,l,0,i,s),inverse:n.noop,data:l}))?r:"")+'">\n\t\t'+c((o=null!=(o=t.headContent||(null!=e?e.headContent:e))?o:f,"function"==typeof o?o.call(u,{name:"headContent",hash:{},data:l}):o))+'\n\t</div>\n\t<div class="body">\n'+(null!=(r=t.if.call(u,null!=e?e.textMessage:e,{name:"if",hash:{},fn:n.program(17,l,0,i,s),inverse:n.noop,data:l}))?r:"")+(null!=(r=t.if.call(u,null!=e?e.htmlMessage:e,{name:"if",hash:{},fn:n.program(20,l,0,i,s),inverse:n.noop,data:l}))?r:"")+(null!=(r=t.if.call(u,null!=e?e.subview:e,{name:"if",hash:{},fn:n.program(22,l,0,i,s),inverse:n.noop,data:l}))?r:"")+(null!=(r=t.if.call(u,null!=e?e.menuItems:e,{name:"if",hash:{},fn:n.program(24,l,0,i,s),inverse:n.noop,data:l}))?r:"")+'\t</div>\n\t<div class="foot '+(null!=(r=t.unless.call(u,null!=e?e.footContent:e,{name:"unless",hash:{},fn:n.program(43,l,0,i,s),inverse:n.noop,data:l}))?r:"")+'">\n\t\t'+c((o=null!=(o=t.footContent||(null!=e?e.footContent:e))?o:f,"function"==typeof o?o.call(u,{name:"footContent",hash:{},data:l}):o))+"\n\t</div>\n"+(null!=(r=t.if.call(u,null!=e?e.showDropArrow:e,{name:"if",hash:{},fn:n.program(45,l,0,i,s),inverse:n.noop,data:l}))?r:"")+"</div>\n"},useData:!0,useDepths:!0}),a={};n.Array.each([],function(e){var t=n.Template.get("hermes/"+e);t&&(a[e]=t)}),n.Template.register("hermes/fluid-droparound",function(e,l){return l=l||{},l.partials=l.partials?n.merge(a,l.partials):a,t(e,l)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-flickr-balls",function(e,a){var l=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,l,r,s){return'<div class="balls">\n\t<div class="blue ball"></div><div class="pink ball"></div>\n</div>'},useData:!0}),r={};e.Array.each([],function(a){var l=e.Template.get("hermes/"+a);l&&(r[a]=l)}),e.Template.register("hermes/flickr-balls",function(a,s){return s=s||{},s.partials=s.partials?e.merge(r,s.partials):r,l(a,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("fluid-overlay-manager-view",function(e){"use strict";var i=0,l=e.Base.create("overlayManager",e.Base,[],{add:function(l){var a=this.get("overlay"),s=l.getAttrs(),t=this;this.get("modals").push(l),a?s.dismissOnOverlayClick&&this.set("dismissOnOverlayClick",!0):(a=e.Node.create(this.get("overlayHTML")),e.one("body").append(a),this.set("overlay",a),i++,this.addOverlayClickHandler(a),this.addOverlayKeyHandler(a),s.dismissOnOverlayClick?this.set("dismissOnOverlayClick",!0):this.set("dismissOnOverlayClick",!1)),this.setOverlayStyle(s),s.dismissOnActionClick&&l.on("actionClick",function(){setTimeout(function(){t.close()},0)}),"fluid-modal-view"===l.name&&l.on("cancelClick",function(){setTimeout(function(){t.close()},0)})},setOverlayStyle:function(e){var i="",l="",a="",s=this.get("overlay");e.hideModalOverlay&&(i="transparent"),e.darkOverlay&&(i="darker-overlay"),e.lightOverlay&&(i="light-overlay"),e.invisibleOverlay&&(l="invisible"),e.overlayClassList&&(a=e.overlayClassList),s.setAttribute("class",this.get("overlayClass")+" "+a+" "+i+" "+l)},addOverlayClickHandler:function(e){e.getDOMNode().addEventListener("click",this.clickHandler.bind(this))},removeOverlayClickHandler:function(e){e.getDOMNode().removeEventListener("click",this.clickHandler.bind(this))},addOverlayKeyHandler:function(i){e.one("body").getDOMNode().addEventListener("keyup",this.keyHandler.bind(this))},removeOverlayKeyHandler:function(i){e.one("body").getDOMNode().removeEventListener("keyup",this.keyHandler.bind(this))},keyHandler:function(e){27===e.keyCode&&this.clickHandler()},clickHandler:function(){var e,i=this.get("modals").length-2,l="",a="",s="",t=this.get("overlay");this.get("dismissOnOverlayClick")&&(this.set("dismissOnOverlayClick",!1),this.close(),i>-1&&this.get("modals").length>0&&(e=this.get("modals")[i].getAttrs(),e.hideModalOverlay&&(l="transparent"),e.invisibleOverlay&&(a="invisible"),e.overlayClassList&&(s=e.overlayClassList),t.setAttribute("class",this.get("overlayClass")+" "+s+" "+l+" "+a),this.set("dismissOnOverlayClick",e.dismissOnOverlayClick)))},remove:function(e){var i=this.get("modals");if(e.isClosed){var l=i.indexOf(e);l>-1?i.splice(l,1):1===i.length&&(l=0,i.splice(l,1)),this.removeOverlay()}},close:function(){var e=this.get("modals").pop();e&&!e.isClosed&&e.close(),this.removeOverlay()},closeAll:function(){var e=this;this.get("modals").forEach(function(i,l){e.close()})},removeOverlay:function(){var e=this.get("overlay");if(0===this.get("modals").length&&e)this.removeOverlayClickHandler(e),this.removeOverlayKeyHandler(e),e.remove(),this.set("overlay",void 0),i--;else{var l=this.get("modals").length-1;l>-1&&this.setOverlayStyle(this.get("modals")[l].getAttrs())}},alreadyShowingModal:function(e){var i=!1;return e||(e="fluid-modal-view"),this.get("modals").forEach(function(l,a){l.name===e&&(i=!0)}),i}},{ATTRS:{modals:{value:[],validator:function(i){return e.Lang.isArray(i)}},overlayHTML:{},overlayClass:{},overlay:{value:void 0},dismissOnOverlayClick:{value:!0,setter:function(i){return e.AttributeHelpers.coerceBoolean(i)},validator:function(i){return e.Lang.isBoolean(i)}}}});e.OverlayManager={DroparoundOverlay:new l({overlayHTML:'<div class="fluid-droparound-overlay"></div>',overlayClass:"fluid-droparound-overlay"}),ModalOverlay:new l({overlayHTML:'<div class="fluid-modal-overlay"><div class="balls"></div></div>',overlayClass:"fluid-modal-overlay"}),SignupInterstitialOverlay:new l({overlayHTML:'<div class="signup-interstitial-overlay interstitial-fade"></div>',overlayClass:"signup-interstitial-overlay interstitial-fade"}),ChalkboardOverlay:new l({overlayHTML:'<div class="fluid-chalkboard-overlay"></div>',overlayClass:"fluid-chalkboard-overlay"}),hasOverlay:function(){return i>0}}},"@VERSION@",{requires:["base","flickr-view","attribute-helpers"],optionalRequires:["fluid"]});
YUI.add("fluid",function(e){"use strict";function o(){var o="",t=[];if(!d.prefix&&"getComputedStyle"in e.config.win){if(!e.config.win.getComputedStyle(e.config.doc.documentElement,""))return d.prefix;t=Array.prototype.slice.call(e.config.win.getComputedStyle(e.config.doc.documentElement,"")),o=t.join("").match(/-(webkit|moz|ms)-/),o=o&&o.length>1?o[1]:"",d.prefix.raw=o.toLowerCase(),d.prefix.css="-"+o+"-",d.prefix.js=o.charAt(0).toUpperCase()+o.slice(1),d.prefix.dom="WebKit|Moz|MS".match(new RegExp("("+o+")","i"))[1]}return d.prefix}function t(o,t){return t=t||e.config.win,new e.Promise(function(i,n){setTimeout(e.bind(function(){i(o.call(t))},t),1)})}function i(e,o,t){return""!==d.prefix.css?t.getDOMNode().style.setProperty(d.prefix.css+e,o,null):t.setStyle(e,o),t}function n(o){var t=!1;return o+="",t=o in e.config.doc.body.style,t||(o=o.charAt(0).toUpperCase()+o.slice(1),t=d.prefix.raw+o in e.config.doc.body.style),t}function r(o,t){return t=t||{timeout:1e4,retry:!1},t.timeout=parseInt(t.timeout,10),isNaN(t.timeout)&&(t.timeout=1e4),new e.Promise(function(e,i){d.loadImage.imageQueue.push({src:o,options:t,done:e,error:i}),a()})}function a(){var e=null;d.loadImage.currentWorkers<d.loadImage.maxWorkers-1&&d.loadImage.imageQueue.length&&(d.loadImage.currentWorkers++,e={image:new Image,work:d.loadImage.imageQueue.shift(),timeout:null,loaded:null,finished:null},e.finished=(function(e){return function(o){clearTimeout(e.timeout),e.image.removeEventListener("load",e.finished),e.image.removeEventListener("error",e.finished),e.image.removeEventListener("abort",e.finished),"load"===o.type?e.work.done(e.work.src):e.work.options.retry?r(e.work.src,{retry:!1,timeout:e.work.options.timeout}).then((function(e){return function(o){e(o)}})(e.work.done),(function(e){return function(o){e(o)}})(e.work.done)):e.work.error(e.work.src),e.image=null,e=null,d.loadImage.currentWorkers--,a()}})(e),e.image.addEventListener("load",e.finished),e.image.addEventListener("error",e.finished),e.image.addEventListener("abort",e.finished),e.image.src=e.work.src,e.timeout=setTimeout((function(e){return function(){e.finished({type:"error"})}})(e),e.work.options.timeout),e.image.complete&&e.finished({type:"load"}))}function u(o){var t;return o&&(t=e.config.doc.createElement("div"),t.appendChild(e.config.doc.createTextNode(o)),o=t.innerHTML),o}function c(o){var t,i;return e.config.doc.selection?(i=e.config.doc.selection.createRange(),i.moveStart=-o.get("value").length,t=i.text.length):"number"==typeof o.get("selectionStart")&&(t=o.get("selectionStart")),t}function s(){var o="";return void 0!==e.config.win.getSelection?o=e.config.win.getSelection().toString():void 0!==e.config.doc.selection&&"Text"===e.config.doc.selection.type&&(o=e.config.doc.selection.createRange().text),o}function l(e){var o,t,i={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Œ":"OE","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","ẞ":"SS","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","œ":"oe","ɶ":"oe","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ſ":"s","ẛ":"s","ß":"ss","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","０":"0","₀":"0","⓪":"0","⁰":"0","¹":"1","⑴":"1","₁":"1","❶":"1","⓵":"1","⒈":"1","①":"1","１":"1","²":"2","❷":"2","⑵":"2","２":"2","₂":"2","⓶":"2","②":"2","⒉":"2","³":"3","３":"3","⒊":"3","⑶":"3","₃":"3","❸":"3","⓷":"3","③":"3","⓸":"4","④":"4","⒋":"4","４":"4","⁴":"4","₄":"4","❹":"4","⑷":"4","⒌":"5","₅":"5","⓹":"5","⑸":"5","❺":"5","⑤":"5","５":"5","⁵":"5","⑹":"6","⁶":"6","６":"6","❻":"6","₆":"6","⑥":"6","⓺":"6","⒍":"6","７":"7","⁷":"7","❼":"7","⓻":"7","⒎":"7","₇":"7","⑺":"7","⑦":"7","⑧":"8","⒏":"8","⓼":"8","⑻":"8","⁸":"8","８":"8","❽":"8","₈":"8","⓽":"9","９":"9","⒐":"9","❾":"9","⑼":"9","₉":"9","⑨":"9","⁹":"9"},n=e.split(""),r=!1;for(o=n.length-1;o>=0;o--)t=n[o],i.hasOwnProperty(t)&&(n[o]=i[t],r=!0);return r&&(e=n.join("")),e}var d={prefix:{raw:"",css:"",js:"",dom:""},loadImage:{maxWorkers:8,currentWorkers:0,imageQueue:[],workingWorkers:[]}};!(function(){o()})(),e.namespace("fluid"),e.mix(e.fluid,{determineBrowserPrefix:o,setStylePrefixed:i,supports:n,prefix:d.prefix,chill:t,loadImage:r,escapeHtml:u,getTextFieldCursorPosition:c,getTextFieldSelection:s,removeDiacritics:l})},"@VERSION@",{requires:["flickr-promise"],optional:[],affinity:"client"});
YUI.add("fluid-droparound-view",function(e,t){"use strict";var r,i,n,o=require("lib/flog")(t);r={css:{destinationContainer:"body",subviewContent:".content.subview",menuContent:".content.menu",droparoundContainer:".droparound",droparoundContent:".body .content",droparrow:".droparrow"},options:{}},i={supportsTransform:!1,droparound:{height:0,width:0}},n=function(e,t,r){var i,n,o,s,a,l=e.x,u=e.y,c=e.width,d=e.height,h=e.viewportX,v=t.width,g=t.height,f=r.height,p=r.width,b=r.preferredHorizontalOrientation,m=r.preferredVerticalOrientation,A=v/2,w=g/2,H=u<w,C=l<A;return"down"===m&&(H=!0),"up"===m&&(H=!1),"right"===b&&(C=!0),"left"===b&&(C=!1),r.ignoreBoundary||(f>h&&(H=!0),u+d+f<h&&(H=!1)),H?(s=u+d,a=u+d+f,i={vertical:"down"},C?(n=l,o=l+p,i.horizontal="right"):(n=l-p+c,o=l-c,i.horizontal="left")):(s=u-f,a=u,i={vertical:"up"},C?(n=l,o=l+p,i.horizontal="right"):(n=l-p+c,o=l-c,i.horizontal="left")),{coords:[n,o,s,a],orientation:i}},e.namespace("Views").FluidDroparound=e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(e){this.set("isActiveViewAgnostic",!0)},buildContainer:function(){return this.get("textMessage")||this.get("htmlMessage")||this.get("subview")||this.get("menuItems")?(this.get("menuItems")&&this.set("menuItems",this.get("menuItems").filter(function(e){return!e.hidden})),this.setContainerWithTemplate("fluid-droparound",{textMessage:this.get("textMessage"),htmlMessage:this.get("message")?this.get("message"):this.get("htmlMessage"),subview:!!this.get("subview"),menuItems:this.get("menuItems"),multiSelect:this.get("multiSelect"),showDropArrow:this.get("showDropArrow"),hideModalOverlay:this.get("hideModalOverlay"),classList:this.get("classList"),footContent:this.get("footContent"),headContent:this.get("headContent"),staticWidth:this.get("width"),staticHeight:this.get("height"),positionFixed:this.get("positionFixed"),autoSizeToContent:this.get("autoSizeToContent"),contentPadding:this.get("contentPadding")}),this.appendAndPosition(),this):(o.warn("requires a `textMessage`, `htmlMessage`, `subview`, or `menuItems`."),this)},activate:function(){var t=this.get("container"),i=this;e.OverlayManager.DroparoundOverlay.add(this),e.OverlayManager.DroparoundOverlay.setOverlayStyle({overlayClassList:this.get("overlayClassList"),hideModalOverlay:this.get("hideModalOverlay"),invisibleOverlay:this.get("invisibleOverlay")}),this.registerEventHandler(e.on("droparound:reposition",e.bind(this.anchorPositionChange,this))),this.registerEventHandler(e.on("history:change",function(e){"popstate"===e.src&&e.prevVal&&e.newVal&&(e.prevVal.flickr&&e.prevVal.flickr.referrer||e.newVal.flickr&&e.newVal.flickr.referrer)||i.close(e)})),e.use("keyboard-manager",function(e){i.registerEventHandler(t.on("keydown",i.keyboardNavigation,i))});var n=this.get("anchorElement"),o=this.get("keyboardAnchorElement");return o||(o=n.hasAttribute("aria-haspopup")?n:n.ancestor("[aria-haspopup=true]")),o&&(this.set("keyboardAnchorElement",o),this.get("keyboardAnchorElement").setAttribute("aria-expanded","true"),this.registerEventHandler(o.on("key",this.enterDroparound,"down:40",this))),this.get("subview")&&this.loadSubview(),this.get("menuItems")&&this.registerEventHandler(t.one(r.css.menuContent).delegate(["click","keydown"],function(e){"click"!==e.type&&13!==e.keyCode||this.onMenuItemClick(e)}.bind(this),"li")),this.get("observePageResize")&&this.observePageResize(),this.get("closeOnScroll")&&this.observePageScroll(),this.fire("activated"),this},enterDroparound:function(e){var t=this.get("container").one("ul li");t&&(e.preventDefault(),t.focus())},keyboardNavigation:function(e){var t=e.keyCode,r=38===t||9===t&&e.shiftKey,i=40===t||9===t&&!e.shiftKey,n=e.target.ancestor("li",!0);if(!this.appContext.getKeyboardManager().inputHasFocus())if(r&&n&&n.previous("li"))e.preventDefault(),this.focusOnPreviousItem(e);else if(i)e.preventDefault(),n&&n.next("li")&&this.focusOnNextItem(e);else if(27===t||r){e.preventDefault();var o=this.get("keyboardAnchorElement");o&&(this.close(),o.focus(),o.removeClass("no-outline"))}},focusOnPreviousItem:function(e){var t=e.target.ancestor("li",!0);if(t){var r=t.previous("li");r&&(r.one("a")?r.one("a").focus():r.focus())}},focusOnNextItem:function(e){var t=e.target.ancestor("li",!0);if(t){var r=t.next("li");r&&(r.one("a")?r.one("a").focus():r.focus())}},getDroparoundContainer:function(){return this.get("container")?this.get("container").one(r.css.droparoundContainer):null},loadSubview:function(){var t,i,n=!1,o=this.get("subview"),s=this;t=this.get("container").one(r.css.subviewContent),t.appendChild(e.Node.create(this.templates("flickr-balls")({})).addClass("flickr-balls")),i=setTimeout(function(){n=!0},40),this.loading=!0,o.appContext=s.appContext,o.set("isActiveViewAgnostic",!0),o.initialize().then(function(e){clearTimeout(i),n&&(e.get("container").addClass("load-transition"),setTimeout(function(){e.get("container").removeClass("load-transition")},1)),s.onSubviewInitialized(e)})},onSubviewInitialized:function(t){var i=this,n=this.get("container").one(r.css.subviewContent);this.loading&&(this.loading=!1,n.one(".flickr-balls").remove(!0),n.appendChild(t.get("container")),t.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&i.fire.apply(i,e.details)}),t.normalizedActivate(),t.recursivelyActivateSubviews(),i.appendAndPosition(),i.registerEventHandler(i.get("subview").on("actionClick",e.bind(i.handleAction,i))))},onMenuItemClick:function(e){var t,i,n;(t=e.target.ancestor("li",!0))&&-1!==(i=this.get("container").one(r.css.menuContent).all("li").indexOf(t))&&(n=this.get("menuItems")[i],this.get("multiSelect")&&(n.selected=!n.selected,t.toggleClass("selected")),this.fire("selected",{menuItemIndex:i,menuItem:n,origEvent:e}))},appendAndPosition:function(t){var n=e.one(r.css.destinationContainer),o=this.get("container").one(r.css.droparoundContainer);n&&(n.append(this.get("container")),i.droparound.width=this.get("width")||o.getComputedStyle("width"),i.droparound.height=this.get("height")||o.getComputedStyle("height"),this.repositionToElement(t||this.get("anchorElement")))},updateTextMessage:function(e){e&&""!==e&&(this.set("textMessage",e),this.buildContainer())},updateHTMLMessage:function(e){e&&""!==e&&(this.set("htmlMessage",e),this.buildContainer())},anchorPositionChange:function(){this.repositionToElement(this.get("anchorElement"))},observePageResize:function(){var t=this;this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(r){e.fire("droparound:reposition"),t.get("closeOnResize")&&t.handleClose(r)}))},observePageScroll:function(){var t=YUI.Env.isServer?0:e.config.win.pageYOffset,r=this;this.get("startingScrollPoint")||this.set("startingScrollPoint",t),this.registerEventHandler(e.globalEvents.subscribe("window:scroll",r.handleScroll.bind(r)))},handleScroll:function(t){var r,i=this.get("startingScrollPoint");i?(r=e.config.win.pageYOffset,(i+this.get("closeOnScrollDistance")<r||i-this.get("closeOnScrollDistance")>r)&&this.handleClose(t)):this.set("startingScrollPoint",e.config.win.pageYOffset)},repositionToElement:function(e,t){var i,o=this.get("container"),s=this.get("positionFixed"),a=o.one(".droparound"),l=this.get("showDropArrow")?a.one(r.css.droparrow):void 0,u=a.one(r.css.droparoundContent),c=u.get("offsetWidth"),d=u.get("offsetHeight"),h=l?l.get("offsetHeight"):0,v=e.getXY(),g=v[0],f=v[1],p=e.getDOMNode().getBoundingClientRect(),b={width:a.get("offsetWidth"),height:a.get("offsetHeight")};b.ignoreBoundary=!!t,this.get("preferLeft")&&(b.preferredHorizontalOrientation="left"),this.get("preferRight")&&(b.preferredHorizontalOrientation="right"),this.get("preferTop")&&(b.preferredVerticalOrientation="up"),this.get("preferBottom")&&(b.preferredVerticalOrientation="down"),(!this.anchorCoords||0!==this.x&&0!==this.y)&&(this.anchorCoords={x:s?p.left:g,y:s?p.top:f,width:e.get("offsetWidth"),height:e.get("offsetHeight"),viewportX:e.getDOMNode().getBoundingClientRect().top||0});var m=n(this.anchorCoords,{width:this.appContext.viewportData.getWidth(),height:this.appContext.viewportData.getHeight()},b);"down"===m.orientation.vertical?m.coords[2]+=h-this.get("anchorOffsetVertical"):m.coords[2]-=h+this.get("anchorOffsetVertical"),"right"===m.orientation.horizontal?m.coords[0]-=this.get("anchorOffsetHorizontal"):m.coords[0]+=this.get("anchorOffsetHorizontal"),a.setStyles({left:m.coords[0],top:m.coords[2]}),l&&(l.removeClass("down").removeClass("up").removeClass("left").removeClass("right").addClass(m.orientation.vertical),"left"===m.orientation.horizontal?l.setStyles({right:10+this.get("mirrorArrowAdjustment"),left:"auto"}):l.setStyles({left:10+this.get("mirrorArrowAdjustment")})),this.get("menuItems")||this.get("autoSizeToContent")||(i={width:c+"px",height:d+"px"},u.setStyles(i))},handleClose:function(e){this.close()},handleAction:function(e){this.fire("actionClick",e),this.get("dismissOnActionClick")&&this.close(e)},show:function(){var e=!this.isActivated,t=this;return this.initialize().then(function(){t.isClosed=!1,e||t.activate()}),this},close:function(){var t=this.get("container");this.loading=!1,this.isClosed=!0;var r=this.get("keyboardAnchorElement");r&&(r.setAttribute("aria-expanded","false"),r.focus(),r.addClass("no-outline")),this.fire("closeDroparound"),this.destroy(),this.get("subview")&&this.get("subview").destroy(),t&&t.remove(!0),e.OverlayManager.DroparoundOverlay.remove(this)},destructor:function(){this.detachAll()},freeze:function(){e.one("body").setStyles({overflow:"hidden"})},unfreeze:function(){e.one("body").setStyles({overflow:"visible"})}},{ATTRS:{dismissOnOverlayClick:{value:!0,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},dismissOnActionClick:{value:!0,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},hideModalOverlay:{value:!0,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},invisibleOverlay:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},preferredSide:{value:null},message:{value:null},textMessage:{value:null},htmlMessage:{value:null},footContent:{value:null},headContent:{value:null},width:{value:0,validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},height:{value:0,validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},subview:{value:null},menuItems:{value:null},classList:{value:"",validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t,r){return e.AttributeHelpers.coerceString(t)}},anchorElement:{value:null},keyboardAnchorElement:{value:null},showDropArrow:{value:!0,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},anchorOffsetVertical:{value:0,validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},anchorOffsetHorizontal:{value:5,validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},contentPadding:{value:void 0,validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},minVerticalSpace:{value:60,validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},minHorizontalSpace:{value:60,validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},dropdownArrowWidth:{value:21,validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},dropdownArrowHeight:{value:11},anchorPositionOffset:{value:15,validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},observePageResize:{value:!0,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},preferLeft:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},preferRight:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},preferTop:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},preferBottom:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},mirrorArrowAdjustment:{value:0,validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},positionFixed:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},closeOnScroll:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},closeOnScrollDistance:{value:40,validator:function(t,r){return e.AttributeHelpers.validateInteger(t)},setter:function(t,r){return e.AttributeHelpers.coerceInteger(t)}},closeOnResize:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},overlayClassList:{value:"",validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t,r){return e.AttributeHelpers.coerceString(t)}},forceLeft:{value:null},forceRight:{value:null},autoSizeToContent:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},horizCenterToAnchor:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}},multiSelect:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,r){return e.AttributeHelpers.coerceBoolean(t)}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-fluid-droparound","hermes-template-flickr-balls","fluid-overlay-manager-view","attribute-helpers"],optionalRequires:["fluid"]});
YUI.add("hermes-template-privacy-footer",function(e,a){var t=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,t,r,s){return'<div class="footer-container">\n\t<p>By using Yahoo, you agree that we and our partners may set cookies for purposes such as customising content and advertising.</p>\n\t<button class="dismiss">Dismiss</button>\n</div>\n'},useData:!0}),r={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(r[a]=t)}),e.Template.register("hermes/privacy-footer",function(a,s){return s=s||{},s.partials=s.partials?e.merge(r,s.partials):r,t(a,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("privacy-footer-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{buildContainer:function(){return this.setContainerWithTemplate("privacy-footer"),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-privacy-footer"]});
YUI.add("footer-full-view",function(e){var t=["en-US","zh-HK","de-DE","es-US","fr-FR","ko-KR","it-IT","pt-BR","vn-VN","id-ID"],o={"en-US":"English","de-DE":"Deutsch","es-US":"Español","fr-FR":"Français","ko-KR":"한글","it-IT":"Italiano","pt-BR":"Português","vn-VN":"Tiếng Việt","id-ID":"Bahasa Indonesia","zh-HK":"繁體中文"};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return""===this.get("container").get("innerHTML")&&this.setContainerHTML('<div class="footer-full-content"></div>'),this.appStateParams=e,this.set("hideOptOutBanner",e.hideOptOutBanner),this.set("showOptOutBanner",e.showOptOutBanner),this.set("hideMobileBanner",e.hideMobileBanner),this},subviewConfig:{"privacy-footer-view":{requiredToShowOnServer:!1,requiredToShowOnClient:!1,additionalViewClasses:["hidden"],disabled:function(){return!this.appContext.flipper.isFlipped("enable-privacy-footer")}}},loadState:function(){var i,n,a;for(a=this.appContext.auth&&this.appContext.auth.csrf?this.appContext.auth.csrf:"",this.lang=this.appContext.lang,this.menuLangs=[],"zh-Hant-HK"===this.lang&&(this.lang="zh-HK"),"vi-vn"===this.lang.toLowerCase()&&(this.lang="vn-VN"),this.selectedLang={code:this.lang,name:o[this.lang],csrf:a},i=0,n=t.length;i<n;i++)t[i]!==this.lang&&"string"==typeof t[i]&&this.menuLangs.push({code:t[i].toLowerCase(),name:o[t[i]],csrf:a});return e.Promise.resolve()},buildContainer:function(){var t={};return this.get("viewer")&&e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))}),t={displayLangs:this.displayLangs,selectedLang:this.selectedLang,helpLocaleKey:this.selectedLang.code.replace("-","_")||"en_US",menuLangs:this.menuLangs,elements:this.setElementStates()},t.elements.bottom_row||this.get("container").addClass("compact"),YUI.Env.isServer?t.pageUrl=this.appContext.request.url:t.pageUrl=window.location.pathname,this.appContext.getCookie("mobile_allow_www")&&!this.appStateParams.hideMobileBanner?t.isOptedOutOfMobile=!this.get("hideMobileBanner"):!this.appContext.getCookie("mobile_allow_www")&&this.get("hideMobileBanner")&&(t.hasNoOptOut=!0),this.setContainerWithTemplate("footer-full",t),this},activate:function(){var t=this.get("container"),o=t.one(".lang-switcher"),i=o.one("a"),n=t.one(".foot-mobile-banner a"),a=t.one(".opt-out-www");return this.appContext.flipper.isFlipped("enable-privacy-footer")&&(this.appContext.hasClientSideRouted()||e.StorageHelper.hasEntries("privacyFooterDismissed")||!e.config.flickr.geo.eu||t.addClass("privacy-footer"),this.registerEventHandler(t.one(".dismiss").on("click",function(){e.StorageHelper.setItem("privacyFooterDismissed",!0),t.removeClass("privacy-footer")}))),this.menuLangsFormatted=this.menuLangs.map(function(e){return{href:"/change_language.gne?lang="+e.code+"&csrf="+e.csrf,text:e.name}}),this.registerEventHandler(o.on("click",function(t){t.preventDefault(),i.addClass("dimmed");var n=new e.Views.FluidDroparound({anchorOffsetHorizontal:15,appContext:this.appContext,showDropArrow:!0,observePageResize:!0,dismissOnOverlayClick:!0,anchorElement:o.one(".arrow"),classList:["lang-droparound"],menuItems:this.menuLangsFormatted});n.show(),this.registerEventHandler(n.on("closeDroparound",function(e){i.removeClass("dimmed")}),this)},this)),n&&this.registerEventHandler(n.on("click",function(e){this.appContext.removeCookie({cookieName:"mobile_allow_www",path:"/"})},this)),a&&this.registerEventHandler(a.on("click",function(e){this.appContext.setCookie({cookieName:"mobile_allow_www",path:"/",cookieValue:1})},this)),this},setElementStates:function(){var e={top_row:!0,top_about:!0,top_jobs:!0,top_blog:!0,top_mobile:!0,top_developers:!0,top_guidelines:!0,top_privacy:!1,top_terms:!1,top_yahoo_safely:!1,top_feedback:!0,top_report_abuse:!0,top_help_forum:!0,top_language:!0,bottom_row:!0,bottom_privacy:!0,bottom_terms:!0,bottom_yahoo_safely:!0,bottom_help:!0,bottom_yahoo_company:!0,bottom_tumblr:!0,bottom_facebook:!0,bottom_twitter:!0};return this.appStateParams.isSOHP&&(e.top_privacy=!0,e.top_terms=!0,e.top_yahoo_safely=!0,e.top_feedback=!1,e.top_report_abuse=!1,e.bottom_row=!1),e}})},"@VERSION@",{requires:["flickr-view","hermes-template-footer-full","url-helper","dropdown","fluid-droparound-view","privacy-footer-view"],langBundles:["common"]});
YUI.add("hermes-template-photo-list-aft",function(t,n){var e=t.Template.Handlebars.revive({1:function(t,n,e,a,i){var r=t.lambda,l=t.escapeExpression;return"\t\t\t\t\timg = new Image();\n\t\t\t\t\timg.addEventListener('load', function onImageLoad (event) {\n\t\t\t\t\t\tthis.removeEventListener('load', onImageLoad);\n\t\t\t\t\t\ttimingCache['"+l(r(null!=n?n.id:n,n))+"'] = new Date().getTime();\n\t\t\t\t\t});\n\t\t\t\t\timg.src='"+l(r(null!=n?n.url:n,n))+"';\n"},compiler:[7,">= 4.0.0"],main:function(t,n,e,a,i){var r,l,o=null!=n?n:{},s=e.helperMissing,c=t.escapeExpression;return'<script type="text/javascript" nonce="'+c((l=null!=(l=e.cspNonce||(null!=n?n.cspNonce:n))?l:s,"function"==typeof l?l.call(o,{name:"cspNonce",hash:{},data:i}):l))+"\">\n\ttry {\n\n\t\t(function () {\n\n\t\t\t\tif (!window.paftTiming) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar timingCache = {},\n\t\t\t\t    img;\n\n\t\t\t\twindow.paftTiming['"+c((l=null!=(l=e.photolistId||(null!=n?n.photolistId:n))?l:s,"function"==typeof l?l.call(o,{name:"photolistId",hash:{},data:i}):l))+"'] = timingCache;\n\n"+(null!=(r=e.each.call(o,null!=n?n.photos:n,{name:"each",hash:{},fn:t.program(1,i,0),inverse:t.noop,data:i}))?r:"")+"\n\t\t})();\n\n\t} catch (error) {\n\n\t\tif (window.sendRequest){\n\t\t\twindow.sendRequest('flickr.hermes.photolistAFT.failure', 'Photolist timing failed.');\n\t\t}\n\t}\n<\/script>\n"},useData:!0}),a={};t.Array.each([],function(n){var e=t.Template.get("hermes/"+n);e&&(a[n]=e)}),t.Template.register("hermes/photo-list-aft",function(n,i){return i=i||{},i.partials=i.partials?t.merge(a,i.partials):a,e(n,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-infinite-scroll-load-more",function(e,a){var t=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,t,l,n){return'<div class="infinite-scroll-load-more">\n\t<button class="alt">'+e.escapeExpression((t.intlMessage||a&&a.intlMessage||t.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"common.LOAD_MORE_RESULTS"},data:n}))+"</button>\n</div>"},useData:!0}),l={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(l[a]=t)}),e.Template.register("hermes/infinite-scroll-load-more",function(a,n){return n=n||{},n.partials=n.partials?e.merge(l,n.partials):l,t(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-license-detail",function(e,a){var s=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,s,l,t){var n=null!=a?a:{},i=s.helperMissing,r=e.escapeExpression;return'<p class="secondary" style="margin-top: 0;">'+r((s.intlMessage||a&&a.intlMessage||i).call(n,{name:"intlMessage",hash:{intlName:null!=a?a.title:a},data:t}))+'</p>\n<p class="secondary" style="margin-bottom: 0;">'+r((s.intlMessage||a&&a.intlMessage||i).call(n,{name:"intlMessage",hash:{intlName:null!=a?a.body:a},data:t}))+"</p>\n"},useData:!0}),l={};e.Array.each([],function(a){var s=e.Template.get("hermes/"+a);s&&(l[a]=s)}),e.Template.register("hermes/license-detail",function(a,t){return t=t||{},t.partials=t.partials?e.merge(l,t.partials):l,s(a,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-list-layout-row",function(t){(t.PhotoListLayoutRow=function(t){this.top=t.top,this.left=t.left,this.width=t.width,this.spacing=t.spacing,this.targetRowHeight=t.targetRowHeight,this.targetRowHeightTolerance=t.targetRowHeightTolerance,this.minAspectRatio=this.width/t.targetRowHeight*(1-t.targetRowHeightTolerance),this.maxAspectRatio=this.width/t.targetRowHeight*(1+t.targetRowHeightTolerance),this.edgeCaseMinRowHeight=t.edgeCaseMinRowHeight||Number.NEGATIVE_INFINITY,this.edgeCaseMaxRowHeight=t.edgeCaseMaxRowHeight||Number.POSITIVE_INFINITY,this.rightToLeft=t.rightToLeft,this.isBreakoutRow=t.isBreakoutRow,this.items=[],this.height=0}).prototype={addItem:function(e){var i,h,s,o=this.items.concat(e),a=this.width-(o.length-1)*this.spacing,r=o.reduce(function(t,e){return t+e.aspectRatio},0),g=a/this.targetRowHeight;return this.isBreakoutRow&&0===this.items.length&&e.aspectRatio>=1?(this.items.push(t.merge(e)),this._completeLayout(a/e.aspectRatio),!0):!(0===r||(r<this.minAspectRatio?(this.items.push(t.merge(e)),0):r>this.maxAspectRatio?0===this.items.length?(this.items.push(t.merge(e)),this._completeLayout(a/r),0):(i=this.width-(this.items.length-1)*this.spacing,h=this.items.reduce(function(t,e){return t+e.aspectRatio},0),s=i/this.targetRowHeight,Math.abs(r-g)>Math.abs(h-s)?(this._completeLayout(i/h),1):(this.items.push(t.merge(e)),this._completeLayout(a/r),0)):(this.items.push(t.merge(e)),this._completeLayout(a/r),0)))},forceComplete:function(t,e){var i=this.width-(this.items.length-1)*this.spacing,h=this.items.reduce(function(t,e){return t+e.aspectRatio},0);"number"==typeof e?this._completeLayout(e,!1):t?this._completeLayout(i/h):this._completeLayout(this.targetRowHeight,!1)},isLayoutComplete:function(){return this.height>0},getItems:function(){return this.rightToLeft?this.items.reverse():this.items},getIndexOfItem:function(t){var e=-1;return this.items.some(function(i,h){if(i.id===t)return e=h,!0}),e},setTop:function(t){this.top=t,this.items.forEach(function(e){e.geometry.top=t})},_completeLayout:function(t,e){var i,h,s,o,a,r,g=this.rightToLeft?-this.left:this.left,n=this.width-(this.items.length-1)*this.spacing,m=this;void 0===e&&(e=!0),h=Math.round(t),s=Math.max(this.edgeCaseMinRowHeight,Math.min(h,this.edgeCaseMaxRowHeight)),h!==s?(this.height=s,i=n/s/(n/h)):(this.height=h,i=1),this.items.forEach(function(t,e){t.geometry={top:m.top,width:Math.round(t.aspectRatio*m.height*i),height:m.height},m.rightToLeft?t.geometry.left=m.width-g-t.geometry.width:t.geometry.left=g,g+=t.geometry.width+m.spacing}),e&&(this.rightToLeft||(g-=this.spacing+this.left),o=(g-this.width)/this.items.length,a=this.items.map(function(t,e){return Math.round((e+1)*o)}),1===this.items.length?(r=this.items[0].geometry,r.width-=Math.round(o),this.rightToLeft&&(r.left+=Math.round(o))):this.items.forEach(function(t,e){e>0?(t.geometry.left-=a[e-1],t.geometry.width-=a[e]-a[e-1]):t.geometry.width-=a[e]}))}}},"@VERSION@",{requires:[]});
YUI.add("photo-list-layout",function(t,e){var i=require("lib/flog")(e),o={containerPadding:{top:8,right:8,bottom:8,left:8},itemSpacing:{horizontal:8,vertical:8},targetRowHeight:320,targetRowHeightTolerance:.25,awakeBoundsToViewportSizeRatio:3,maxNumRows:Number.POSITIVE_INFINITY,forceAspectRatio:Number.NaN,alwaysDisplayOrphans:!1,sleepTopAndBottom:!0,sleepLeftAndRight:!1,fullWidthBreakoutRowCadence:!1,deferWakeSleepUntil:2500};(t.PhotoListLayout=function(e){if(!e.appContext)throw new Error("PhotoListLayout must be instantiated with `params.appContext`.");e=t.merge(o,e),this.appContext=e.appContext,this.containerWidth=e.containerWidth,this.viewportContainerNodeHeight=e.viewportContainerNodeHeight||this.appContext.viewportData.getHeight(),this.containerPadding=e.containerPadding,this.itemSpacing=e.itemSpacing,this.targetRowHeight=e.targetRowHeight,this.targetRowHeightTolerance=e.targetRowHeightTolerance,this.awakeBoundsToViewportSizeRatio=e.awakeBoundsToViewportSizeRatio,this.maxNumRows=e.maxNumRows,this.forceAspectRatio=e.forceAspectRatio,this.alwaysDisplayOrphans=e.alwaysDisplayOrphans,this.sleepTopAndBottom=e.sleepTopAndBottom,this.sleepLeftAndRight=e.sleepLeftAndRight,this.fullWidthBreakoutRowCadence=e.fullWidthBreakoutRowCadence,this.deferWakeSleepUntil=e.deferWakeSleepUntil,this._layoutItems=[],this._awakeItems=[],this._inViewportItems=[],this._leadingOrphans=[],this._trailingOrphans=[],this._containerHeight=this.containerPadding.top,this._rows=[],this._orphans=[]}).prototype={getCurrentLayout:function(){return this._layoutItems.concat()},getAwakeItems:function(){return this._awakeItems.concat()},getInViewportItems:function(){return this._inViewportItems.concat()},hasLimitedNumberOfRows:function(){return this.maxNumRows!==o.maxNumRows},getLayoutItem:function(t){var e=null;return this._layoutItems.some(function(i){if(i.id===t)return e=i,!0}),e},getItemsInRow:function(t){return this._rows.length<=t?[]:this._rows[t].items.concat()},invalidateItem:function(t){var e,i=function(i,o,a){if(i.id===t)return a.splice(o,1),e=!0,!0};return this._layoutItems.some(i),this._leadingOrphans.some(i),this._trailingOrphans.some(i),this._rows.some(function(t){return t.items.some(i)}),this._orphans.some(i),e},clear:function(){this._layoutItems=[],this._leadingOrphans=[],this._trailingOrphans=[],this._containerHeight=this.containerPadding.top,this._rows=[],this._orphans=[]},updateTargetRowHeight:function(t){this.targetRowHeight=t,this.updatedRowHeight=this.targetRowHeight},computeLayout:function(t,e,o,a){var s,n,h,r,l,c,g,p,u,d={},m=[],w=[],f=[],_=!1,y=this;switch(this.containerWidth||(i.log("No valid containerWidth set on photo-list-layout; falling back to default"),this.containerWidth=1060),t||(t=[]),this.forceAspectRatio&&t.forEach(function(t){t.forcedAspectRatio=!0,t.aspectRatio=y.forceAspectRatio}),s=this._layoutItems.concat(),this._layoutItems.forEach(function(t){d[t.id]=t}),a||(a={diffType:"append"}),a.diffType){case"prepend":t=t.concat(this._leadingOrphans),this._leadingOrphans=[],t.reverse(),_=!0;break;case"merge":i.log("Due to the whims of product management, `merge` layouts are not yet implemented."),this.updateLayoutFrom(t,a.mergeStartIndex);break;case"relayout":a.diffDirection?"top"===a.diffDirection?t=t.concat(this._leadingOrphans.concat(this._layoutItems.concat(this._trailingOrphans))):"bottom"===a.diffDirection&&(t=this._leadingOrphans.concat(this._layoutItems.concat(this._trailingOrphans)).concat(t)):t=this._leadingOrphans.concat(this._layoutItems.concat(this._trailingOrphans)),this.clear();break;case"append":default:t=this._trailingOrphans.concat(t),this._trailingOrphans=[],this._rows.length>1&&(this._containerHeight=this._containerHeight-this.containerPadding.bottom+this.itemSpacing.vertical)}return t.some(function(t,e){if(r=!1,n||(n=y.createNewRow(_)),h=n.addItem(t),n.isLayoutComplete()){if(m=m.concat(y.addRow(n,_)),y._rows.length>=y.maxNumRows)return n=null,!0;if(n=y.createNewRow(_),!h)if(h=n.addItem(t),n.isLayoutComplete()){if(m=m.concat(y.addRow(n,_)),y._rows.length>=y.maxNumRows)return n=null,!0;n=y.createNewRow(_)}else h||(r=!0)}else h||(r=!0);r&&i.warn("computeLayout() Item not added and layout not complete",t)}),this._rows.length>=this.maxNumRows?(this._layoutItems||(i.warn("computeLayout() LayoutItems are unexpectedly undefined"),this._layoutItems=[]),this._trailingOrphans=t.slice(this._layoutItems.length)):n&&n.getItems().length&&(_?a.firstPage?(n.forceComplete(!0),m=m.concat(y.addRow(n,_))):this._leadingOrphans=n.getItems().reverse():a.lastPage||this.alwaysDisplayOrphans?(this._rows.length?(u=this._rows[this._rows.length-1].isBreakoutRow?this._rows[this._rows.length-1].targetRowHeight:this._rows[this._rows.length-1].height,n.forceComplete(!1,this.updatedRowHeight||u)):this.alwaysDisplayOrphans&&s.length?s[s.length-1].geometry&&n.forceComplete(!1,this.updatedRowHeight||s[s.length-1].geometry.height):n.forceComplete(!1),m=m.concat(y.addRow(n,_)),delete this.updatedRowHeight):this._trailingOrphans=n.getItems().concat()),m.forEach(function(t){d[t.id]?f.push(t):w.push(t)}),this._containerHeight=this._containerHeight-this.itemSpacing.vertical+this.containerPadding.bottom,_&&(p=this.containerPadding.top,this._rows.forEach(function(t){t.setTop(p),p+=t.height+y.itemSpacing.vertical}),f=s.concat()),g=this.computeWakeSleep(e,o,d),l=g.wakeSleepChangedItems,c=g.inViewportChangedItems,this._trailingOrphans.concat(this._leadingOrphans).forEach(function(t){d[t.id]&&(t.isAwake=!1,l.push(t))}),{allLayoutItems:this._layoutItems.concat(),newItems:w,layoutChangedItems:f,wakeSleepChangedItems:l,inViewportChangedItems:c,leadingOrphans:this._leadingOrphans.concat(),trailingOrphans:this._trailingOrphans.concat(),containerHeight:this._containerHeight}},computeWakeSleep:function(t,e,o){var a=this._awakeItems=[],s=this._inViewportItems=[];t||(t=0),e||(e=0),this.viewportContainerNodeHeight||(i.log("No valid viewport height available for photo-list-layout; falling back to default"),this.viewportContainerNodeHeight=1e3);var n,h,r,l,c,g=this.viewportContainerNodeHeight,p=.5*g*(this.awakeBoundsToViewportSizeRatio-1),u=t,d=t+g,m=u-p,w=d+p,f=[],_=[],y=this._layoutItems.length<this.deferWakeSleepUntil,I=this;return this.sleepLeftAndRight&&(n=this.appContext.viewportData.getWidth(),h=.5*n*(this.awakeBoundsToViewportSizeRatio-1),r=e-h,l=e+n+h),this._layoutItems.forEach(function(t){o&&(c=o[t.id]),y?t.isAwake=!0:(I.sleepTopAndBottom?t.isAwake=t.geometry.top+t.geometry.height>=m&&t.geometry.top<w:t.isAwake=!0,t.isAwake&&I.sleepLeftAndRight&&(t.isAwake=t.geometry.left+t.geometry.width>=r&&t.geometry.left<l)),c&&c.isAwake===t.isAwake||f.push(t),t.isAwake&&a.push(t),t.isInViewport=t.geometry.top+t.geometry.height>=u&&t.geometry.top<d,_.push(t),t.isInViewport&&s.push(t)}),{allLayoutItems:o?this._layoutItems:this._layoutItems.concat(),newItems:[],layoutChangedItems:[],wakeSleepChangedItems:f,inViewportChangedItems:_,leadingOrphans:this._leadingOrphans.concat(),trailingOrphans:this._trailingOrphans.concat(),containerHeight:this._containerHeight}},updateLayoutFrom:function(t,e){var i,o,a,s;this._layoutItems.length&&this._layoutItems.length>e&&(i=this._layoutItems[e],o=this.getRowOfItem(i.id),o&&(this._rows=this._rows.slice(0,o.index),a=this._rows[this._rows.length-1],this._containerHeight=a?a.top+a.height:0,o.indexInRow>0&&(s=this._layoutItems.splice(-o.indexInRow),s=s.map(function(t){return{id:t.id,aspectRatio:t.aspectRatio,layoutType:t.layoutType}}),t.unshift.apply(t,s))),this._layoutItems=this._layoutItems.slice(0,Math.min(this._layoutItems.length,e)))},createNewRow:function(e){var i=!1;return!1!==this.fullWidthBreakoutRowCadence&&(this._rows.length+1)%this.fullWidthBreakoutRowCadence==0&&(i=!0),new t.PhotoListLayoutRow({top:this._containerHeight,left:this.containerPadding.left,width:this.containerWidth-this.containerPadding.left-this.containerPadding.right,spacing:this.itemSpacing.horizontal,targetRowHeight:this.targetRowHeight,targetRowHeightTolerance:this.targetRowHeightTolerance,edgeCaseMinRowHeight:.5*this.targetRowHeight,edgeCaseMaxRowHeight:2*this.targetRowHeight,rightToLeft:e,isBreakoutRow:i})},addRow:function(t,e){return e?(this._rows.unshift(t),this._layoutItems=t.getItems().reverse().concat(this._layoutItems)):(this._rows.push(t),this._layoutItems=this._layoutItems.concat(t.getItems())),this._containerHeight+=t.height+this.itemSpacing.vertical,t.items},getRowOfItem:function(t){var e,i,o;for(i=0;i<this._rows.length;i++)if(e=this._rows[i],-1!==(o=e.getIndexOfItem(t)))return{row:e,index:i,indexInRow:o};return null}}},"@VERSION@",{requires:["photo-list-layout-row"]});
YUI.add("hermes-template-photo-list-photo",function(e,a){var r=e.Template.Handlebars.revive({1:function(e,a,r,t,n){return'\t<div class="interaction-view"></div>\n'},3:function(e,a,r,t,n){var l;return'\t<a class="click-target" href="'+e.escapeExpression((l=null!=(l=r.photoPageUrl||(null!=a?a.photoPageUrl:a))?l:r.helperMissing,"function"==typeof l?l.call(null!=a?a:{},{name:"photoPageUrl",hash:{},data:n}):l))+'" tabindex="0" role="heading" aria-level="3"></a>\n'},compiler:[7,">= 4.0.0"],main:function(e,a,r,t,n){var l;return null!=(l=r.if.call(null!=a?a:{},null!=a?a.hasInteraction:a,{name:"if",hash:{},fn:e.program(1,n,0),inverse:e.program(3,n,0),data:n}))?l:""},useData:!0}),t={};e.Array.each([],function(a){var r=e.Template.get("hermes/"+a);r&&(t[a]=r)}),e.Template.register("hermes/photo-list-photo",function(a,n){return n=n||{},n.partials=n.partials?e.merge(t,n.partials):t,r(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-list-photo-view",function(e){var t=require("lib/helpers/type-validator");e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.set("isZombie",!YUI.Env.isServer&&e.requiredToShowOnServer&&this.get("layoutItem")&&!this.get("layoutItem").isAwake),this},loadState:function(){var t=e.URLHelper.getPhotoPage({photoId:this.get("model").getValue("id"),pathAlias:this.get("model").getValue("owner").getValue("pathAlias"),contextSuffix:this.get("contextSuffix")});return this.set("photoPageUrl",t),e.Promise.resolve()},buildContainer:function(){var t,i=this.get("container"),r=this.get("layoutItem");if(r.isAwake)this.updateGeometry(),this.setContainerHTML(this.render()),YUI.Env.isServer?(i.setStyles({"background-image":"url("+this.get("photoUrl")+")"}),i.addClass("awake"),this.get("model").getValue("needsInterstitial")&&i.addClass("restricted-image")):(this.get("showLowResImageFirst")&&i.setStyles({backgroundImage:"url("+this.get("model").getValue("sizes").sq.url+")"}).addClass("low-res"),this.downloadCacheAndSetImage());else if(YUI.Env.isServer)this.set("isZombie",!0);else if(!YUI.Env.isServer||this.get("isZombie")){var n="";t=e.Node.create(this.get("placeHolderHTML")).set("innerHTML",this.render()),this.get("model").getValue("needsInterstitial")&&(n=" restricted-image"),t.setAttrs({id:i.getAttribute("id"),className:i.getAttribute("class")+n}),this.updateNodeGeometry(r,t),this.serialize(t),this.set("isReallySleeping",!0),this.set("isZombie",!1),this.downloadCacheAndSetImage()}return this.get("model").getValue("isVideo")&&this.get("container").addClass("is-video"),this},activate:function(){var e;return this.renderInteractionView().then(function(e){this.fire("activated")}.bind(this)),this.get("showLowResImageFirst")&&(e=this.get("parentContainer").getDOMNode(),e.addEventListener("transitionend",this.removeTransition),e.addEventListener("webkitTransitionEnd",this.removeTransition)),this.registerEventHandler(this.get("interactionContainer").delegate(["blur","focus"],this.toggleKeyboardFocusStyling.bind(this),"a")),this},toggleKeyboardFocusStyling:function(e){var t=e.target.ancestor(".interaction-view");t&&t.toggleClass("has-keyboard-focus")},setHoverVisible:function(e){var t=this.get("interactionContainer");t&&(e?t.addClass("manual-hover"):t.removeClass("manual-hover"))},render:function(){return this.templates("photo-list-photo")({photoPageUrl:this.get("photoPageUrl"),hasInteraction:!!this.get("interactionViewName")&&!this.appContext.forceServerRender})},removeTransition:function(e){e&&e.target&&e.target.classList&&e.target.classList.contains("photo-list-photo-view")&&e.target.classList.remove("low-res")},downloadCacheAndSetImage:function(){e.fluid.loadImage(this.get("photoUrl"),{timeout:1e3,retry:!0}).then(function(e){this.handleImageLoad(!0,e)}.bind(this),function(e){this.handleImageLoad(!1,e+"?retry="+Date.now())}.bind(this))},handleImageLoad:function(t,i){var r,n=this.get("isReallySleeping");r=n?this.deserialize():this.get("container"),r.setStyle("backgroundImage","url("+i+")"),t||r.setStyle("backgroundColor","#eee"),this.get("model").getValue("needsInterstitial")&&r.addClass("restricted-image"),n?this.serialize(r):e.fluid.chill(function(){var e=this.get("container");n||(e.addClass("awake"),this.fire(t?"loaded":"loadError"))},this),r=null},updateGeometry:function(e){var t,i=this.get("isReallySleeping");e?this.set("layoutItem",e):e=this.get("layoutItem"),t=i?this.deserialize():this.get("container"),this.updateNodeGeometry(e,t),i&&this.serialize(t),t=null},updateNodeGeometry:function(t,i){YUI.Env.isServer?i.setStyles({transform:"translate("+t.geometry.left+"px, "+t.geometry.top+"px)","-webkit-transform":"translate("+t.geometry.left+"px, "+t.geometry.top+"px)","-ms-transform":"translate("+t.geometry.left+"px, "+t.geometry.top+"px)"}):e.fluid.setStylePrefixed("transform","translate("+t.geometry.left+"px, "+t.geometry.top+"px)",i),i.setStyles({width:t.geometry.width+"px",height:t.geometry.height+"px"})},sleep:function(){var t,i;this.get("isReallySleeping")||(YUI.Env.isServer?this.set("isZombie",!0):(this.get("id"),this.destroyInteractionView(),i=this.get("container"),i.removeClass("awake"),this.serialize(i),t=e.Node.create(this.get("placeHolderHTML")),this.get("parentContainer").replaceChild(t,i),this.set("container",t),this.set("isReallySleeping",!0),this.set("isZombie",!1),i=null))},wake:function(){var t,i,r;this.get("isReallySleeping")&&(this.get("id"),t=this.get("container"),i=this.get("parentContainer"),r=this.deserialize(),i.replaceChild(r,t),this.set("container",r),this.set("isReallySleeping",!1),this.renderInteractionView(),e.fluid.chill(function(){this.get("container").addClass("awake")},this),t=null)},isAwake:function(){return!this.get("isReallySleeping")},serialize:function(t){if(YUI.Env.isServer)throw new Error("Impossible to `serialize` on the server (uses sessionStorage). Maybe you meant to call `sleep`?");t&&e.Storage.Instance.set(this.get("storageId"),t.getDOMNode().outerHTML)},deserialize:function(){if(YUI.Env.isServer)throw new Error("Impossible to `deserialize` on the server (uses sessionStorage). Maybe you meant to call `wake`?");var t,i=e.Storage.Instance.get(this.get("storageId"));return i&&(t=e.Node.create(i),this.dematerialize()),t},dematerialize:function(){if(YUI.Env.isServer)throw new Error("Impossible to `dematerialize` on the server (uses sessionStorage).");e.Storage.Instance.remove(this.get("storageId"))},renderInteractionView:function(){var t,i=this.get("interactionViewName"),r=this.get("interactionView");return i&&!r?this.appContext.getView(i,e.merge(this._params,{id:this.get("id"),container:this.get("interactionContainer"),model:this.get("model"),listModelParams:this.get("listModelParams"),photoPageUrl:this.get("photoPageUrl"),isActiveViewAgnostic:this.get("isActiveViewAgnostic"),engagementModelName:this.get("engagementModelName"),layoutWidth:this.get("layoutItem").geometry.width})).then(function(e){return this.set("interactionView",e),e.initialize()}.bind(this)):r?(r.get("container").inDoc()||(t=r.get("container"),t.addClass("interaction-view"),this.get("interactionContainer")||this.buildContainer(),this.get("container").replaceChild(t,this.get("interactionContainer")),r.normalizedActivate()),e.Promise.resolve(r)):e.Promise.resolve(null)},destroyInteractionView:function(){var e=this.get("interactionView");e&&(e.destroy(),this.set("interactionView",null))},destructor:function(){this.dematerialize()}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(e,i){return t.photoId(e)}},parentSignature:{writeOnce:"initOnly"},storageId:{readOnly:!0,derivedBy:["id","parentSignature"],getter:function(){return this.get("parentSignature")+"-"+this.get("id")}},layoutItem:{validator:function(e,t){return"object"==typeof e&&e.hasOwnProperty("aspectRatio")&&e.hasOwnProperty("geometry")&&"object"==typeof e.geometry&&e.geometry.hasOwnProperty("width")&&e.geometry.hasOwnProperty("height")&&e.geometry.hasOwnProperty("top")&&e.geometry.hasOwnProperty("left")&&e.hasOwnProperty("isAwake")}},photoUrl:{value:"/images/spaceball.gif",getter:function(e,t){var i,r=this.get("model"),n=this.get("layoutItem");return i=r.getSizeToFit({width:n.geometry.width,height:n.geometry.height},{includeSquare:1===n.aspectRatio}),i.url}},photoPageUrl:{writeOnce:!0,validator:function(t,i){return e.AttributeHelpers.validateString(t)}},model:{value:null},listModelParams:{value:null},parentContainer:{writeOnce:"initOnly"},contextSuffix:{writeOnce:"initOnly",value:null,validator:function(t,i){return e.AttributeHelpers.validateString(t)}},measureAFT:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)}},isReallySleeping:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)}},isZombie:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)}},placeHolderHTML:{value:'<div class="youcansleepwhenyouredead" />',validator:function(t,i){return e.AttributeHelpers.validateString(t)}},showLowResImageFirst:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)}},interactionViewName:{writeOnce:"initOnly",value:null,validator:function(t,i){return e.AttributeHelpers.validateString(t)}},engagementModelName:{writeOnce:"initOnly",value:null,validator:function(t,i){return e.AttributeHelpers.validateString(t)}},interactionView:{value:null},interactionContainer:{value:null,getter:function(e,t){return e||YUI.Env.isServer||(e=this.get("container").one(".interaction-view")),e}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-list-photo","url-helper","attribute-helpers"],optionalRequires:["fluid","storage-helper"],langBundles:["common"]});
YUI.add("photo-list-view",function(t,e){"use strict";var i=require("lib/flog")(e),o={containerWidth:"fullWidth",subtractScrollbarWidth:!1,pageParams:{page:1,perPage:50},parentName:"",subviewMapping:{"photo-models":{name:"photo-list-photo-view",params:null},"photo-lite-models":{name:"photo-list-photo-view",params:null},"set-models":{name:"photo-list-album-view",params:null},"gallery-models":{name:"photo-list-album-view",params:null}},paginateOnScroll:!0,keepAwakeOnScroll:!1,parentContainer:t.config.win,loadMoreMargin:3,relayoutOnResize:!0,recenterOnResize:!1,responsiveRowHeight:!1,maintainScrollPosition:!0,interactionViewName:"photo-list-photo-interaction-view",engagementModelName:"photo-engagement-models",itemFilterFunction:null,injectPhotolistContextParams:null,measureAFT:!1,beaconViews:!0,scrollInterruptParams:null,scrollToWithId:!1,handleCollectionChanged:!1},n={480:.5,800:.75,1280:1,1600:1.25},s=Object.keys(n);t.FlickrView.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){var n,s=t.merge(o,e.photoListConfig);if(void 0===s)throw new Error("photo-list-view must be initialized with config params wrapped in a `photoListConfig` object.");if(s.initialItems)this.initialItems=s.initialItems.concat(),s.paginateOnScroll=!1;else{if(void 0===s.modelParams)throw new Error("photo-list-view must be initialized with `modelParams`.");if(void 0===s.modelParams.registryName)throw new Error("photo-list-view must be initialized with `modelParams.registryName`.");if(void 0===s.modelParams.modelIdOrAttributes)throw new Error("photo-list-view must be initialized with `modelParams.modelIdOrAttributes`.");if(void 0===s.modelParams.collectionAttributeName)throw new Error("photo-list-view must be initialized with `modelParams.collectionAttributeName`.")}if(void 0===s.parentName)throw new Error("photo-list-view must be initialized with the `parentName` (the name of the module containing the photolist).");return this.parentName=s.parentName,this.modelParams=s.modelParams,this.pageParams=s.pageParams,this.subviewMapping=s.subviewMapping,this.loadMoreMargin=s.loadMoreMargin,this.relayoutOnResize=s.relayoutOnResize,this.recenterOnResize=s.recenterOnResize,this.responsiveRowHeight=s.responsiveRowHeight,this.contextSuffix=s.contextSuffix,this.measureAFT=s.measureAFT,!YUI.Env.isServer&&s.beaconViews&&(this.viewBeaconer={beaconer:this.appContext.getViewCounter(),beaconAttribute:s.viewBeaconAttribute||"id",beaconRestrictedAttribute:s.viewBeaconRestrictedAttribute||"needsInterstitial",beaconAlwaysBeacon:s.viewBeaconAlwaysBeacon||!1,beaconIsOwnerAttribute:s.viewBeaconIsOwnerAttribute||"isOwner"}),s.subtractScrollbarWidth?YUI.Env.isServer?this.scrollbarWidth=this.appContext.viewportData.scrollbarWidth:this.scrollbarWidth=t.OverflowHelper.detectScrollbarSize(t.one("body")):this.scrollbarWidth=0,s.layout?(s.layout instanceof t.PhotoListLayout?(i.warn("Passing a PhotoListLayout instance into PhotoListView is deprecated. Instead, send the layout config object, and PhotoListView will create the PhotoListLayout for you."),this.photoListLayout=s.layout):(this.isMobile&&s.mobileLayout&&(0===Object.keys(s.mobileLayout).length&&(s.mobileLayout={targetRowHeight:200,containerPadding:{right:16,left:16},itemSpacing:{horizontal:16,vertical:16}}),s.layout.targetRowHeight=s.mobileLayout.targetRowHeight||s.layout.targetRowHeight,s.layout.containerPadding=t.merge(s.layout.containerPadding||{},s.mobileLayout.containerPadding||{}),s.layout.itemSpacing=t.merge(s.layout.itemSpacing||{},s.mobileLayout.itemSpacing||{})),this.photoListLayout=new t.PhotoListLayout(t.merge(s.layout,{appContext:this.appContext}))),delete s.layout.appContext):this.photoListLayout=new t.PhotoListLayout({appContext:this.appContext}),this.photoListLayout.containerWidth||(YUI.Env.isServer||(n=this.appContext.flapp.get("activeView")),this.appContext.hasClientSideRouted()&&n&&n.name===this.parentName?this.photoListLayout.containerWidth=this.calculateContainerWidth("previousContainerWidth"):(this.explicitContainerWidth=s.containerWidth,this.photoListLayout.containerWidth=this.calculateContainerWidth(this.explicitContainerWidth))),this.baseRowHeight=this.photoListLayout.targetRowHeight,this.responsiveRowHeight&&this.adjustRowHeightToContainerWidth(),this.paginateOnScroll=s.paginateOnScroll,this.paginateOnScroll&&this.photoListLayout.layout&&this.photoListLayout.hasLimitedNumberOfRows()&&i.warn("When photo-list-layout::maxNumRows is specified, photo-list::paginateOnScroll should probably be set to `false`."),this.parentContainer=s.parentContainer,this.keepAwakeOnScroll=s.keepAwakeOnScroll,this.keepAwakeOnScroll&&(this.photoListLayout.sleepTopAndBottom=!1),this.loadingMoreBottom=!1,this.loadingMoreTop=!1,this.lastItemCached=!1,this.firstItemCached=!1,this.itemsMappedToAspectRatios=[],this.lowestPageInView=this.pageParams.page,this.highestPageInView=this.pageParams.page,this.pageParams.viewPageSize&&(this.lastPageInView=this.pageParams.page+Math.ceil(this.pageParams.viewPageSize/this.pageParams.perPage)-1,isNaN(this.lastPageInView)&&i.warn("Error calculating `this.lastPageInView`. Verify values passed for `config.pageParams`.")),this.modelsById={},this.subviewsById={},this.fetchedOnlyInitPage=!1,this.perPageDoubles=0,this.interactionViewName=s.interactionViewName,this.engagementModelName=s.engagementModelName,this.maintainScrollPosition=s.maintainScrollPosition,this.scrollToWithId=s.scrollToWithId,this.handleCollectionChanged=s.handleCollectionChanged,this.itemFilterFunction=s.itemFilterFunction,s.injectPhotolistContextParams&&(this.injectPhotolistContextParams=t.merge(s.injectPhotolistContextParams)),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.aftCache={},s.scrollInterruptParams&&(this.scrollInterruptParams=s.scrollInterruptParams,this.scrollInterruptState={nextInterrupt:this.scrollInterruptParams.pageCounts[0],numPagesLoaded:0,numInterrupts:0,isInterrupted:!1,footer:null,footerHeight:0}),delete e.photoListConfig,this.params=e,this},loadState:function(){var e,o,n=this;return this.initialItems?this.setItems(this.initialItems).then(this.loadStateSubviewsReady.bind(this),function(t){i.error("Error displaying initial items",{err:t})}):(e=t.merge(this.modelParams.fetchParams,this.pageParams),this.paginateOnScroll&&!this.scrollToWithId&&(e.page=2*(this.pageParams.page-1)+1,e.perPage=Math.floor(.5*this.pageParams.perPage),this.fetchedOnlyInitPage=!0),this.appContext.getModel(this.modelParams.registryName,this.modelParams.modelIdOrAttributes,e).then(function(i){var s,a=i.getValue(n.modelParams.collectionAttributeName),r=a.getList();if(n.set("collectionModel",i),n.lastPageInView)return o=Math.min(a.getNextIncompletePage(n.pageParams),n.lastPageInView+1),o<=n.pageParams.page?a.getPage(e):(s=a.getList().slice((n.pageParams.page-1)*n.pageParams.perPage,(o-1)*n.pageParams.perPage),t.Promise.resolve(s));var l=(e.page||1)*(e.perPage||0);return r.length&&(a.fetchedEnd||r.length>=l)?t.Promise.resolve(r):a.getPage(e)},function(t){i.error("error fetching model",{err:t})}).then(function(e){var i=n.get("collectionModel").getValue(n.modelParams.collectionAttributeName),s=i.getList(),a=i.getFirstItem(),r=i.getLastItem();return e&&e.length?(n.lastPageInView?(n.lowestPageInView=n.pageParams.page,o===n.lastPageInView?n.highestPageInView=o-(Math.floor(n.pageParams.viewPageSize/n.pageParams.perPage)-1):n.highestPageInView=Math.max(n.lowestPageInView,o)):(n.lowestPageInView=Math.floor(a.index/n.pageParams.perPage)+1,n.highestPageInView=Math.floor(r.index/n.pageParams.perPage)+1),!YUI.Env.isServer&&n.scrollInterruptState&&n.updateScrollInterruptState(n.highestPageInView-1),i.fetchedEnd&&e.length&&s.length&&e[e.length-1]&&s[s.length-1]&&e[e.length-1].id===s[s.length-1].id?n.lastItemCached=!0:n.highestPageInView>=n.lastPageInView&&(n.lastItemCached=!0),n.itemFilterFunction&&"function"==typeof n.itemFilterFunction&&(e=e.filter(n.itemFilterFunction)),n.layOutItems(e,"bottom")):t.Promise.resolve(null)},function(t){i.error("Calculate layout and generate subviews",{err:t})}).then(this.loadStateSubviewsReady.bind(this),function(t){i.warn("Error loading items from registry",{err:t,registry:n.modelParams.registryName,modelIdOrAttributes:n.modelParams.modelIdOrAttributes})}))},loadStateSubviewsReady:function(t){var e=0,i=this.photoListLayout.getAwakeItems().length;YUI.Env.isServer||(this.measureAFT&&this.appContext.hasClientSideRouted()&&t&&t.length&&t.forEach(function(t){t.once("loaded",function(o){this.aftCache[t.get("id")]=(new Date).getTime(),++e>=i&&this.reportAFTResults()}.bind(this))}.bind(this)),this.get("container").hasClass("requiredToShowOnServer")&&this.photoListLayout.containerWidth!==this.retrieveContainerWidth()&&(this._relayoutQueued=!0))},buildContainer:function(){return this.setContainerHTML(""),this.get("container").setStyle("height",this.containerHeight+"px"),this.initialLayoutResponse&&(this.renderSubviews(null,this.initialLayoutResponse),delete this.initialLayoutResponse),this},buildHeadContainer:function(){if(!YUI.Env.isServer)return this;var t,e,i=this;return this.measureAFT&&(t=Object.keys(this.subviewsById).map(function(t){return e=i.subviewsById[t],{id:t,url:e.get("photoUrl")}}),this.set("headContainer",this.templates("photo-list-aft")({photolistId:this.getAFTTimingKey(),photos:t}))),this},activate:function(){var e;return this._relayoutQueued&&(this._relayoutQueued=!1,this.initialLayoutResponse?(this.buildContainer(),this.storeContainerWidth(this.photoListLayout.containerWidth)):this.handleResize(null)),!this.paginateOnScroll&&this.keepAwakeOnScroll||(this.handleScroll(),this.parentContainer!==t.config.win&&this.parentContainer instanceof t.Node?this.registerEventHandler(this.parentContainer.on("scroll",this.handleScroll.bind(this))):this.registerEventHandler(t.globalEvents.subscribe("window:scroll",this.handleScroll.bind(this)))),this.relayoutOnResize&&this.registerEventHandler(t.globalEvents.subscribe("window:resize",this.handleResize.bind(this))),!YUI.Env.isServer&&this.maintainScrollPosition?this.photoListLayout.hasLimitedNumberOfRows()||(!(e=this.appContext.getReferrer())||e&&e!==this.appContext.flapp.getPath())&&this.restoreScrollPosition():!YUI.Env.isServer&&this.scrollToWithId&&this.scrollToId(this.scrollToWithId),this.injectPhotolistContextParams&&this.registerEventHandler(this.get("container").delegate("click",this.injectPhotolistContext.bind(this),"a")),this.registerEventHandler(this.get("container").delegate("click",this.subviewExtraToolClicked.bind(this),".extra-tool")),Object.keys(this.subviewMapping).some(function(t){return this.subviewMapping[t]&&"photo-list-tile-view"===this.subviewMapping[t].name}.bind(this))&&this.registerEventHandler(this.get("container").delegate("mouseenter",this.subviewLicenseMouseenter.bind(this),".license")),this.measureAFT&&this.reportAFTResults(),this.handleCollectionChanged&&this.registerEventHandler(this.get("collectionModel").on("valuesChanged",this.onCollectionModelValuesChanged.bind(this))),this.activateSubviews(),this},setItems:function(t){var e,i=this;return this.containerHeight=0,this.itemsMappedToAspectRatios=[],this.modelsById={},this.subviewsById={},this.get("collectionModel")&&(e=this.get("collectionModel").getValue(this.modelParams.collectionAttributeName),e.fetchedStart?this.firstItemCached=!0:this.firstItemCached=!1,e.fetchedEnd?this.lastItemCached=!0:this.lastItemCached=!1),this.get("container").setHTML(""),this.photoListLayout.clear(),this.get("showThrobberDuringLoad")&&this.toggleThrobber(!0),this.layOutItems(t,"bottom").then(function(t){i.get("showThrobberDuringLoad")&&i.toggleThrobber(!1)})},getContainingElementData:function(){var e,i=this.get("container");return e={height:0,scrollLeft:0,scrollTop:0},e=this.parentContainer!==t.config.win&&this.parentContainer instanceof t.Node?{height:this.parentContainer.get("offsetHeight"),scrollLeft:this.parentContainer.getDOMNode().scrollLeft,scrollTop:this.parentContainer.getDOMNode().scrollTop}:{height:this.appContext.viewportData.getHeight(),scrollLeft:YUI.Env.isServer?0:t.config.win.pageXOffset,scrollTop:YUI.Env.isServer?0:t.config.win.pageYOffset},i&&(e.scrollLeft-=i.get("offsetLeft"),e.scrollTop-=i.get("offsetTop")),e},setContainerScrollTop:function(e){this.parentContainer!==t.config.win&&this.parentContainer instanceof t.Node?this.parentContainer.getDOMNode().scrollTop=e:t.config.win.scrollTo(0,e)},setTargetRowHeight:function(t){return this.photoListLayout.updateTargetRowHeight(t),this.handleResize(null,!0)},getSubview:function(t){return this.subviewsById[t]},handleScroll:function(e){var i,o=this,n=this.get("container"),s=n.get("clientHeight"),a=n.get("offsetParent").get("offsetTop")-n.get("offsetTop")+s,r=this.getContainingElementData(),l=r.height,h=r.scrollTop,c=h+l,u=!0;for(var d in this.subviewsById){u=!1;break}u||(!this.paginateOnScroll||this.scrollInterruptState&&this.scrollInterruptState.isInterrupted||((!this.lastPageInView||this.highestPageInView<this.lastPageInView)&&a-c<this.loadMoreMargin*l&&this.loadMore("bottom"),!this.lastPageInView&&h<this.loadMoreMargin*l&&this.lowestPageInView>1&&this.loadMore("top")),this.keepAwakeOnScroll||(i=this.photoListLayout.computeWakeSleep(r.scrollTop,r.scrollLeft),this.wakeOrSleepSubviews(i.wakeSleepChangedItems),!YUI.Env.isServer&&this.viewBeaconer&&i.inViewportChangedItems&&this.processInViewportItems(i.inViewportChangedItems)),void 0!==e&&(this.afterScrollTimeoutId&&t.config.win.clearTimeout(this.afterScrollTimeoutId),this.afterScrollTimeoutId=t.config.win.setTimeout(function(){o.paginateOnScroll&&o.storeScrollPosition(),o.paginateOnScroll&&!o.keepAwakeOnScroll&&o.validateWakeSleep(i),delete o.afterScrollTimeoutId},250)))},handleResize:function(t,e){this.responsiveRowHeight&&this.adjustRowHeightToContainerWidth();var i,o,n=this.calculateContainerWidth(),s=this.get("container"),a=this.getContainingElementData(),r={diffType:"relayout",firstPage:this.firstItemCached,lastPage:this.lastItemCached};if(e||n-this.scrollbarWidth!==this.photoListLayout.containerWidth)return this.storeContainerWidth(n),this.photoListLayout.containerWidth=n-this.scrollbarWidth,i=this.photoListLayout.computeLayout(null,a.scrollTop,a.scrollLeft,r),this.containerHeight=i.containerHeight,this.scrollInterruptState&&this.scrollInterruptState.isInterrupted&&this.scrollInterruptState.loadMoreElement&&this.scrollInterruptState.loadMoreElement.setStyle("width",this.photoListLayout.containerWidth+"px"),s.setStyle("height",i.containerHeight+"px"),o=this.updateSubviews(i,"bottom"),this.recenterOnResize&&this.scrollToCenterItem(i.allLayoutItems),o},loadMore:function(e){"search-photos-lite-models"===this.modelParams.registryName&&this.modelParams.fetchParams&&this.modelParams.fetchParams.apiParams&&void 0!==this.modelParams.fetchParams.apiParams.page&&delete this.modelParams.fetchParams.apiParams.page;var o=this,n=this.get("collectionModel"),s=n.getValue(this.modelParams.collectionAttributeName),a=s.getList(),r=t.merge(this.modelParams.fetchParams,this.pageParams);if("bottom"!==e||this.loadingMoreBottom)"top"!==e||this.loadingMoreTop||(r.page=this.lowestPageInView-1,o.lowestPageInView>1&&(this.loadingMoreTop=!0,s.getPage(r).then(function(t){s.fetchedStart&&t[0].id===s.getList()[0].id&&(o.firstItemCached=!0),o.lowestPageInView=o.lowestPageInView-1,o.layOutItems(t,e).then(function(t){o.loadingMoreTop=!1,o.paginateOnScroll&&(r.page<=0?i.warn("loadMore fetching beyond start of collection; aborting",{params:r}):o.handleScroll())})},function(t){i.error("loadMore page fetch failed",{err:t}),o.toggleThrobber(!1)})));else{if(this.fetchedOnlyInitPage?(r.page=2*(this.pageParams.page-1)+2,r.perPage=Math.floor(.5*this.pageParams.perPage)):r.page=this.highestPageInView+1,s.fetchedEnd&&this.lastItemCached)return;this.loadingMoreBottom=!0,this.scrollInterruptParams&&this.scrollInterruptParams.footerToHideWhileScrolling&&!this.scrollInterruptState.footer&&(this.scrollInterruptState.footer=t.one(this.scrollInterruptParams.footerToHideWhileScrolling),this.scrollInterruptState.footer&&(this.scrollInterruptState.footerHeight=this.scrollInterruptState.footer.get("clientHeight"),this.setFooterDisplay(!1))),this.get("showThrobberDuringLoad")&&this.toggleThrobber(!0),s.getPage(r).then(function(t){a=s.getList(),s.fetchedEnd&&t[t.length-1].id===a[a.length-1].id&&(o.lastItemCached=!0),o.fetchedOnlyInitPage?o.fetchedOnlyInitPage=!1:(r.perPageDoubling&&o.perPageDoubles<r.perPageDoubling&&(o.perPageDoubles++,o.pageParams.perPage*=2,o.highestPageInView=Math.floor(.5*o.highestPageInView),o.lastPageInView=Math.floor(.5*o.lastPageInView)),o.highestPageInView=o.highestPageInView+1),o.highestPageInView>=o.lastPageInView&&(o.lastItemCached=!0),o.itemFilterFunction&&"function"==typeof o.itemFilterFunction&&(t=t.filter(o.itemFilterFunction)),o.layOutItems(t,e).then(function(t){o.loadingMoreBottom=!1,o.paginateOnScroll&&(s.totalItems&&(r.page-1)*r.perPage>s.totalItems?i.warn("loadMore fetching beyond end of collection; aborting",{params:r,total:s.totalItems}):o.handleScroll())}),o.scrollInterruptState&&(o.lastItemCached?o.setFooterDisplay(!0):(o.scrollInterruptState.numPagesLoaded++,o.checkScrollInterruptionState())),o.get("showThrobberDuringLoad")&&o.toggleThrobber(!1)},function(t){i.error("loadMore page fetch failed",{err:t}),o.toggleThrobber(!1)})}},layOutItems:function(e,o,n){if(!e||!e.length)return t.Promise.resolve();var s,a,r,l=this.containerHeight,h={},c=this.get("container"),u=this.getContainingElementData();if(e=this.cacheModelsById(e),s=this.itemsToAspectRatios(e),"bottom"===o)this.itemsMappedToAspectRatios=this.itemsMappedToAspectRatios.concat(s),a=s,h.diffType="append",this.lastItemCached&&(h.lastPage=!0);else{if("top"!==o)return void i.warn("Unsupported `layOutItems` direction",{direction:o});this.itemsMappedToAspectRatios=s.concat(this.itemsMappedToAspectRatios),a=s,h.diffType="prepend",this.firstItemCached&&(h.firstPage=!0)}return n&&(h.diffType="relayout",h.diffDirection=o),r=this.photoListLayout.computeLayout(a,u.scrollTop,u.scrollLeft,h),c.setStyle("height",r.containerHeight+"px"),this.containerHeight=r.containerHeight,"top"===o&&this.setContainerScrollTop(this.containerHeight-l),this.updateSubviews(r,o)},updateSubviews:function(t,e){var o,n=this;return this.instantiateSubviews(t.newItems).then(function(i){return i=i.filter(function(t){return!!t}),n.updateSubviewGeometry(t.layoutChangedItems),n.isBuilt?(n.renderSubviews(i,t,e),n.activateSubviews(i),t.wakeSleepChangedItems.length&&(o=t.wakeSleepChangedItems.filter(function(e){return-1===t.newItems.indexOf(e)}),o.length&&n.wakeOrSleepSubviews(o)),t.inViewportChangedItems.length&&n.processInViewportItems(t.inViewportChangedItems)):n.initialLayoutResponse=t,i},function(t){i.error("Error instantiating subviews",{err:t})})},instantiateSubviews:function(e){var o,n=[],s=this,a=this.get("container");e.forEach(function(e){if(!(o=s.modelsById[e.id]))return void i.warn("Model missing from cache",{modelId:e.id});s.subviewsById[e.id]?n.push(t.Promise.resolve(s.subviewsById[e.id])):n.push((function(o,n){var r=t.merge(s.params,{id:e.id,parentSignature:s.getPhotolistSignature(),model:o,contextSuffix:s.contextSuffix,layoutItem:n,parentContainer:a,interactionViewName:s.interactionViewName,engagementModelName:s.engagementModelName,measureAFT:s.measureAFT}),l=s.subviewMapping[o.registry.name];return l.params&&(r=t.merge(r,l.params),r.removePoolPhoto&&(r.listModelParams=s.modelParams)),s.instantiateSubview(l.name,r).then(function(t){return t.initialize().then(function(t){return s.subviewsById[n.id]=t,s.subviews={},t},function(t){return i.warn("Error in lifecycle of subview",{err:t,view:l.name}),s.photoListLayout.invalidateItem(n.id),null})},function(t){i.warn("Error instantiating subview",{err:t,view:l.name})})})(o,e))});var r=t.Promise.all(n);return r.then(function(t){return!YUI.Env.isServer&&s.viewBeaconer&&s.viewBeaconer.beaconer.flushQueue({avoidDuplicates:!0}),t}),r},renderSubviews:function(t,e,o){var n,s,a,r,l=this.get("container"),h=this;t||(t=[],e.allLayoutItems.forEach(function(e){var i=h.subviewsById[e.id];i&&t.push(i)})),o||(o="bottom"),YUI.Env.isServer?(n=t.map(function(t){return t.get("container").get("outerHTML")}),"top"===o?l.setHTML(n.join("")+l.getHTML()):"bottom"===o?l.setHTML(l.getHTML()+n.join("")):(i.warn("Unsupported `renderSubviews` direction; appending changed subviews.",{direction:o}),l.setHTML(l.getHTML()+n.join("")))):("top"===o&&t.reverse(),s=YUI.config.doc.createDocumentFragment(),t.forEach(function(t){t&&s.appendChild(t.get("container").getDOMNode())}),"top"===o?l.prepend(s):"bottom"===o?l.append(s):(i.warn("Unsupported `renderSubviews` direction; appending changed subviews.",{direction:o}),l.append(s))),a=e.wakeSleepChangedItems.filter(function(t){return-1!==e.newItems.indexOf(t)}),this.updateSubviewGeometry(a),this.keepAwakeOnScroll?(r=e.wakeSleepChangedItems.filter(function(t){return-1!==e.leadingOrphans.indexOf(t)||-1!==e.trailingOrphans.indexOf(t)}),a.forEach(function(t){t.isAwake=!0}),this.wakeOrSleepSubviews(a.concat(r))):this.wakeOrSleepSubviews(e.wakeSleepChangedItems)},updateSubviewGeometry:function(t){var e,o=this;t.forEach(function(t){e=o.subviewsById[t.id],e?e.updateGeometry?e.updateGeometry(t):e.get("container").setStyles({width:t.geometry.width+"px",height:t.geometry.height+"px",transform:"translate("+t.geometry.left+"px, "+t.geometry.top+"px)","-webkit-transform":"translate("+t.geometry.left+"px, "+t.geometry.top+"px)","-ms-transform":"translate("+t.geometry.left+"px, "+t.geometry.top+"px)"}):i.warn("Subview missing from cache for geometry update",{layoutItemId:t.id})})},wakeOrSleepSubviews:function(t){var e,o=this;t.forEach(function(t){e=o.subviewsById[t.id],e?e.wake&&e.sleep?t.isAwake?e.wake():e.sleep():e.get("container").setStyle("display",t.isAwake?"":"none"):i.warn("Subview missing from cache for wake/sleep update",{layoutItemId:t.id})})},processInViewportItems:function(e){var i,o=this;e.forEach(function(e){if(e.isInViewport){if(!(i=o.subviewsById[e.id]))return;!YUI.Env.isServer&&o.viewBeaconer&&o.viewBeaconer.beaconer&&(i.get("model").getValue(o.viewBeaconer.beaconIsOwnerAttribute)||!o.viewBeaconer.beaconAlwaysBeacon&&i.get("model").getValue(o.viewBeaconer.beaconRestrictedAttribute)||o.viewBeaconer.beaconer.queue(i.get("model").getValue(o.viewBeaconer.beaconAttribute),t.config.win.document.location.href))}})},activateSubviews:function(t){if(!t){t=[];for(var e in this.subviewsById)t.push(this.subviewsById[e])}t.forEach(function(t){t.normalizedActivate()})},removeItems:function(t){var e=this;t.forEach(function(t){e.photoListLayout.invalidateItem(t.id),e.itemsMappedToAspectRatios=e.itemsMappedToAspectRatios.filter(function(e){return e.id!==t.id}),e.modelsById[t.id]&&delete e.modelsById[t.id],e.subviewsById[t.id]&&(e.subviewsById[t.id].destroy({remove:!0}),delete e.subviewsById[t.id])})},onCollectionModelValuesChanged:function(t,e){var i,o,n,s,a;if(t[this.modelParams.collectionAttributeName]&&t[this.modelParams.collectionAttributeName].listDiff&&(i=t[this.modelParams.collectionAttributeName].listDiff,!this.loadingMoreBottom&&!this.loadingMoreTop)){if(o=this.get("collectionModel").getValue(this.modelParams.collectionAttributeName),n=o.getList(),i.added.length){var r,l,h,c;s=i.added,r=n.indexOf(s[0])-1,-1!==r&&(l=n[r])&&this.modelsById[l.id]&&(a="bottom",o.fetchedEnd&&s[s.length-1].id===n[s.length-1].id&&(this.lastItemCached=!0)),h=n.indexOf(s[s.length-1])+1,-1!==h&&(c=n[h+1])&&this.modelsById[c.id]&&(a="top",o.fetchedStart&&s[0].id===n[0].id&&(this.firstItemCached=!0)),a&&this.layOutItems(s,a,e)}i.removed.length&&(this.removeItems(i.removed),this.handleResize(null,!0))}},toggleThrobber:function(t){var e=this.get("container");void 0===t&&(t=!this.get("isThrobberShowing")),t?(e.setStyle("height",this.containerHeight+100+"px"),this.get("throbberNode").appendTo(e)):this.get("throbberNode").remove(),this._set("isThrobberShowing",t)},checkScrollInterruptionState:function(t){if(this.scrollInterruptState||t){var e;if(this.scrollInterruptState.numPagesLoaded>=this.scrollInterruptState.nextInterrupt){if(this.scrollInterruptState.numInterrupts++,e=this.scrollInterruptParams.pageCounts[this.scrollInterruptParams.pageCounts.length-1],this.scrollInterruptState.numInterrupts>=this.scrollInterruptParams.pageCounts.length)switch(this.scrollInterruptParams.repeatMode){case"exponential":this.scrollInterruptState.nextInterrupt+=e*Math.pow(2,this.scrollInterruptState.numInterrupts-this.scrollInterruptParams.pageCounts.length);break;case"linear":default:this.scrollInterruptState.nextInterrupt+=e}else this.scrollInterruptState.nextInterrupt+=this.scrollInterruptParams.pageCounts[this.scrollInterruptState.numInterrupts];t||this.interruptScroll()}else this.get("container").setStyle("paddingBottom","0px")}},updateScrollInterruptState:function(t){this.scrollInterruptState.numPagesLoaded=t;for(var e=0;e<=t;e++)this.checkScrollInterruptionState(!0)},interruptScroll:function(){this.scrollInterruptState.isInterrupted||(this.scrollInterruptState.isInterrupted=!0,this.scrollInterruptState.loadMoreElement||(this.scrollInterruptState.loadMoreElement=t.Node.create(this.templates("infinite-scroll-load-more")({}))),this.get("container").append(this.scrollInterruptState.loadMoreElement),this.scrollInterruptState.loadMoreElementHeight||(this.scrollInterruptState.loadMoreElementHeight=parseInt(this.scrollInterruptState.loadMoreElement.getComputedStyle("height").replace("px",""),10)+20,this.registerEventHandler(this.scrollInterruptState.loadMoreElement.on("click",this.onLoadMoreClicked.bind(this))),this.scrollInterruptState.loadMoreElement.setStyles({width:this.photoListLayout.containerWidth+"px",bottom:this.photoListLayout.containerPadding.bottom+"px"})),this.setFooterDisplay(!0),this.get("container").setStyle("paddingBottom",this.scrollInterruptState.loadMoreElementHeight+"px"))},onLoadMoreClicked:function(e){var i,o=t.config.win.pageYOffset;this.scrollInterruptState.isInterrupted&&(this.scrollInterruptState.isInterrupted=!1,this.scrollInterruptState.loadMoreElement.remove(),this.setFooterDisplay(!1),this.get("container").setStyle("paddingBottom",this.scrollInterruptState.footerHeight+this.scrollInterruptState.loadMoreElementHeight-100+"px"),this.loadMore("bottom"),i=t.config.win.pageYOffset,t.config.win.scrollBy(0,o-i))},setFooterDisplay:function(t){this.scrollInterruptState.footer&&(t?this.scrollInterruptState.footer.removeClass("infinite-scroll-hide-footer"):this.scrollInterruptState.footer.addClass("infinite-scroll-hide-footer"),this.fire("subviewViewEvent","footerDisplayChanged"))},cacheModelsById:function(t){if(t&&t.length){var e=this.modelsById,i=[];return t.forEach(function(t){t&&!e[t.id]&&(e[t.id]=t,i.push(t))}),i}},itemsToAspectRatios:function(t){var e=[],i=this.photoListLayout.forceAspectRatio,o=void 0!==i&&!isNaN(i),n=i||1;return t.forEach(function(t){void 0!==t&&e.push({id:t.id,aspectRatio:o?n:t.getValue("aspectRatio")})}),e},calculateContainerWidth:function(e){if(e||(e=this.explicitContainerWidth),"number"==typeof e)return e;var i,o;switch(e){case"previousContainerWidth":o=this.getContainerWidthFromCache();break;case"fullWidth":default:YUI.Env.isServer||(this.isActiveAndInDOM()?o=this.get("container").get("clientWidth")-this.scrollbarWidth:(i=this.get("container"),this.isBuilt&&i||(i=t.one("."+this.parentName)),i&&(o=parseInt(i.getStyle("width"))))),o||(o=this.getContainerWidthFromCache())}return o},getContainerWidthFromCache:function(){var t;return t=this.retrieveContainerWidth(),t||(t=this.appContext.viewportData.getWidth()-this.scrollbarWidth),this._relayoutQueued=!0,t},adjustRowHeightToContainerWidth:function(t){t=this.calculateContainerWidth(t);var e,i,o,a,r;if(t<s[0])i=this.baseRowHeight*n[s[0]];else if(t>s[s.length-1])i=this.baseRowHeight*n[s[s.length-1]];else for(r=0;r<s.length-1;r++)if(o=s[r],a=s[r+1],(e=(t-o)/(a-o))>=0&&e<=1){i=this.baseRowHeight*n[o]+e*this.baseRowHeight*(n[a]-n[o]);break}this.photoListLayout.targetRowHeight=i},storeContainerWidth:function(t){var e=this.parentName;e&&this.appContext.viewportData.setContainerWidth(e,t)},retrieveContainerWidth:function(){var t=this.parentName;return t?this.appContext.viewportData.getContainerWidth(t):0},getLayoutItemsOnScreen:function(t){if(YUI.Env.isServer)return[];var e,i,o=this.get("container"),n=this.getContainingElementData();return e=n.scrollTop-o.getXY()[1],i=e+n.height,t||(t=this.photoListLayout.getCurrentLayout())?t.filter(function(t){return t.geometry.top+t.geometry.height>e&&t.geometry.top<i}):[]},scrollToCenterItem:function(e){if(!this.photoListLayout.hasLimitedNumberOfRows()&&0!==this.getContainingElementData().scrollTop){var i,o=this.photoListLayout.getCurrentLayout(),n=this.get("container").getXY()[1],s=this;this.layoutItemAtScreenCenter||(i=this.getLayoutItemsOnScreen(o),this.layoutItemAtScreenCenter=i[Math.floor(.5*i.length)]),e.some(function(e){if(e.id===s.layoutItemAtScreenCenter.id)return s.parentContainer!==t.config.win&&s.parentContainer instanceof t.Node?s.parentContainer.getDOMNode().scrollTop=n+e.geometry.top+.5*(e.geometry.height-s.parentContainer.get("offsetHeight")):t.config.win.scrollTo(0,n+e.geometry.top+.5*(e.geometry.height-s.appContext.viewportData.getHeight())),!0}),this.deleteResizeCenterTimeoutId&&t.config.win.clearTimeout(this.deleteResizeCenterTimeoutId),this.deleteResizeCenterTimeoutId=t.config.win.setTimeout(function(){s.layoutItemAtScreenCenter&&(delete s.layoutItemAtScreenCenter,delete s.deleteResizeCenterTimeoutId)},1e3)}},storeScrollPosition:function(){var e=this.getLayoutItemsOnScreen();e.length&&t.StorageHelper.setItem(this.getPhotolistSignature(),e[0].id,!0)},restoreScrollPosition:function(){this.scrollToId(null,!0)},scrollToId:function(e,i){var o,n,s=this.get("container");e||(e=t.StorageHelper.getItem(this.getPhotolistSignature(),!0)),(o=this.photoListLayout.getLayoutItem(e))&&(!o.geometry||o.geometry.top-this.photoListLayout.containerPadding.top<=0||(n=s.get("offsetParent")?s.get("offsetParent").get("offsetTop")+s.get("offsetTop"):s.get("offsetTop"),t.one(".global-nav-view")&&!i&&(n-=t.one(".global-nav-view").get("offsetHeight")),t.one(".fluid-subnav")&&!i&&(n-=t.one(".fluid-subnav").get("offsetHeight")),i&&(n+=50),this.setContainerScrollTop(o.geometry.top+n)))},validateWakeSleep:function(t){var e,i,o,n,s=this.photoListLayout.getAwakeItems(),a=t.allLayoutItems.indexOf(s[0]),r=t.allLayoutItems.indexOf(s[s.length-1]),l=[];for(e=a;e<r;e++)i=t.allLayoutItems[e],(o=this.subviewsById[i.id])&&(n=!i.isAwake,n||(n=o.isAwake?!o.isAwake():0===o.get("container").get("children").size()),n&&i&&(i.isAwake=!0,l.push(i)));l.length&&this.wakeOrSleepSubviews(l)},getPhotolistSignature:function(){var e,i,o,n=0;if(!this.signature){if(YUI.Env.isServer){if(e=this.appContext.request.path,this.appContext.request.query)for(i in this.appContext.request.query)e+=i+this.appContext.request.query[i]}else e=t.config.win.location.pathname+decodeURIComponent(t.config.win.location.search);if(e=t.flutil.normalizeURIComponents(e),this.modelParams)if("string"!=typeof this.modelParams.modelIdOrAttributes)for(i in this.modelParams.modelIdOrAttributes)e+=i+""+this.modelParams.modelIdOrAttributes[i];else e+=this.modelParams.modelIdOrAttributes;for(this.parentName&&(e+=this.parentName),e=e.toLowerCase(),e=e.replace(/\W/g,""),o=0;o<e.length;o++)n+=e.charCodeAt(o);this.signature="photolist-"+n.toString(36)}return this.signature},injectPhotolistContext:function(e){var o,n,s,a,r,l,h,c,u=e.currentTarget.getAttribute("href"),d=t.URLHelper.PHOTOPAGE_PATTERN.exec(u),g="";if(d&&d.length>=5){if(o=this.get("collectionModel").getValue(this.modelParams.collectionAttributeName).getList().map(function(t){return t.id}).filter(function(t){return!!t}),a=d[4],-1===(r=o.indexOf(a)))return void i.warn("Clicked photo id not found in photolist. Aborting photolist injection and passing through to photopage.");n=o.slice(r,r+50),n.length<50&&(s=Math.max(0,r-(50-n.length)),n=o.slice(s,r).concat(n)),u.indexOf("#")>-1&&(c=u.split("#"),u=c[0],g="#"+c[1]),"/"===u.substr(-1)&&(u=u.substr(0,u.length-1)),l=u+"/in/photolist-"+t.URLHelper.generateShortenedPhotolist(n)+g,e.halt(),this.injectPhotolistContextParams&&this.injectPhotolistContextParams.rapidBeaconConfig&&(h={},h[this.injectPhotolistContextParams.rapidBeaconConfig.itemIndexKey]=r+1,t.rapidTracker.beacon(this.name,this.injectPhotolistContextParams.rapidBeaconConfig.beaconName,h)),e.metaKey||e.ctrlKey||e.which&&2===e.which?t.config.win.open(l,"_blank"):this.appContext.flapp.navigate(l)}},subviewExtraToolClicked:function(e){var i,o=e.target.getDOMNode(),n=o.dataset.id,s=this.modelsById[n];if(n&&s){if(o.classList.contains("more-menu")){var a=[],r=o.dataset.menuItems.split(",");r&&(r.indexOf("search-similar")>-1&&a.push({text:this.intlMessage({intlName:"common.SEARCH_FOR_SIMILAR_PHOTOS"}),callback:function(e,i){var o=s.getValue("similaritySearchURL");i.metaKey||i.ctrlKey||i.which&&2===i.which?t.config.win.open(o,"_blank"):this.appContext.flapp.navigate(o)}.bind(this)}),r.indexOf("search-similar-with-term")>-1&&"search-photos-lite-models"===this.modelParams.registryName&&this.modelParams.fetchParams&&this.modelParams.fetchParams.apiParams&&this.modelParams.fetchParams.apiParams.text&&a.push({text:this.intlMessage({intlName:"common.SEARCH_FOR_SIMILAR_PHOTOS_WITH_TERM"}),callback:function(e,i){var o=s.getValue("basicSimilaritySearchURL")+"&text="+this.modelParams.fetchParams.apiParams.text;i.metaKey||i.ctrlKey||i.which&&2===i.which?t.config.win.open(o,"_blank"):this.appContext.flapp.navigate(o)}.bind(this)}),r.indexOf("exclude-people")>-1&&a.push({text:this.intlMessage({intlName:"common.HIDE_PHOTOS_FROM_PERSON"}),callback:function(){this.fire("subviewViewEvent","bigScotch",s.getValue("ownerNsid"),n)}.bind(this)}),r.indexOf("ban-user")>-1&&(i=function(t){this.fire("subviewViewEvent","banUser"+(t?"AndRemove":""),s.getValue("owner").id)},a.push({text:this.intlMessage({intlName:"common.GROUP_BAN_USER"}),callback:i.bind(this,!1)}),a.push({text:this.intlMessage({intlName:"common.GROUP_BAN_USER_REMOVE_PHOTOS"}),callback:i.bind(this,!0)})),r.indexOf("remove-user")>-1&&(i=function(t){this.fire("subviewViewEvent","removeUser"+(t?"AndRemove":""),s.getValue("owner").id)},a.push({text:this.intlMessage({intlName:"common.GROUP_REMOVE_USER"}),callback:i.bind(this,!1)}),a.push({text:this.intlMessage({intlName:"common.GROUP_REMOVE_USER_REMOVE_PHOTOS"}),callback:i.bind(this,!0)}))),a.length&&this.openSubviewMenu(e.target,a,this.subviewsById[n])}else o.classList.contains("remove-photo")?(this.fire("subviewViewEvent","photoList:removePhoto",n),o.classList.contains("remove-fave")?this.appContext.getModelRegistry(this.engagementModelName).then(function(e){return e.remoteDelete({photoId:n,userId:this.modelParams.modelIdOrAttributes.id||this.modelParams.modelIdOrAttributes}).then(function(t){this.get("collectionModel").getValue(this.modelParams.collectionAttributeName).remove(s)}.bind(this),function(e){new t.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"common.OOPS"}),showActionButton:!0,showCancelButton:!1,textMessage:this.intlMessage({intlName:"common.PHOTO_REMOVE_ERROR"})}).show()}.bind(this))}.bind(this)):o.classList.contains("remove-group-pool")?this.get("collectionModel").removePhotoRemote(n).then(function(t){this.get("collectionModel").getValue(this.modelParams.collectionAttributeName).remove(s)}.bind(this),function(e){new t.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"common.OOPS"}),showActionButton:!0,showCancelButton:!1,textMessage:this.intlMessage({intlName:"common.PHOTO_REMOVE_ERROR"})}).show()}.bind(this)):o.classList.contains("remove-showcase-photo")?this.fire("subviewViewEvent","showcase:remove",s,n):o.classList.contains("remove-photosof-you")&&this.fire("subviewViewEvent","photosofyou:remove",s,n)):o.classList.contains("big-scotch")&&this.fire("subviewViewEvent","scotch:big",s.getValue("ownerNsid"),n);e.halt()}},openSubviewMenu:function(e,i,o){var n,s,a,r,l,h=new t.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:e,positionFixed:!1,preferBottom:!0,dismissOnOverlayClick:!0,closeOnScroll:!0,mirrorArrowAdjustment:-3,menuItems:i}),c=this;this.registerEventHandler(h.on("selected",function(t){t&&t.menuItem&&t.menuItem.callback&&t.menuItem.callback(t.menuItem.selected,t.origEvent)})),l=h.on("closeDroparound",function(t){c.detachRegisteredEvent(l),c.detachRegisteredEvent(n),c.detachRegisteredEvent(s),a&&clearTimeout(a),o.setHoverVisible&&o.setHoverVisible(!1)}),this.registerEventHandler(l),h.show(),n=h.get("container").on("mouseleave",function(t){if(h){var e=o.get("container");if(e){var i=e.getDOMNode().getBoundingClientRect();(t.clientX<i.left||t.clientX>i.right||t.clientY<i.top||t.clientY>i.bottom)&&h.close()}}}),this.registerEventHandler(n),s=t.one("document").on("mousemove",t.betterThrottle(function(t){a&&clearTimeout(a),a=setTimeout(function(){r(t)},200)})),this.registerEventHandler(s),r=function(t){if(h){var e=h.getDroparoundContainer(),i=o.get("container");if(i&&e){var n=i.getDOMNode().getBoundingClientRect(),s=e.getDOMNode().getBoundingClientRect();!(t.clientX<n.left||t.clientX>n.right||t.clientY<n.top||t.clientY>n.bottom)||t.clientX>s.left&&t.clientX<s.right&&t.clientY>s.top&&t.clientY<s.bottom||h.close()}}},o.setHoverVisible&&o.setHoverVisible(!0)},subviewLicenseMouseenter:function(e){var i,o=e.currentTarget&&e.currentTarget.getData("license-type")&&e.currentTarget.getData("license-type").toString();o&&(this.licenseTooltipHoverTimer&&clearTimeout(this.licenseTooltipHoverTimer),this.licenseTooltip&&this.licenseTooltip.close(),this.licenseTooltipHoverTimer=setTimeout(function(){this.licenseTooltip=new t.Views.FluidDroparound({appContext:this.appContext,anchorElement:e.target,showDropArrow:!0,positionFixed:!1,preferBottom:!0,invisibleOverlay:!0,autoSizeToContent:!0,width:300,classList:"license-tooltip",htmlMessage:this.templates("license-detail")({title:"common.LICENSE_TITLE_"+o,body:"common.LICENSE_DESC_"+o})}),this.licenseTooltip.show()}.bind(this),300),i=this.get("container").delegate("mouseleave",function(t){this.licenseTooltip&&this.licenseTooltip.close(),i.detach(),clearTimeout(this.licenseTooltipHoverTimer)}.bind(this),".license"),this.registerEventHandler(i))},reportAFTResults:function(){var t,e,i=this.appContext.hasClientSideRouted(),o=0;if(i)t=this.aftCache;else{if(!window.paftTiming)return;t=window.paftTiming[this.getAFTTimingKey()]}for(e in t)this.photoIsAboveTheFold(e)&&(o=Math.max(o,t[e]));this.fire("subviewViewEvent","atfVisible",o,this.getAFTTimingKey())},getAFTTimingKey:function(){return this.parentName||this.getPhotolistSignature()},photoIsAboveTheFold:function(t){if(YUI.Env.isServer)return!0;var e=this.subviewsById[t];return!!e&&e.get("container").getXY()[1]<this.getContainingElementData().height}},{ATTRS:{showThrobberDuringLoad:{value:!0,validator:function(e,i){return t.AttributeHelpers.validateBoolean(e)}},isThrobberShowing:{readOnly:!0,value:!1},throbberNode:{readOnly:!0,getter:function(e){return YUI.Env.isServer||void 0!==e||(e=t.Node.create('<div style="position: absolute; bottom: 40px; left: 0; right: 0;"><div class="flickr-dots"></div></div>'),this._set("throbberNode",e)),e}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-list-aft","hermes-template-infinite-scroll-load-more","hermes-template-license-detail","photo-list-layout","photo-list-photo-view","overflow-helper","storage-helper","attribute-helpers","url-helper","paged-collection","fluid-droparound-view"],optionalRequires:["global-events"],langBundles:["common"]});
YUI.add("hermes-template-fluid-modal",function(n,l){var a=n.Template.Handlebars.revive({1:function(n,l,a,e,t){return" html-modal"},3:function(n,l,a,e,t){return" subview-modal"},5:function(n,l,a,e,t){return'<div class="close-x" aria-label="'+n.escapeExpression((a.intlMessage||l&&l.intlMessage||a.helperMissing).call(null!=l?l:{},{name:"intlMessage",hash:{intlName:"common.CLOSE"},data:t}))+'" tabindex="0"></div>'},7:function(n,l,a,e,t){var r;return'\t\t<div class="head">\n'+(null!=(r=a.if.call(null!=l?l:{},null!=l?l.navBarView:l,{name:"if",hash:{},fn:n.program(8,t,0),inverse:n.program(10,t,0),data:t}))?r:"")+'\t\t\t<div class="extra"></div>\n\t\t</div>\n'},8:function(n,l,a,e,t){return'\t\t\t\t<div class="nav"></div>\n'},10:function(n,l,a,e,t){var r;return'\t\t\t\t<div class="title">\n'+(null!=(r=a.if.call(null!=l?l:{},null!=l?l.title:l,{name:"if",hash:{},fn:n.program(11,t,0),inverse:n.program(13,t,0),data:t}))?r:"")+"\t\t\t\t</div>\n"},11:function(n,l,a,e,t){var r;return"\t\t\t\t\t\t"+n.escapeExpression((r=null!=(r=a.title||(null!=l?l.title:l))?r:a.helperMissing,"function"==typeof r?r.call(null!=l?l:{},{name:"title",hash:{},data:t}):r))+"\n"},13:function(n,l,a,e,t){return"\t\t\t\t\t\t"+n.escapeExpression((a.renderTrustedMarkup||l&&l.renderTrustedMarkup||a.helperMissing).call(null!=l?l:{},null!=l?l.htmlTitle:l,{name:"renderTrustedMarkup",hash:{},data:t}))+"\n"},15:function(n,l,a,e,t){return" lines"},17:function(n,l,a,e,t){var r,s,i=null!=l?l:{};return'\t\t\t<div class="content text-only '+(null!=(r=a.if.call(i,null!=l?l.noScroll:l,{name:"if",hash:{},fn:n.program(18,t,0),inverse:n.noop,data:t}))?r:"")+(null!=(r=a.if.call(i,null!=l?l.showFooter:l,{name:"if",hash:{},fn:n.program(20,t,0),inverse:n.noop,data:t}))?r:"")+'">\n\t\t\t\t'+n.escapeExpression((s=null!=(s=a.textMessage||(null!=l?l.textMessage:l))?s:a.helperMissing,"function"==typeof s?s.call(i,{name:"textMessage",hash:{},data:t}):s))+"\n\t\t\t</div>\n"},18:function(n,l,a,e,t){return" no-scroll"},20:function(n,l,a,e,t){return" has-footer"},22:function(n,l,a,e,t){var r,s=null!=l?l:{};return'\t\t\t<div class="content html-only '+(null!=(r=a.if.call(s,null!=l?l.noScroll:l,{name:"if",hash:{},fn:n.program(18,t,0),inverse:n.noop,data:t}))?r:"")+(null!=(r=a.if.call(s,null!=l?l.showFooter:l,{name:"if",hash:{},fn:n.program(20,t,0),inverse:n.noop,data:t}))?r:"")+'">\n\t\t\t\t'+n.escapeExpression((a.renderTrustedMarkup||l&&l.renderTrustedMarkup||a.helperMissing).call(s,null!=l?l.htmlMessage:l,{name:"renderTrustedMarkup",hash:{},data:t}))+"\n\t\t\t</div>\n"},24:function(n,l,a,e,t){var r,s=null!=l?l:{};return'\t\t\t<div class="content subview '+(null!=(r=a.if.call(s,null!=l?l.noScroll:l,{name:"if",hash:{},fn:n.program(18,t,0),inverse:n.noop,data:t}))?r:"")+(null!=(r=a.if.call(s,null!=l?l.showFooter:l,{name:"if",hash:{},fn:n.program(20,t,0),inverse:n.noop,data:t}))?r:"")+'"></div>\n'},26:function(n,l,a,e,t){var r;return'\t\t<div class="foot">\n'+(null!=(r=a.if.call(null!=l?l:{},null!=(r=null!=l?l.buttons:l)?r.visible:r,{name:"if",hash:{},fn:n.program(27,t,0),inverse:n.noop,data:t}))?r:"")+"\t\t</div>\n"},27:function(n,l,a,e,t){var r,s=null!=l?l:{};return'\t\t\t<div class="buttons">\n\t\t\t\t'+(null!=(r=a.if.call(s,null!=(r=null!=(r=null!=l?l.buttons:l)?r.action:r)?r.visible:r,{name:"if",hash:{},fn:n.program(28,t,0),inverse:n.noop,data:t}))?r:"")+"\n\t\t\t\t"+(null!=(r=a.if.call(s,null!=(r=null!=(r=null!=l?l.buttons:l)?r.cancel:r)?r.visible:r,{name:"if",hash:{},fn:n.program(33,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=a.if.call(s,null!=(r=null!=l?l.buttons:l)?r.flavorText:r,{name:"if",hash:{},fn:n.program(35,t,0),inverse:n.noop,data:t}))?r:"")+"\t\t\t</div>\n"},28:function(n,l,a,e,t){var r,s=null!=l?l:{};return'<button class="mini '+(null!=(r=a.if.call(s,null!=(r=null!=(r=null!=l?l.buttons:l)?r.action:r)?r.isDangerous:r,{name:"if",hash:{},fn:n.program(29,t,0),inverse:n.noop,data:t}))?r:"")+' action"'+(null!=(r=a.if.call(s,null!=(r=null!=(r=null!=l?l.buttons:l)?r.action:r)?r.disabled:r,{name:"if",hash:{},fn:n.program(31,t,0),inverse:n.noop,data:t}))?r:"")+">"+n.escapeExpression(n.lambda(null!=(r=null!=(r=null!=l?l.buttons:l)?r.action:r)?r.label:r,l))+"</button>"},29:function(n,l,a,e,t){return"danger"},31:function(n,l,a,e,t){return' disabled="disabled"'},33:function(n,l,a,e,t){var r;return'<button class="mini alt cancel">'+n.escapeExpression(n.lambda(null!=(r=null!=(r=null!=l?l.buttons:l)?r.cancel:r)?r.label:r,l))+"</button>"},35:function(n,l,a,e,t){var r,s=null!=l?l:{};return'\t\t\t\t<div class="flavor-text secondary'+(null!=(r=a.unless.call(s,null!=(r=null!=(r=null!=l?l.buttons:l)?r.flavorText:r)?r.visible:r,{name:"unless",hash:{},fn:n.program(36,t,0),inverse:n.noop,data:t}))?r:"")+'">'+n.escapeExpression((a.renderTrustedMarkup||l&&l.renderTrustedMarkup||a.helperMissing).call(s,null!=(r=null!=(r=null!=l?l.buttons:l)?r.flavorText:r)?r.text:r,{name:"renderTrustedMarkup",hash:{},data:t}))+"</div>\n"},36:function(n,l,a,e,t){return" hidden"},compiler:[7,">= 4.0.0"],main:function(n,l,a,e,t){var r,s,i=null!=l?l:{};return'<div class="modal'+(null!=(r=a.if.call(i,null!=l?l.htmlMessage:l,{name:"if",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t}))?r:"")+(null!=(r=a.if.call(i,null!=l?l.subview:l,{name:"if",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t}))?r:"")+" "+n.escapeExpression((s=null!=(s=a.classList||(null!=l?l.classList:l))?s:a.helperMissing,"function"==typeof s?s.call(i,{name:"classList",hash:{},data:t}):s))+'">\n\t'+(null!=(r=a.if.call(i,null!=l?l.showCancelX:l,{name:"if",hash:{},fn:n.program(5,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=a.if.call(i,null!=l?l.showHeader:l,{name:"if",hash:{},fn:n.program(7,t,0),inverse:n.noop,data:t}))?r:"")+'\t<div class="body'+(null!=(r=a.if.call(i,null!=l?l.showBodyLines:l,{name:"if",hash:{},fn:n.program(15,t,0),inverse:n.noop,data:t}))?r:"")+'">\n'+(null!=(r=a.if.call(i,null!=l?l.textMessage:l,{name:"if",hash:{},fn:n.program(17,t,0),inverse:n.noop,data:t}))?r:"")+(null!=(r=a.if.call(i,null!=l?l.htmlMessage:l,{name:"if",hash:{},fn:n.program(22,t,0),inverse:n.noop,data:t}))?r:"")+(null!=(r=a.if.call(i,null!=l?l.subview:l,{name:"if",hash:{},fn:n.program(24,t,0),inverse:n.noop,data:t}))?r:"")+"\t</div>\n"+(null!=(r=a.if.call(i,null!=l?l.showFooter:l,{name:"if",hash:{},fn:n.program(26,t,0),inverse:n.noop,data:t}))?r:"")+"</div>\n"},useData:!0}),e={};n.Array.each([],function(l){var a=n.Template.get("hermes/"+l);a&&(e[l]=a)}),n.Template.register("hermes/fluid-modal",function(l,t){return t=t||{},t.partials=t.partials?n.merge(e,t.partials):e,a(l,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("fluid-modal-view",function(e,t){"use strict";var i,n,a=require("lib/flog")(t);i={css:{destinationContainer:"body",closeX:".close-x",buttonCancel:"button.cancel",buttonAction:"button.action",navBarContent:".head .nav",subviewContent:".content.subview",modalContent:".body .content"},options:{}},n={supportsTransform:!1,modal:{height:0,width:0}},e.namespace("Views").FluidModal=e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.set("isActiveViewAgnostic",!0);var i=this.get("modalOverlayType");return this.alreadyShowingModal=i.alreadyShowingModal(),this.alreadyShowingModal||(i.add(this),e.OverlayManager.ModalOverlay.setOverlayStyle({overlayClassList:this.get("overlayClassList")})),this},activate:function(){var t=this.get("container"),n=this;return this.get("showCancelX")&&this.registerEventHandler(t.one(i.css.closeX).on(["click","keydown"],function(e){"click"!==e.type&&13!==e.keyCode||this.handleCancel(e)},this)),this.get("showFooter")&&this.get("showCancelButton")&&this.get("showButtons")&&this.registerEventHandler(t.one(i.css.buttonCancel).on("click",e.bind(this.handleCancel,this))),this.get("showFooter")&&this.get("showActionButton")&&this.get("showButtons")&&this.registerEventHandler(t.one(i.css.buttonAction).on("click",e.bind(this.handleAction,this))),this.registerEventHandler(this.appContext.flapp.on("activeViewChange",function(e){n.close(e)})),this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(e){n.reposition()})),this.get("navBarView")&&n.get("navBarView").activate(),this.get("subview")&&(n.get("subview").activate(),n.registerEventHandler(n.get("subview").on("actionClick",e.bind(n.handleAction,n)))),this.registerEventHandler(t.delegate("keydown",this.keyboardSelectRadio.bind(this),"label")),this.registerEventHandler(t.ancestor("body").once("key",this.focusOnFirstTab.bind(this),"down:9")),e.Accessibility.manageFocusOutlines(this),this.fire("activated"),this},focusOnFirstTab:function(e){this.get("container").one("[tabindex]").focus()},keyboardSelectRadio:function(e){if(13===e.keyCode){var t=this.get("container").one("#"+e.target.getAttribute("for"));t.set("checked",!t.get("checked"))}},clearOutline:function(){var t=e.one(document.activeElement);t&&t.addClass("no-outline")},restoreOutline:function(){var e=this.get("container").one(":focus");e&&e.removeClass("no-outline")},show:function(){return this.initialize().then(null,function(e){a.error("Error initializing modal",{err:e})}),this.isClosed=!1,this.freeze(),e.fire("flickr:setKeyEventScope",this.getKeyEventScope()),this},freeze:function(){e.one("body").setStyles({overflow:"hidden"})},unfreeze:function(){e.one("body").setStyles({overflow:"visible"})},enableActionButton:function(){var e=this.get("container").one("button.action");e&&e.getAttribute("disabled")&&e.removeAttribute("disabled")},disableActionButton:function(){var e=this.get("container").one("button.action");e&&e.setAttribute("disabled",!0)},showFlavorText:function(){var e=this.get("container").one(".buttons .flavor-text");e&&e.removeClass("hidden")},hideFlavorText:function(){var e=this.get("container").one(".buttons .flavor-text");e&&e.addClass("hidden")},buildContainer:function(){if(!this.alreadyShowingModal){var t,o=this,s=e.one(i.css.destinationContainer);t={showCancelX:this.get("showCancelX"),title:this.get("title"),htmlTitle:this.get("htmlTitle"),navBarView:!!this.get("navBarView"),noScroll:this.get("noScroll"),textMessage:this.get("textMessage"),htmlMessage:this.get("message")?this.get("message"):this.get("htmlMessage"),subview:!!this.get("subview"),showBodyLines:this.get("showBodyLines"),hideModalOverlay:this.get("hideModalOverlay"),darkOverlay:this.get("darkOverlay"),lightOverlay:this.get("lightOverlay"),showHeader:this.get("showHeader"),showFooter:this.get("showFooter"),buttons:{visible:this.get("showButtons"),action:{visible:this.get("showActionButton"),label:this.get("actionButtonLabel"),disabled:this.get("actionButtonDisabled"),isDangerous:this.get("actionButtonIsDangerous")},cancel:{visible:this.get("showCancelButton"),label:this.get("cancelButtonLabel")}},classList:this.get("classList")},this.get("buttonFlavorText")&&(t.buttons.flavorText={visible:this.get("showButtonFlavorText"),text:this.get("buttonFlavorText")}),this.setContainerWithTemplate("fluid-modal",t),n.modal.width=this.get("width"),n.modal.minWidth=this.get("minWidth"),n.modal.height=this.get("height"),this.get("navBarView")&&(this.get("navBarView").appContext=o.appContext,this.get("navBarView").initialize().then(function(e){e.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&(o.get("subview")&&"navigation"===e.details[0]?o.get("subview").fire.apply(o.get("subview"),["parentViewEvent"].concat(e.details)):o.get("subview")&&"search"===e.details[0]&&o.get("subview").fire.apply(o.get("subview"),["parentViewEvent"].concat(e.details)),o.fire.apply(o,e.details))}),o.get("container").one(i.css.navBarContent).appendChild(e.get("container")),o.get("subview")||o.activate()})),this.get("subview")?(this.get("subview").appContext=o.appContext,this.get("subview").set("isActiveViewAgnostic",!0),this.get("subview").initialize().then(function(e){o.on("parentViewEvent",function(t){t&&t.details&&t.details.length&&e.fire.apply(e,["parentViewEvent"].concat(t.details))}),e.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&(o.get("navBarView")&&"backToList"===e.details[0]&&o.get("navBarView").fire.apply(o.get("navBarView"),["parentViewEvent"].concat(e.details)),o.fire.apply(o,e.details))}),o.get("container").one(i.css.subviewContent).appendChild(e.get("container")),s&&(s.append(o.get("container")),o.reposition()),o.activate()},function(e){a.error("Error initializing modal subview",{err:e})})):s&&(s.append(this.get("container")),this.reposition())}return this},reposition:function(){var t,a,o,s=this.get("container"),l=s.one(this.get("modalSelector")),r=e.one(e.config.win),h=parseInt(r.get("innerWidth"),10),d=parseInt(r.get("innerHeight"),10),c=n.modal.width?parseInt(n.modal.width,10):parseInt(l.getComputedStyle("width"),10),u={},g=l.one(".body"),v=0,w=this.get("showFooter")?parseInt(l.one(".foot").getComputedStyle("height"),10):0,m=0,b=parseInt(g.getComputedStyle("borderTopWidth"),10)+parseInt(g.getComputedStyle("borderBottomWidth"),10),p={};n.modal.height&&(v=parseInt(l.one(".head").getComputedStyle("height"),10),m=n.modal.height,l.get("showFooter")&&(w=parseInt(l.one(".foot").getComputedStyle("height"),10)),n.modal.height+v+w+80+b>=d&&(m=d<=700?d-v-w-b:d-v-w-80-b),l.setStyles({maxHeight:"none"}),this.get("fullWindow")?p.height=m+"px":this.get("maxHeight")&&(p.maxHeight=m+"px"),l.one(i.css.modalContent).setStyles(p)),t=parseInt(l.getComputedStyle("height"),10),a=l.getDOMNode().scrollHeight,o=l.getDOMNode().scrollWidth,u={top:"50%",left:"50%",width:n.modal.width?c+"px":"",marginTop:-t/2+"px",marginLeft:-c/2+"px",minWidth:n.modal.minWidth?n.modal.minWidth+"px":""},t+40>d||a>t+1||c+40>h||o>c?(d<=700&&n.modal.height?u.maxHeight=d-10+"px":(u.maxHeight=d-40+"px",u.overflow="auto"),u.maxWidth=h-40+"px",u.marginTop=-Math.min(parseInt(u.maxHeight,10),t)/2+"px",u.marginLeft=-Math.min(parseInt(u.maxWidth,10),c)/2+"px"):(u.maxHeight="inherit",u.maxWidth="inherit",u.overflow="visible"),l.setStyles(u)},handleCancel:function(i){var n=this.get("subview");e.rapidTracker.beacon(t,"modalCancelClick"),n&&n.handleCancel&&n.handleCancel(),this.fire("cancelClick",i),this.close(i)},handleAction:function(e){var t=this.get("subview");this.fire("actionClick",e),t&&t.handleAction&&t.handleAction(),this.get("dismissOnActionClick")&&this.close(e)},close:function(t){e.fire("flickr:removeKeyEventScope",this.getKeyEventScope());var i=this.get("container");this.isClosed=!0,e.one("body").removeClass("scroll-fluid-modal"),this.get("subview")&&this.get("subview").destroy(),this.get("navBarView")&&this.get("navBarView").destroy(),i&&i.remove(!0),this.fire("close",t),this.destroy(),this.get("removeOverlayOnClose")||this.get("modalOverlayType").remove(this)},getKeyEventScope:function(){return this.name+this._yuid},destructor:function(){this.unfreeze(),this.detachAll()}},{ATTRS:{showCancelX:{value:!0},showCancelButton:{value:!0},showBodyLines:{value:!1},showActionButton:{value:!0},hideModalOverlay:{value:!1},darkOverlay:{value:!1},lightOverlay:{value:!1},actionButtonLabel:{valueFn:function(){return this.intlMessage({intlName:"common.OK"})}},actionButtonIsDangerous:{value:!1},cancelButtonLabel:{valueFn:function(){return this.intlMessage({intlName:"common.CANCEL"})}},actionButtonDisabled:{value:!1},showButtons:{value:!0},dismissOnOverlayClick:{value:!1},dismissOnActionClick:{value:!0},title:{value:""},htmlTitle:{value:""},navBarView:{value:null},message:{value:null},textMessage:{value:null},htmlMessage:{value:null},width:{value:0},minWidth:{value:0},height:{value:0},fullWindow:{value:!1},subview:{value:null},classList:{value:""},buttonFlavorText:{value:""},showButtonFlavorText:{value:!0},showHeader:{value:!0},showFooter:{value:!0},noScroll:{value:!1},maxHeight:{value:!0},modalSelector:{value:".modal"},modalOverlayType:{value:e.OverlayManager.ModalOverlay},removeOverlayOnClose:{value:!1},overlayClassList:{value:"",validator:function(t,i){return e.AttributeHelpers.validateString(t)},setter:function(t,i){return e.AttributeHelpers.coerceString(t)}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-fluid-modal","fluid-overlay-manager-view","attribute-helpers"],optionalRequires:["fluid"],langBundles:["common"]});
YUI.add("hermes-template-explore-big-scotch-modal",function(e,a){var s=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,s,l,n){var t,r=null!=a?a:{},o=s.helperMissing,d=e.escapeExpression;return"<p>"+d((s.godMessage||a&&a.godMessage||o).call(r,{name:"godMessage",hash:{intlName:"explore.BIG_SCOTCH_REASON_MESSAGE"},data:n}))+'</p>\n<div class="dropdown-link exclude-reason-menu"><p class="tertiary">'+d((t=null!=(t=s.selectedExcludeReason||(null!=a?a.selectedExcludeReason:a))?t:o,"function"==typeof t?t.call(r,{name:"selectedExcludeReason",hash:{},data:n}):t))+'</p><span class="dropdown-arrow"></span></div>\n<input type="text" id="comment-field" name="comment" placeholder="'+d((s.godMessage||a&&a.godMessage||o).call(r,{name:"godMessage",hash:{intlName:"explore.COMMENT"},data:n}))+'" />\n'},useData:!0}),l={};e.Array.each([],function(a){var s=e.Template.get("hermes/"+a);s&&(l[a]=s)}),e.Template.register("hermes/explore-big-scotch-modal",function(a,n){return n=n||{},n.partials=n.partials?e.merge(l,n.partials):l,s(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("explore-big-scotch-modal-view",function(e){var t=[];e.config.flickr&&e.config.flickr.god&&e.config.flickr.god.explore&&e.config.flickr.god.explore.scotch&&e.config.flickr.god.explore.scotch.types&&(t=e.config.flickr.god.explore.scotch.types),e.namespace("Views")[this.name]=e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(i){var o,n;for(this.excludeReasons=[],n=0;n<t.length;n++)o=t[n],this.excludeReasons.push(e.merge(o,{text:this.godMessage({intlName:o.intlName})}));return this.set("selectedBigScotchTypeText",this.godMessage({intlName:"explore.PICK_A_REASON"})),this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("explore-big-scotch-modal",{selectedExcludeReason:this.get("selectedBigScotchTypeText")}),this},activate:function(){return this.registerEventHandler(this.get("container").one(".exclude-reason-menu").on("click",this.handleExcludeReasonMenuClick.bind(this))),this.registerEventHandler(this.get("container").one("#comment-field").on("valuechange",this.handleCommentValueChange.bind(this))),this},handleExcludeReasonMenuClick:function(t){var i=this;t.halt(),this.dropdown=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,anchorOffsetHorizontal:14,observePageResize:!0,anchorElement:t.target.one(".dropdown-arrow"),positionFixed:!0,preferBottom:!0,classList:"over-modal",overlayClassList:"over-modal",menuItems:this.excludeReasons}),this.dropdown.show(),this.registerEventHandler(this.dropdown.on("selected",function(t){t&&t.menuItem&&t.menuItem.value!==i.get("selectedBigScotchTypeValue")&&(i.set("selectedBigScotchTypeValue",t.menuItem.value),i.set("selectedBigScotchTypeText",t.menuItem.text),i.set("needComment",!!t.menuItem.requiresComment),i.get("container").one(".exclude-reason-menu p").set("text",i.get("selectedBigScotchTypeText")),!t.menuItem.requiresComment||i.get("excludeComment")?e.fire("exploreBigScotch:justificationComplete"):e.fire("exploreBigScotch:justificationIncomplete")),i.dropdown.close()}))},handleCommentValueChange:function(t){var i=this.get("container").one("#comment-field").get("value");this.set("excludeComment",i),this.get("needComment")&&!i?e.fire("exploreBigScotch:justificationIncomplete"):i&&this.get("selectedBigScotchTypeValue")&&e.fire("exploreBigScotch:justificationComplete")}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-droparound-view","hermes-template-explore-big-scotch-modal"],langBundles:[]});
YUI.add("hermes-template-fluid-subnav",function(n,a){var e=n.Template.Handlebars.revive({1:function(n,a,e,l,s){return" top-banner"},3:function(n,a,e,l,s){var t;return null!=(t=e.unless.call(null!=a?a:{},null!=a?a.disabled:a,{name:"unless",hash:{},fn:n.program(4,s,0),inverse:n.noop,data:s}))?t:""},4:function(n,a,e,l,s){var t,i,r=null!=a?a:{},u=e.helperMissing,o=n.escapeExpression;return'\t\t\t<li id="'+o((i=null!=(i=e.id||(null!=a?a.id:a))?i:u,"function"==typeof i?i.call(r,{name:"id",hash:{},data:s}):i))+'" class="link '+(null!=(t=e.if.call(r,null!=a?a.selected:a,{name:"if",hash:{},fn:n.program(5,s,0),inverse:n.noop,data:s}))?t:"")+'" role="menuitem">\n\t\t\t\t<a href="'+o((i=null!=(i=e.href||(null!=a?a.href:a))?i:u,"function"==typeof i?i.call(r,{name:"href",hash:{},data:s}):i))+'">'+o((i=null!=(i=e.name||(null!=a?a.name:a))?i:u,"function"==typeof i?i.call(r,{name:"name",hash:{},data:s}):i))+"</a>\n\t\t\t\t"+(null!=(t=e.if.call(r,null!=a?a.label:a,{name:"if",hash:{},fn:n.program(7,s,0),inverse:n.noop,data:s}))?t:"")+"\n\t\t\t</li>\n"},5:function(n,a,e,l,s){return"selected"},7:function(n,a,e,l,s){var t;return'<span class="label-beta">'+n.escapeExpression((t=null!=(t=e.label||(null!=a?a.label:a))?t:e.helperMissing,"function"==typeof t?t.call(null!=a?a:{},{name:"label",hash:{},data:s}):t))+"</span>"},9:function(n,a,e,l,s){return'\t\t\t<li class="link more-link">\n\t\t\t\t'+n.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"filter-bar.MORE"},data:s}))+"\n\t\t\t\t<span></span>\n\t\t\t</li>\n"},11:function(n,a,e,l,s){return'\t\t<div class="more-link">\n\t\t\t'+n.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"filter-bar.MORE"},data:s}))+'\n\t\t\t<a class="dropdown-arrow" role="menuitem" tabindex="0" aria-haspopup="true" aria-expanded="false"><span></span></a>\n\t\t</div>\n'},compiler:[7,">= 4.0.0"],main:function(n,a,e,l,s){var t,i=null!=a?a:{};return'<div class="fluid-subnav-shim">\n<div class="fluid-subnav'+(null!=(t=e.if.call(i,null!=a?a.showPartnerAccountBanner:a,{name:"if",hash:{},fn:n.program(1,s,0),inverse:n.noop,data:s}))?t:"")+'" role="navigation" aria-label="'+n.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(i,{name:"intlMessage",hash:{intlName:"common.SECONDARY"},data:s}))+'">\n\t<div class="subnav-content fluid-centered">\n\t\t<ul class="links" role="menubar">\n'+(null!=(t=e.each.call(i,null!=a?a.links:a,{name:"each",hash:{},fn:n.program(3,s,0),inverse:n.noop,data:s}))?t:"")+"\n"+(null!=(t=e.unless.call(i,null!=a?a.hideMoreLinks:a,{name:"unless",hash:{},fn:n.program(9,s,0),inverse:n.noop,data:s}))?t:"")+"\t\t</ul>\n\n"+(null!=(t=e.unless.call(i,null!=a?a.hideMoreLinks:a,{name:"unless",hash:{},fn:n.program(11,s,0),inverse:n.noop,data:s}))?t:"")+'\n\t\t<div class="fader"><span></span></div>\n\t</div>\n</div>\n</div>\n'},useData:!0}),l={};n.Array.each([],function(a){var e=n.Template.get("hermes/"+a);e&&(l[a]=e)}),n.Template.register("hermes/fluid-subnav",function(a,s){return s=s||{},s.partials=s.partials?n.merge(l,s.partials):l,e(a,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("animation-manager",function(n){n.AnimationManager=(function(){function i(){var i,e,a=["webkit","moz"],t=0;for(e=0;e<a.length&&!n.config.win.requestAnimationFrame;++e)i=a[e],n.config.win.requestAnimationFrame=n.config.win[i+"RequestAnimationFrame"],n.config.win.cancelAnimationFrame=n.config.win[i+"CancelAnimationFrame"]||n.config.win[i+"CancelRequestAnimationFrame"];n.config.win.requestAnimationFrame&&n.config.win.cancelAnimationFrame||(n.config.win.requestAnimationFrame=function(n){var i=Date.now(),e=Math.max(t+16,i);return setTimeout(function(){n(t=e)},e-i)},n.config.win.cancelAnimationFrame=clearTimeout)}function e(){o&&(r.forEach(function(n,i){n()}),n.config.win.requestAnimationFrame(e))}function a(i){return r.push(i),o||(o=!0,n.config.win.requestAnimationFrame(e)),{detach:function(){r.splice(r.indexOf(i),1),r.length||(o=!1)}}}var t,o,r;return t||(t=(function(){return o=!1,r=[],YUI.Env.isServer||n.config.win.requestAnimationFrame||i(),{subscribe:a}})()),t})()},"@VERSION@",{requires:[]});
