YUI.add("flickr-photos-getHtmlMeta-fetcher",function(t,o){"use strict";function e(t,o){var e,r=t[0],i=t[1];r&&r.HTMLMETA&&(e={id:r.photoId,title:r.HTMLMETA["og:title"],keywords:r.HTMLMETA.keywords,noindexfollow:r.HTMLMETA.noindexfollow,"og:title":r.HTMLMETA["og:title"],"og:description":r.HTMLMETA["og:description"],"og:type":r.HTMLMETA["og:type"],"og:url":r.HTMLMETA["og:url"],"og:image":r.HTMLMETA["og:image"],"og:image:width":r.HTMLMETA["og:image:width"],"og:image:height":r.HTMLMETA["og:image:height"],"flickr_photos:by":r.HTMLMETA["flickr_photos:by"],"flickr_photos:camera":r.HTMLMETA["flickr_photos:camera"],"flickr_photos:sets":r.HTMLMETA["flickr_photos:sets"],"flickr_photos:groups":r.HTMLMETA["flickr_photos:groups"],"flickr_photos:galleries":r.HTMLMETA["flickr_photos:galleries"],"twitter:card":r.HTMLMETA["twitter:card"],"twitter:description":r.HTMLMETA["twitter:description"],"twitter:app:url:iphone":r.HTMLMETA["twitter:app:url:iphone"],"twitter:creator":r.HTMLMETA["twitter:creator"]},i.addOrUpdate(e))}function r(e,r){var i=e.id,s={photo_id:i},M=this;return t.Promise.all([r.callAPI("flickr.photos.getHtmlMeta",s),r.getModelRegistry("photo-head-meta-models")]).then(function(t){return M._processResponse(t,e)},t.FetcherErrorLogger(o))}t.namespace("ModelFetchers")["flickr-photos-getHtmlMeta"]={run:r,_processResponse:e}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-head-meta-models"]});
YUI.add("photo-head-meta-models",function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{read:function(e){return t.ModelFetchers["flickr-photos-getHtmlMeta"].run(e,this.appContext)}},getFieldsForDisplay:function(t){var e={},r=this;return["title","noindexfollow","keywords","og:title","og:description","og:type","og:url","og:image","og:image:width","og:image:height","flickr_photos:by","flickr_photos:camera","flickr_photos:sets","flickr_photos:groups","flickr_photos:galleries","twitter:card","twitter:description","twitter:app:url:iphone","twitter:creator","pinterest"].forEach(function(o){var i=r.getValue(t,o);void 0!==i&&(e[o]=i)}),e},attributes:{"og:title":{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},noindexfollow:{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},keywords:{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},title:{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},"og:description":{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},"og:type":{},"og:url":{},"og:image":{},"og:image:width":{},"og:image:height":{},"flickr_photos:by":{},"flickr_photos:camera":{},"flickr_photos:sets":{},"flickr_photos:groups":{},"flickr_photos:galleries":{},"twitter:card":{},"twitter:description":{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},"twitter:app:url:iphone":{},"twitter:creator":{},pinterest:{setter:function(t){return t}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getHtmlMeta-fetcher","flickr-photos-getInfo-fetcher","attribute-helpers"]});
YUI.add("photo-notes-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)}},attributes:{notes:{isCollection:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-getInfo-fetcher"]});
YUI.add("flickr-photos-addNotes-creator",function(t,o){"use strict";function e(t){return{photo_id:t.photoId,note_x:t.left,note_y:t.top,note_w:t.width,note_h:t.height,note_text:t.text}}function r(t,o){var e,r=t[0],s=t[1],a=t[2];return a.addOrUpdate({id:r.note.id,left:o.left,top:o.top,width:o.width,height:o.height,text:o.text,author:o.author,authorName:o.authorName,authorRealName:o.authorRealName,authorIsPro:o.authorIsPro}),e=a.proxy(r.note.id),s.exists(o.photoId)?s.getValue(o.photoId,"notes").appendToList(e):s.add({id:o.photoId,notes:[e]}),e}function s(e,r){var s=this;return t.Promise.all([r.callAPI("flickr.photos.notes.add",this._processParams(e)),r.getModelRegistry("photo-notes-models"),r.getModelRegistry("note-models")]).then(function(t){return s._processResponse(t,e)},t.FetcherErrorLogger(o))}t.namespace("ModelCreators")["flickr-photos-addNotes"]={run:s,_processParams:e,_processResponse:r}},"@VERSION@",{requires:["flickr-promise"],optional:["photo-notes-models","note-models"]});
YUI.add("flickr-photos-editNote-updater",function(e,t){"use strict";function o(e){return{note_id:e.noteId,note_x:e.noteX,note_y:e.noteY,note_w:e.noteW,note_h:e.noteH,note_text:e.noteText}}function n(e,t){var o,n=e[0],s=e[1],r=e[2];return o=r.proxy(n.note.id),o.setValues({left:n.note.x,top:n.note.y,width:n.note.w,height:n.note.h,text:n.note.content}),s.getValue(n.note.photoId,"notes").getFromListByID(n.note.id).setValues({left:n.note.x,top:n.note.y,width:n.note.w,height:n.note.h,text:n.note.content}),o}function s(o,n){var s=this;return e.Promise.all([n.callAPI("flickr.photos.notes.edit",this._processParams(o)),n.getModelRegistry("photo-notes-models"),n.getModelRegistry("note-models")]).then(function(e){return s._processResponse(e,o)},e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-photos-editNote"]={run:s,_processParams:o,_processResponse:n}},"@VERSION@",{requires:["flickr-promise"],optional:["photo-notes-models","note-models"]});
YUI.add("flickr-photos-deleteNote-deletor",function(e,o){"use strict";function t(t,r){var l={note_id:t};return r.callAPI("flickr.photos.notes.delete",l).then(null,e.FetcherErrorLogger(o))}e.namespace("ModelDeletors")["flickr-photos-deleteNote"]={run:t}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("note-models",function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{create:function(e){return t.ModelCreators["flickr-photos-addNotes"].run(e,this.appContext)},update:function(e,r){var n;return n={noteId:e,noteX:this.getValue(e,"left"),noteY:this.getValue(e,"top"),noteW:this.getValue(e,"width"),noteH:this.getValue(e,"height"),noteText:this.getValue(e,"text")},t.ModelUpdaters["flickr-photos-editNote"].run(n,this.appContext)},delete:function(e){return t.ModelDeletors["flickr-photos-deleteNote"].run(e,this.appContext)}},attributes:{author:{setter:function(t){return t}},authorName:{setter:function(t){return t}},authorRealName:{setter:function(t){return t}},authorIsPro:{defaultValue:!1,setter:function(e){return t.AttributeHelpers.coerceBoolean(e)}},left:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)}},top:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)}},width:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)}},height:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)}},text:{setter:function(t){return t}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-addNotes-creator","flickr-photos-editNote-updater","flickr-photos-deleteNote-deletor","attribute-helpers"]});
YUI.add("flickr-photos-deleteAutotags-deletor",function(e,t){"use strict";function o(o,r){return r.callAPI("flickr.photos.deleteAutotags",o).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelDeletors")["flickr-photos-deleteAutotags"]={run:o}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("autotag-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{delete:function(t){return e.ModelDeletors["flickr-photos-deleteAutotags"].run(t,this.appContext)}},attributes:{autotagValue:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},score:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},isPrivate:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},searchUrl:{derivedBy:["autotagValue"],readOnly:!0,defaultFn:function(e){return"/search/?q="+this.getValue(e,"autotagValue")}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-deleteAutotags-deletor"]});
YUI.add("photo-autotags-models",function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{delete:function(e){return t.ModelDeletors["flickr-photos-deleteAutotags"].run(e,this.appContext)}},attributes:{autotags:{isCollection:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-deleteAutotags-deletor"]});
YUI.add("flickr-photos-setPerms-updater",function(e,r){"use strict";function s(e,r){var s,o=e[0],t=e[1];if(s=t.attributeSearch({normalizedId:r.nsid},!0),s.forEach(function(e){t.remove(e)}),r.full_response)return o.photoIdsSent=r.photo_ids,o}function o(s,o){var t=this;return s.nsid=o.getViewer().nsid,e.Promise.all([o.callAPI("flickr.photos.setPerms",s),o.getModelRegistry("photostream-models")]).then(function(e){return t._processResponse(e,s)},e.FetcherErrorLogger(r))}e.namespace("ModelUpdaters")["flickr-photos-setPerms"]={run:o,_processResponse:s}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-photos-setMeta-updater",function(t,o){"use strict";function e(e,i){var s={};return e.fullResponse?(s.full_response=1,s.photo_ids=e.photoId):s.photo_id=e.photoId,void 0!==e.title&&(s.title=e.title),void 0!==e.description&&(s.description=e.description),t.Promise.all([i.callAPI("flickr.photos.setMeta",s),i.getModelRegistry("photo-models")]).then(function(t){var o=t[0],i=t[1];if(e.fullResponse){if("errors"in o)return o.api="setMeta",o}else{if(!i.exists(e.photoId))throw new Error("[flickr-photos-setMeta-updater] - Photo model can not be updated if it does not exist");o.photo&&o.photo.title&&o.photo.description?i.setValues(e.photoId,{title:o.photo.title.content,description:o.photo.description.content}):r.warn("No updated data returned from API.")}},function(t){throw e.fullResponse&&(t.photoIds=e.photoId,t.returnApi="setMeta"),t}).then(null,t.FetcherErrorLogger(o))}var r=require("lib/flog")(o);t.namespace("ModelUpdaters")["flickr-photos-setMeta"]={run:e}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("flickr-photos-licenses-setLicense-updater",function(e,s){"use strict";function o(o,n){var t={};return o.fullResponse?(t.photo_ids=o.photoId,t.full_response=1):t.photo_id=o.photoId,t.license_id=o.license,n.callAPI("flickr.photos.licenses.setLicense",t).then(function(e){if("errors"in e)return e.api="setLicense",e},function(e){throw o.fullResponse&&(e.photoIds=o.photoId,e.returnApi="setLicense"),e}).then(null,e.FetcherErrorLogger(s))}e.namespace("ModelUpdaters")["flickr-photos-licenses-setLicense"]={run:o}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-photos-setSafetyLevel-updater",function(e,t){"use strict";function o(o,r){var s={};return o.fullResponse?(s.photo_ids=o.photoId,s.full_response=1):s.photo_id=o.photoId,s.safety_level=o.safetyLevel+1,r.callAPI("flickr.photos.setSafetyLevel",s).then(function(e){if("errors"in e)return e.api="setSafety",e},function(e){throw o.fullResponse&&(e.photoIds=o.photoId,e.returnApi="setSafety"),e}).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-photos-setSafetyLevel"]={run:o}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("photo-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)},update:function(t,i){var r=[];return("title"in i||"description"in i)&&r.push(e.ModelUpdaters["flickr-photos-setMeta"].run({photoId:t,title:i.title?i.title.newVal:this.getValue(t,"title"),description:i.description?i.description.newVal:this.getValue(t,"description")},this.appContext)),"license"in i&&r.push(e.ModelUpdaters["flickr-photos-licenses-setLicense"].run({photoId:t,license:i.license.newVal},this.appContext)),"safetyLevel"in i&&r.push(e.ModelUpdaters["flickr-photos-setSafetyLevel"].run({photoId:t,safetyLevel:i.safetyLevel.newVal},this.appContext)),e.Promise.all(r)},batchUpdate:function(t,i){var r=[];return"safetyLevel"in i&&r.push(e.ModelUpdaters["flickr-photos-setSafetyLevel"].run({photoId:t,safetyLevel:parseInt(i.safetyLevel,10),fullResponse:1},this.appContext)),"title"in i&&"description"in i?r.push(e.ModelUpdaters["flickr-photos-setMeta"].run({photoId:t,title:i.title,description:i.description,fullResponse:1},this.appContext)):"title"in i?r.push(e.ModelUpdaters["flickr-photos-setMeta"].run({photoId:t,title:i.title,fullResponse:1},this.appContext)):"description"in i&&r.push(e.ModelUpdaters["flickr-photos-setMeta"].run({photoId:t,description:i.description,fullResponse:1},this.appContext)),"license"in i&&r.push(e.ModelUpdaters["flickr-photos-licenses-setLicense"].run({photoId:t,license:i.license,fullResponse:1},this.appContext)),e.Promise.all(r)}},getLargestSize:e.PhotoModelHelper.getLargestSize,getSizeToFit:e.PhotoModelHelper.getSizeToFit,getSizeIfExact:e.PhotoModelHelper.getSizeIfExact,isSizeSquare:e.PhotoModelHelper.isSizeSquare,isPhotoSquare:e.PhotoModelHelper.isPhotoSquare,getSizeForCanvas:e.PhotoModelHelper.getSizeForCanvas,getGuestpass:function(t){var i=this;return new e.Promise(function(e,r){i.getValue(t,"guestpass")?e():i.appContext.callAPI("flickr.sharing.createGuestpass",{photo:t}).then(function(r){i.setValue(t,"guestpass",r.guestpass.url),e()})})},canVr:function(t){var i,r=this,o=!1;return this.appContext.flipper.isFlipped("enable-vr")?(r&&(i=r.getValue(t,"aspectRatio"))&&i>=1.99&&i<=2.01&&(o=!0),o?e.Promise.all([this.appContext.callAPI("flickr.vr.isEquirectangular",{photo_id:t})]).then(function(t){return e.Promise.resolve(!!t[0].is_equirectangular)}):e.Promise.resolve(!1)):e.Promise.resolve(!1)},attributes:{title:e.PhotoModelHelper.attributes.title,description:e.PhotoModelHelper.attributes.description,mediaType:e.PhotoModelHelper.attributes.mediaType,license:e.PhotoModelHelper.attributes.license,isVideo:e.PhotoModelHelper.attributes.isVideo,isOwner:e.PhotoModelHelper.attributes.isOwner,sizes:e.PhotoModelHelper.attributes.sizes,descendingSizes:e.PhotoModelHelper.attributes.descendingSizes,ascendingSizes:e.PhotoModelHelper.attributes.ascendingSizes,aspectRatio:e.PhotoModelHelper.attributes.aspectRatio,needsInterstitial:e.PhotoModelHelper.attributes.needsInterstitial,canComment:e.PhotoModelHelper.attributes.canComment,canPublicComment:e.PhotoModelHelper.attributes.canPublicComment,url:e.PhotoModelHelper.attributes.url,rotation:e.PhotoModelHelper.attributes.rotation,similaritySearchURL:e.PhotoModelHelper.attributes.similaritySearchURL,basicSimilaritySearchURL:e.PhotoModelHelper.attributes.basicSimilaritySearchURL,owner:{isModel:!0},engagement:{isModel:!0},isHD:{},secret:{},canAddMeta:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!0},oWidth:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},oHeight:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},safetyLevel:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},guestpass:{},hasInvalidColorspaceForPrint:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},sizesForAlbum:{readOnly:!0,derivedBy:["sizes"],defaultFn:function(t){var i=this.getValue(t,"sizes");return e.Object.each(i,function(e,t){e.src=e.url}),i}},stats:{isModel:!0},visibilitySource:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:1},isVideoPending:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","photo-model-helper","flickr-photos-getInfo-fetcher","flickr-photos-setPerms-updater","flickr-photos-setMeta-updater","flickr-photos-licenses-setLicense-updater","flickr-photos-setSafetyLevel-updater","attribute-helpers"]});
YUI.add("flickr-photos-getInfo-fetcher",function(o,t){"use strict";function e(t){var e,s;return e=["sizes","icon_urls","ignored","rev_ignored","rev_contacts","venue","datecreate"].join(","),e=e+","+o.APIHelper.request.getRebootPhotoExtras(),s={datecreate:1,extras:e,photo_id:t.id,get_contexts:1,primary_photo_extras:"url_sq, url_t, url_s, url_m"},t.userId?s.user_id=t.userId:t.pathAlias&&(s.path_alias=t.pathAlias),t.context&&(s.context=t.context,s.num_prev=1,s.num_next=1),t.scrappy&&(o.APIHelper.request.addStaticMapsParams(s),delete s.get_contexts,delete s.primary_photo_extras,delete s.context),s}function s(t,e,s){var i,p,n,a,h,d,l,g,c,y,m=t.apiResponse,R=t.photoRegistry,u=t.personRegistry,M=t.personRelationshipRegistry,f=t.photoEngagementRegistry,w=t.photoStatsRegistry,v=t.photoPrivacyRegistry,T=t.photoNotesRegistry,x=t.noteRegistry,A=t.photoGeoRegistry,H=t.photoLocationRegistry,P=t.photoHeadMetaRegistry,_=t.groupRegistry,k={},I=[];if(!m.photo.sizes)throw new Error("Missing photo sizes from flickr.photos.getInfo call.");p={id:m.photo.id,title:m.photo.title.content,description:m.photo.description.content,sizes:o.APIHelper.response.parsePhotoSize(m.photo.sizes.size,!0),needsInterstitial:m.photo.needsInterstitial,canComment:m.photo.editability.cancomment,canPublicComment:m.photo.publiceditability.cancomment,canAddMeta:m.photo.editability.canaddmeta,safetyLevel:m.photo.safetyLevel,license:m.photo.license,mediaType:m.photo.media,secret:m.photo.secret,isHD:o.APIHelper.response.isHD(m.photo.sizes.size),rotation:m.photo.rotation,hasInvalidColorspaceForPrint:m.photo.hasInvalidColorspaceForPrint,oWidth:m.photo.oWidth?parseInt(m.photo.oWidth,10):"",oHeight:m.photo.oHeight?parseInt(m.photo.oHeight,10):"",visibilitySource:m.photo.visibilitySource,isVideoPending:m.photo.video?m.photo.video.pending:0},n={id:m.photo.owner.nsid,username:m.photo.owner.username,realname:m.photo.owner.realname,pathAlias:m.photo.owner.pathAlias,buddyicon:o.APIHelper.response.agnosticizeFarmPathTransferProtocol(m.photo.owner.iconurls),isAdFree:m.photo.owner.isAdFree,isPro:m.photo.owner.ispro,dateCreated:m.photo.owner.datecreate,location:m.photo.owner.location},a={id:m.photo.owner.nsid,pathAlias:m.photo.owner.pathAlias,isContact:m.photo.contactIscontact,isFamily:m.photo.contactIsfamily,isFriend:m.photo.contactIsfriend,isIgnored:m.photo.owner.isignored,isIgnoredBy:m.photo.owner.revIgnored,isRevContact:m.photo.owner.revContact,isRevFamily:m.photo.owner.revFamily,isRevFriend:m.photo.owner.revFriend},h={id:m.photo.id,ownerNsid:m.photo.owner.nsid,isFaved:m.photo.isfavorite||!1,canShare:m.photo.usage.canshare,canDownload:m.photo.usage.candownload,commentCount:m.photo.comments.content,noteCount:m.photo.notes&&m.photo.notes.note&&m.photo.notes.note.length,faveCount:m.photo.countFaves,viewCount:m.photo.views},d={id:m.photo.id,dateTaken:m.photo.dates.taken,datePosted:m.photo.dates.posted,takenGranularity:m.photo.dates.takengranularity,isDateTakenUnknown:m.photo.datetakenunknown||"1"===m.photo.datetakenunknown||1===m.photo.datetakenunknown},g={id:m.photo.id,title:m.photo.HTMLMETA["og:title"],noindexfollow:m.photo.owner.noindexfollow,keywords:m.photo.HTMLMETA.keywords,"og:title":m.photo.HTMLMETA["og:title"],"og:description":m.photo.HTMLMETA["og:description"],"og:type":m.photo.HTMLMETA["og:type"],"og:url":m.photo.HTMLMETA["og:url"],"og:image":m.photo.HTMLMETA["og:image"],"og:image:width":m.photo.HTMLMETA["og:image:width"],"og:image:height":m.photo.HTMLMETA["og:image:height"],"flickr_photos:by":m.photo.HTMLMETA["flickr_photos:by"],"flickr_photos:camera":m.photo.HTMLMETA["flickr_photos:camera"],"flickr_photos:sets":m.photo.HTMLMETA["flickr_photos:sets"],"flickr_photos:groups":m.photo.HTMLMETA["flickr_photos:groups"],"flickr_photos:galleries":m.photo.HTMLMETA["flickr_photos:galleries"],"twitter:card":m.photo.HTMLMETA["twitter:card"],"twitter:description":m.photo.HTMLMETA["twitter:description"],"twitter:app:url:iphone":m.photo.HTMLMETA["twitter:app:url:iphone"],"twitter:creator":m.photo.HTMLMETA["twitter:creator"],pinterest:m.photo.HTMLMETA.pinterest},l={id:m.photo.id,isPublic:m.photo.visibility.ispublic,isVisibleByFriends:m.photo.visibility.isfriend,isVisibleByFamily:m.photo.visibility.isfamily,permAddMeta:m.photo.permissions?m.photo.permissions.permaddmeta:0,permComment:m.photo.permissions?m.photo.permissions.permcomment:0},m.photo&&m.photo.notes&&m.photo.notes.note&&o.Array(m.photo.notes.note).forEach(function(o){I.push(x.addOrUpdate({id:o.id,author:o.author,authorName:o.authorname,authorRealName:o.authorrealname,authorIsPro:o.authorispro,left:o.x,top:o.y,width:o.w,height:o.h,text:o.content}))}),c=o.ModelFetchers["flickr-photos-getLocation"].mapResponse(m,A),p.owner=u.addOrUpdate(n),p.engagement=f.addOrUpdate(h),M.addOrUpdate(a),y=R.addOrUpdate(p),w.addOrUpdate(d),v.addOrUpdate(l),T.addOrUpdate({id:p.id,notes:I}),P.addOrUpdate(g),H.addOrUpdate(c),m.photo.contexts&&(i=t.contextsRegistry,k.faves=t.favoriteRegistry,k.gallery=t.galleryRegistry,k.pool=t.groupsPoolRegistry,k.set=t.setRegistry,k.stream=t.photostreamRegistry,r({photoModel:y,contextRegistries:k,contextsResponse:m.photo.contexts,personRegistry:u,contextsRegistry:i,photoEngagementRegistry:f,photoStatsRegistry:w,groupRegistry:_,apiParams:s}))}function r(t){var e=t.photoModel,s=t.contextRegistries,r=t.contextsResponse,i=t.personRegistry,p=t.contextsRegistry,n=t.photoEngagementRegistry,a=t.photoStatsRegistry,h=t.groupRegistry,d=t.apiParams,l=[];o.Object.each(s,function(t,s){r[s]&&o.Array.each(r[s],function(s){o.APIHelper.response.addContextToRegistry(s,t,i,h),l.push(t.proxy(s.id)),d.context&&(function(){var r,p,h,l,g,c,y,m,R;r=t.getValue(s.id,"photoContextList"),p=!!r.hasMinBoundary&&r.hasMinBoundary(),h=!!r.hasMaxBoundary&&r.hasMaxBoundary(),l=r.getList(),c=s.nextphotos,y=s.prevphotos,m=c?o.APIHelper.response.parsePhotos({photos:c.photo,personModelRegistry:i,photoModelRegistry:e.registry,photoEngagementModelRegistry:n,photoStatsModelRegistry:a}):[],R=y?o.APIHelper.response.parsePhotos({photos:y.photo,personModelRegistry:i,photoModelRegistry:e.registry,photoEngagementModelRegistry:n,photoStatsModelRegistry:a}):[],(R.length||m.length)&&(g=o.APIHelper.response.addOrReplaceListByContext({model:e,next:m,prev:R.reverse(),current:l,hasMin:p,hasMax:h,numNext:d.num_next,numPrev:d.num_prev})),t.setValue(s.id,"photoContextList",g)})()})}),p.exists(e.id)||(p.add({id:e.id,totalGroups:r.pool?r.pool.length:0,totalSets:r.set?r.set.length:0,totalGalleries:r.gallery?r.gallery.length:0}),p.setValue(e.id,"contexts",l))}function i(e,s){var r,i,p=this;return s.flipper.isFlipped("enable-scrappy-photo-page")&&(e.scrappy=!0),i=!0,r=this._processParams(e),new o.FlickrPromise({apiResponse:s.callAPI("flickr.photos.getInfo",r,i),photoRegistry:s.getModelRegistry("photo-models"),personRegistry:s.getModelRegistry("person-models"),personRelationshipRegistry:s.getModelRegistry("person-relationship-models"),photoEngagementRegistry:s.getModelRegistry("photo-engagement-models"),photoStatsRegistry:s.getModelRegistry("photo-stats-models"),photoPrivacyRegistry:s.getModelRegistry("photo-privacy-models"),photoNotesRegistry:s.getModelRegistry("photo-notes-models"),noteRegistry:s.getModelRegistry("note-models"),photoGeoRegistry:s.getModelRegistry("photo-geo-models"),photoLocationRegistry:s.getModelRegistry("photo-location-models"),photoHeadMetaRegistry:s.getModelRegistry("photo-head-meta-models"),groupRegistry:s.getModelRegistry("group-models"),contextsRegistry:s.getModelRegistry("photo-contexts-models"),favoriteRegistry:s.getModelRegistry("favorite-models"),galleryRegistry:s.getModelRegistry("gallery-models"),groupsPoolRegistry:s.getModelRegistry("group-pool-models"),setRegistry:s.getModelRegistry("set-models"),photostreamRegistry:s.getModelRegistry("photostream-models")}).then(function(o){return p._processResponse(o,s.flipper,r)},o.FetcherErrorLogger(t))}o.namespace("ModelFetchers")["flickr-photos-getInfo"]={run:i,_processParams:e,_processResponse:s}},"@VERSION@",{requires:["flickr-promise","api-helper","flickr-photos-getLocation-fetcher"],optional:["photo-models","person-models","person-relationship-models","photo-engagement-models","photo-stats-models","photo-geo-models","photo-location-models","photo-head-meta-models","note-models","photo-notes-models","autotag-models","photo-autotags-models"]});
YUI.add("photo-geo-models",function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{read:function(e){return t.ModelFetchers["flickr-photos-getInfo"].run(e,this.appContext).then(function(t){return t},function(){})},update:function(e,r){var i={photo_id:e,lat:this.getValue(e,"latitude"),lon:this.getValue(e,"longitude")};return r.hasOwnProperty("accuracy")&&(i.accuracy=this.getValue(e,"accuracy")),(r.hasOwnProperty("isPublic")||r.hasOwnProperty("isContact")||r.hasOwnProperty("isFriend")||r.hasOwnProperty("isFamily"))&&(i.is_public=Number(this.getValue(e,"isPublic")),i.is_contact=Number(this.getValue(e,"isContact")),i.is_friend=Number(this.getValue(e,"isFriend")),i.is_family=Number(this.getValue(e,"isFamily"))),t.ModelUpdaters["flickr-photos-geo-setLocation"].run(i,this.appContext)}},attributes:{hasGeo:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},latitude:{validator:function(e,r){return t.AttributeHelpers.validateFloat(e)},setter:function(e){return t.AttributeHelpers.coerceFloat(e)||void 0},defaultValue:void 0},longitude:{validator:function(e,r){return t.AttributeHelpers.validateFloat(e)},setter:function(e){return t.AttributeHelpers.coerceFloat(e)||void 0},defaultValue:void 0},accuracy:{validator:function(e,r){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(Math.max(1,Math.min(e,16)))||void 0},defaultValue:1},isPublic:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},isContact:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},isFriend:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},isFamily:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-getInfo-fetcher","attribute-helpers","flickr-photos-geo-setLocation-updater"]});
YUI.add("photo-lite-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{update:e.PhotoModelHelper.updateEngagement},toggleFave:e.PhotoModelHelper.toggleFave,addAsFave:e.PhotoModelHelper.addAsFave,getLargestSize:e.PhotoModelHelper.getLargestSize,getSizeToFit:e.PhotoModelHelper.getSizeToFit,getSizeIfExact:e.PhotoModelHelper.getSizeIfExact,isSizeSquare:e.PhotoModelHelper.isSizeSquare,isPhotoSquare:e.PhotoModelHelper.isPhotoSquare,attributes:{owner:{readOnly:!0,isModel:!0,getter:function(e,t){var r=this;return{id:r.getValue(t,"ownerNsid"),getValue:function(e){return"id"===e?r.getValue(t,"ownerNsid"):"nsid"===e?r.getValue(t,"ownerNsid"):"url"===e?r.getValue(t,"ownerUrl"):r.getValue(t,e)},toJSON:function(){return{id:r.getValue(t,"ownerNsid"),url:r.getValue(t,"ownerUrl"),pathAlias:r.getValue(t,"pathAlias"),username:r.getValue(t,"username"),realname:r.getValue(t,"realname"),displayname:r.getValue(t,"displayname"),nsid:r.getValue(t,"ownerNsid"),ownerUrl:r.getValue(t,"ownerUrl"),isMe:r.getValue(t,"isMe")}},exists:function(e){return!1}}}},pathAlias:e.PersonModelHelper.attributes.pathAlias,username:e.PersonModelHelper.attributes.username,realname:e.PersonModelHelper.attributes.realname,displayname:e.PersonModelHelper.attributes.displayname,nsid:e.PersonModelHelper.attributes.nsid,ownerUrl:e.PersonModelHelper.attributes.url,isMe:e.PersonModelHelper.attributes.isMe,engagement:{readOnly:!0,isModel:!0,getter:function(e,t){var r=this;return{getValue:function(e){return r.getValue(t,e)},toJSON:function(){return{ownerNsid:r.getValue(t,"ownerNsid"),isFaved:r.getValue(t,"isFaved"),faveCount:r.getValue(t,"faveCount"),commentCount:r.getValue(t,"commentCount"),canFave:r.getValue(t,"canFave")}},exists:function(e){return!1}}}},ownerNsid:e.PhotoModelHelper.attributes.ownerNsid,isFaved:e.PhotoModelHelper.attributes.isFaved,faveCount:e.PhotoModelHelper.attributes.faveCount,commentCount:e.PhotoModelHelper.attributes.commentCount,canFave:e.PhotoModelHelper.attributes.canFave,title:e.PhotoModelHelper.attributes.title,description:e.PhotoModelHelper.attributes.description,mediaType:e.PhotoModelHelper.attributes.mediaType,license:e.PhotoModelHelper.attributes.license,isVideo:e.PhotoModelHelper.attributes.isVideo,isOwner:e.PhotoModelHelper.attributes.isOwner,sizes:e.PhotoModelHelper.attributes.sizes,descendingSizes:e.PhotoModelHelper.attributes.descendingSizes,ascendingSizes:e.PhotoModelHelper.attributes.ascendingSizes,aspectRatio:e.PhotoModelHelper.attributes.aspectRatio,needsInterstitial:e.PhotoModelHelper.attributes.needsInterstitial,canComment:e.PhotoModelHelper.attributes.canComment,url:e.PhotoModelHelper.attributes.url,rotation:e.PhotoModelHelper.attributes.rotation,similaritySearchURL:e.PhotoModelHelper.attributes.similaritySearchURL,basicSimilaritySearchURL:e.PhotoModelHelper.attributes.basicSimilaritySearchURL,oWidth:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},oHeight:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},hasInvalidColorspaceForPrint:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isPublic:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isVisibleByFriends:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isVisibleByFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","photo-model-helper","person-model-helper","flickr-favorites-add-updater","flickr-favorites-remove-updater","photo-models","photo-engagement-models","person-models"]});
YUI.add("flickr-explore-getContext-fetcher",function(e,o){"use strict";function t(o){return{photo_id:o.photoId,extras:e.APIHelper.request.getRebootPhotoExtras(),num_prev:o.numPrev,num_next:o.numNext}}function r(o,t){var r,s,n,p,l,i,a=o[0],h=o[1],d=o[2],g=o[3],u=o[4],m=o[5],x=[],c=[],y=d.proxy(t.photoId),M=[];return r=a.nextphotos,s=a.prevphotos,c=e.APIHelper.response.parsePhotos({photos:r.photo,personModelRegistry:g,photoModelRegistry:d,photoEngagementModelRegistry:u,photoStatsModelRegistry:m}),x=e.APIHelper.response.parsePhotos({photos:s.photo,personModelRegistry:g,photoModelRegistry:d,photoEngagementModelRegistry:u,photoStatsModelRegistry:m}),i=h.getValue(t.id,"photoContextList"),p=!!i.hasMinBoundary&&i.hasMinBoundary(),l=!!i.hasMaxBoundary&&i.hasMaxBoundary(),n=i.getList(),M=e.APIHelper.response.addOrReplaceListByContext({model:y,next:c,prev:x.reverse(),current:n,hasMin:p,hasMax:l,numNext:t.numNext,numPrev:t.numPrev}),h.setValue(t.id,"photoContextList",M),{next:c,previous:x.reverse()}}function s(t,r){var s=this;return e.Promise.all([r.callAPI("flickr.explore.getContext",this._processParams(t),!0),r.getModelRegistry("explore-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models")]).then(function(e){return s._processResponse(e,t)},function(e){throw 1===e.code&&"Photo not in explore"===e.message&&(e.notInContext=!0),e}).then(null,e.FetcherErrorLogger(o))}e.namespace("ListFetchers")["flickr-explore-getContext"]={run:s,_processParams:t,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["explore-models","photo-models","photo-engagement-models","photo-stats-models"]});
YUI.add("explore-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,langBundles:this.details.langBundles,remote:{read:function(t){return e.ListFetchers["flickr-interestingness-getList"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-interestingness-getList"]}},totalItems:{defaultValue:0,setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-explore-getContext"],listItemIdField:"photoId"}},displayType:{readOnly:!0,defaultValue:"explore"},url:{readOnly:!0,defaultFn:function(e){return"/explore/"+e.replace(/-/g,"/")}},urlSuffix:{readOnly:!0,defaultFn:function(e){return"explore-"+e}},title:{readOnly:!0,defaultFn:function(e){return this.intlMessage({intlName:"models.EXPLORE_TITLE",id:e})}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-interestingness-getList-fetcher","flickr-explore-getContext-fetcher"],langBundles:["models"]});
YUI.add("flickr-interestingness-getList-fetcher",function(e,t){function o(t,o){var r;return r={extras:e.APIHelper.request.getRebootPhotoLiteExtras(),per_page:t.perPage||p,page:t.page||"1",date:t.id},e.merge(r,t.apiParams||{})}function r(t,o){var r,s=t[0],p=t[1],a=t[2],i={id:o.id},n=[];if(!o.id)throw new ReferenceError("No `id` provided by request.");if(!s.photos||!s.photos.photo)throw new Error("No `photos.photo` property returned by API.");return n=s.photos.photo.map(function(t){return r=e.APIHelper.response.parsePhotoLite(t),a.addOrUpdate(r)}),i.photos={perPage:s.photos.perpage,page:s.photos.page||1,pageContent:n,totalItems:s.photos.total,totalPages:s.photos.pages},i.totalItems=s.photos.total,p.addOrUpdate(i),i.photos.pageContent}function s(o,r){var s,p=this,a=this._processParams(o,r);return s=[r.callAPI("flickr.interestingness.getList",a),r.getModelRegistry("explore-models"),r.getModelRegistry("photo-lite-models")],e.Promise.all(s).then(function(e){return p._processResponse(e,o)},e.FetcherErrorLogger(t))}var p=100;e.namespace("ListFetchers")["flickr-interestingness-getList"]={run:s,_processParams:o,_processResponse:r}},"@VERSION@",{requires:["api-helper","flickr-promise"],optional:["explore-models","photo-lite-models"]});
YUI.add("hermes-template-explore-page",function(t,a){var e=t.Template.Handlebars.revive({1:function(t,a,e,l,n){return'<button class="tool tools-menu"></button>'},3:function(t,a,e,l,n){return" selected"},5:function(t,a,e,l,n){return" is-disabled"},compiler:[7,">= 4.0.0"],main:function(t,a,e,l,n){var r,o,u=null!=a?a:{},s=e.helperMissing,i=t.escapeExpression,c="function";return i((e.outlet||a&&a.outlet||s).call(u,null!=a?a["global-nav-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n"+i((e.outlet||a&&a.outlet||s).call(u,null!=a?a["fluid-explore-subnav-view"]:a,{name:"outlet",hash:{},data:n}))+'\n\n<div role="main" class="main fluid-centered">\n\n\t<div class="title-row">\n\n\t\t<h3>'+i((e.intlMessage||a&&a.intlMessage||s).call(u,{name:"intlMessage",hash:{intlName:"common.EXPLORE"},data:n}))+'</h3>\n\n\t\t<div class="tools">\n\t\t\t'+(null!=(r=e.if.call(u,null!=a?a.godUser:a,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?r:"")+'\n\t\t\t<button data-layout-style="justified" class="tool layout justified'+(null!=(r=e.if.call(u,null!=a?a.isJustifiedLayout:a,{name:"if",hash:{},fn:t.program(3,n,0),inverse:t.noop,data:n}))?r:"")+'" data-track="explore-layout-justified"></button>\n\t\t\t<button data-layout-style="story" class="tool layout story'+(null!=(r=e.if.call(u,null!=a?a.isStoryLayout:a,{name:"if",hash:{},fn:t.program(3,n,0),inverse:t.noop,data:n}))?r:"")+'" data-track="explore-layout-story"></button>\n\t\t</div>\n\n\t</div>\n\n\t'+i((e.outlet||a&&a.outlet||s).call(u,null!=a?a["photo-list-view"]:a,{name:"outlet",hash:{},data:n}))+'\n\n\t<div class="explore-pagination">\n\t\t<a href="'+i((o=null!=(o=e.prevDateLink||(null!=a?a.prevDateLink:a))?o:s,typeof o===c?o.call(u,{name:"prevDateLink",hash:{},data:n}):o))+'" class="butt page-back" data-track="explore-page-back">'+i((o=null!=(o=e.prevDateStr||(null!=a?a.prevDateStr:a))?o:s,typeof o===c?o.call(u,{name:"prevDateStr",hash:{},data:n}):o))+'</a>\n\t\t<a class="butt curr-date">'+i((o=null!=(o=e.currDateStr||(null!=a?a.currDateStr:a))?o:s,typeof o===c?o.call(u,{name:"currDateStr",hash:{},data:n}):o))+'</a>\n\t\t<a href="'+i((o=null!=(o=e.nextDateLink||(null!=a?a.nextDateLink:a))?o:s,typeof o===c?o.call(u,{name:"nextDateLink",hash:{},data:n}):o))+'" class="butt page-forward'+(null!=(r=e.if.call(u,null!=a?a.disableNext:a,{name:"if",hash:{},fn:t.program(5,n,0),inverse:t.noop,data:n}))?r:"")+'" data-track="explore-page-forward">'+i((o=null!=(o=e.nextDateStr||(null!=a?a.nextDateStr:a))?o:s,typeof o===c?o.call(u,{name:"nextDateStr",hash:{},data:n}):o))+"</a>\n\t</div>\n\n</div>\n\n"+i((e.outlet||a&&a.outlet||s).call(u,null!=a?a["signup-footer-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n"+i((e.outlet||a&&a.outlet||s).call(u,null!=a?a["footer-full-view"]:a,{name:"outlet",hash:{},data:n}))+"\n"},useData:!0}),l={};t.Array.each([],function(a){var e=t.Template.get("hermes/"+a);e&&(l[a]=e)}),t.Template.register("hermes/explore-page",function(a,n){return n=n||{},n.partials=n.partials?t.merge(l,n.partials):l,e(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
