YUI.add("hermes-template-feedback-widget",function(e,a){var l=e.Template.Handlebars.revive({1:function(e,a,l,n,r){var t;return' data-track="'+e.escapeExpression((t=null!=(t=l.trackingSlk||(null!=a?a.trackingSlk:a))?t:l.helperMissing,"function"==typeof t?t.call(null!=a?a:{},{name:"trackingSlk",hash:{},data:r}):t))+'"'},compiler:[7,">= 4.0.0"],main:function(e,a,l,n,r){var t,s,i=null!=a?a:{},c=l.helperMissing,f=e.escapeExpression;return'<a href="'+f((s=null!=(s=l.feedbackUrl||(null!=a?a.feedbackUrl:a))?s:c,"function"==typeof s?s.call(i,{name:"feedbackUrl",hash:{},data:r}):s))+'" class="feedback-link"'+(null!=(t=l.if.call(i,null!=a?a.trackingSlk:a,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?t:"")+'><i class="feedback-icon">&nbsp;</i>'+f((l.intlMessage||a&&a.intlMessage||c).call(i,{name:"intlMessage",hash:{intlName:"feedback.FEEDBACK_LINK"},data:r}))+"</a>\n"},useData:!0}),n={};e.Array.each([],function(a){var l=e.Template.get("hermes/"+a);l&&(n[a]=l)}),e.Template.register("hermes/feedback-widget",function(a,r){return r=r||{},r.partials=r.partials?e.merge(n,r.partials):n,l(a,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("feedback-widget-view",function(e){e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.set("feedbackUrl",e.feedbackUrl),this.set("trackingSlk",e.trackingSlk),this.set("hidden",e.hidden||!1)},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("feedback-widget",{feedbackUrl:this.get("feedbackUrl"),trackingSlk:this.get("trackingSlk")}),this.get("hidden")&&this.get("container").addClass("hidden"),this},activate:function(){var t=e.one(".footer-full-view"),i=t?t.one("footer.foot"):null;return this.set("footerContainer",t),this.set("footer",i),this.registerEventHandler(e.globalEvents.subscribe("window:scroll",this.updateWidgetPosition.bind(this))),this.registerEventHandler(e.globalEvents.subscribe("window:resize",this.updateWidgetPosition.bind(this))),this.updateWidgetPosition(),this},onParentViewEvent:function(e,t){switch(t&&t.length&&t[0]){case"footerDisplayChanged":this.updateWidgetPosition();break;case"unhideFeedbackWidget":this.get("container").removeClass("hidden")}},updateWidgetPosition:function(t){var i;this.get("footer")&&(i=e.config.win.pageYOffset+this.appContext.viewportData.getHeight(),"none"!==this.get("footerContainer").getComputedStyle("display")&&i>=this.get("footer").getY()?this.get("container").hasClass("hugging-footer")||this.get("container").addClass("hugging-footer"):this.get("container").hasClass("hugging-footer")&&this.get("container").removeClass("hugging-footer"))}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-feedback-widget"],langBundles:["feedback"]});
YUI.add("hermes-lang-feedback",function(e,a){e.Intl.add("hermes/feedback","en-US",{HELP_AND_FEEDBACK:["Help &amp; Feedback"],FEEDBACK_LINK:["Feedback"],FAQS_LINK:["FAQs"],OPT_OUT_LINK:["Opt out of the new Photo Experience"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-search-people-page",function(e,a){var l=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,l,t,n){var r=null!=a?a:{},u=l.helperMissing,s=e.escapeExpression;return s((l.outlet||a&&a.outlet||u).call(r,null!=a?a["global-nav-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n"+s((l.outlet||a&&a.outlet||u).call(r,null!=a?a["search-subnav-slender-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n"+s((l.outlet||a&&a.outlet||u).call(r,null!=a?a["search-people-results-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n"+s((l.outlet||a&&a.outlet||u).call(r,null!=a?a["feedback-widget-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n"+s((l.outlet||a&&a.outlet||u).call(r,null!=a?a["footer-full-view"]:a,{name:"outlet",hash:{},data:n}))+"\n"},useData:!0}),t={};e.Array.each([],function(a){var l=e.Template.get("hermes/"+a);l&&(t[a]=l)}),e.Template.register("hermes/search-people-page",function(a,n){return n=n||{},n.partials=n.partials?e.merge(t,n.partials):t,l(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-search-subnav",function(t,a){var n=t.Template.Handlebars.revive({1:function(t,a,n,l,e){return" using-slender-advanced-panel"},3:function(t,a,n,l,e){var s,i,r=null!=a?a:{},u=n.helperMissing,o=t.escapeExpression;return'\t\t\t\t<li class="link'+(null!=(s=n.if.call(r,null!=a?a.selected:a,{name:"if",hash:{},fn:t.program(4,e,0),inverse:t.noop,data:e}))?s:"")+'" data-id="'+o((i=null!=(i=n.id||(null!=a?a.id:a))?i:u,"function"==typeof i?i.call(r,{name:"id",hash:{},data:e}):i))+'">\n\t\t\t\t\t'+(null!=(s=n.if.call(r,null!=a?a.url:a,{name:"if",hash:{},fn:t.program(6,e,0),inverse:t.noop,data:e}))?s:"")+'\n\t\t\t\t\t\t<div class="title">'+o((i=null!=(i=n.title||(null!=a?a.title:a))?i:u,"function"==typeof i?i.call(r,{name:"title",hash:{},data:e}):i))+"</div>\n"+(null!=(s=n.if.call(r,null!=a?a.subtitle:a,{name:"if",hash:{},fn:t.program(8,e,0),inverse:t.noop,data:e}))?s:"")+"\t\t\t\t\t"+(null!=(s=n.if.call(r,null!=a?a.url:a,{name:"if",hash:{},fn:t.program(10,e,0),inverse:t.noop,data:e}))?s:"")+"\n\t\t\t\t</li>\n"},4:function(t,a,n,l,e){return" selected"},6:function(t,a,n,l,e){var s;return'<a href="'+t.escapeExpression((s=null!=(s=n.url||(null!=a?a.url:a))?s:n.helperMissing,"function"==typeof s?s.call(null!=a?a:{},{name:"url",hash:{},data:e}):s))+'">'},8:function(t,a,n,l,e){var s;return'\t\t\t\t\t\t<div class="subtitle">'+t.escapeExpression((s=null!=(s=n.subtitle||(null!=a?a.subtitle:a))?s:n.helperMissing,"function"==typeof s?s.call(null!=a?a:{},{name:"subtitle",hash:{},data:e}):s))+"</div>\n"},10:function(t,a,n,l,e){return"</a>"},12:function(t,a,n,l,e){var s,i,r=null!=a?a:{},u=n.helperMissing,o=t.escapeExpression;return'\t\t\t\t<li class="tool inactive-toggle" data-id="'+o((i=null!=(i=n.id||(null!=a?a.id:a))?i:u,"function"==typeof i?i.call(r,{name:"id",hash:{},data:e}):i))+'">\n\t\t\t\t\t<div class="radio">\n\t\t\t\t\t\t<input type="checkbox" id="inactive-groups-toggle" name="radio-small"'+(null!=(s=n.if.call(r,null!=a?a.inactiveToggleChecked:a,{name:"if",hash:{},fn:t.program(13,e,0),inverse:t.noop,data:e}))?s:"")+'>\n\t\t\t\t\t\t<label for="inactive-groups-toggle">\n\t\t\t\t\t\t\t<div class="square"></div>\n\t\t\t\t\t\t\t<span>'+o((n.intlHTMLMessage||a&&a.intlHTMLMessage||u).call(r,{name:"intlHTMLMessage",hash:{intlName:"search.HIDE_INACTIVE_GROUPS"},data:e}))+"</span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n"},13:function(t,a,n,l,e){return' checked="checked"'},15:function(t,a,n,l,e){var s,i,r=null!=a?a:{},u=n.helperMissing,o=t.escapeExpression;return'\t\t\t\t<li class="tool toggle toggle-view-type toggle-justified'+(null!=(s=n.if.call(r,null!=a?a.viewTypeJustified:a,{name:"if",hash:{},fn:t.program(4,e,0),inverse:t.noop,data:e}))?s:"")+'" data-id="'+o((i=null!=(i=n.id||(null!=a?a.id:a))?i:u,"function"==typeof i?i.call(r,{name:"id",hash:{},data:e}):i))+'">\n\t\t\t\t\t<a href="'+o((i=null!=(i=n.justUrl||(null!=a?a.justUrl:a))?i:u,"function"==typeof i?i.call(r,{name:"justUrl",hash:{},data:e}):i))+'" title="'+o((n.intlHTMLMessage||a&&a.intlHTMLMessage||u).call(r,{name:"intlHTMLMessage",hash:{intlName:"search.JUSTIFIED_VIEW"},data:e}))+'" class="toggle-view just" data-track="search-layout-justified"></a>\n\t\t\t\t</li>\n\t\t\t\t<li class="tool toggle toggle-view-type toggle-thumb'+(null!=(s=n.unless.call(r,null!=a?a.viewTypeJustified:a,{name:"unless",hash:{},fn:t.program(4,e,0),inverse:t.noop,data:e}))?s:"")+'" data-id="'+o((i=null!=(i=n.id||(null!=a?a.id:a))?i:u,"function"==typeof i?i.call(r,{name:"id",hash:{},data:e}):i))+'">\n\t\t\t\t\t<a href="'+o((i=null!=(i=n.thumbUrl||(null!=a?a.thumbUrl:a))?i:u,"function"==typeof i?i.call(r,{name:"thumbUrl",hash:{},data:e}):i))+'" title="'+o((n.intlHTMLMessage||a&&a.intlHTMLMessage||u).call(r,{name:"intlHTMLMessage",hash:{intlName:"search.THUMBNAIL_VIEW"},data:e}))+'" class="toggle-view thumb" data-track="search-layout-thumbs"></a>\n\t\t\t\t</li>\n'},17:function(t,a,n,l,e){var s,i,r=null!=a?a:{},u=n.helperMissing,o=t.escapeExpression;return'\t\t\t\t<li class="tool sort" data-id="'+o((i=null!=(i=n.id||(null!=a?a.id:a))?i:u,"function"==typeof i?i.call(r,{name:"id",hash:{},data:e}):i))+'">\n\t\t\t\t\t<a href="#" title="'+o((n.intlHTMLMessage||a&&a.intlHTMLMessage||u).call(r,{name:"intlHTMLMessage",hash:{intlName:"search.SORT"},data:e}))+'" class="menu-anchor">'+o(t.lambda(null!=(s=null!=a?a.selectedSort:a)?s.text:s,a))+"<span></span></a>\n\t\t\t\t</li>\n"},19:function(t,a,n,l,e){var s,i,r=null!=a?a:{},u=n.helperMissing,o=t.escapeExpression;return'\t\t\t\t<li class="tool toggle toggle-advanced'+(null!=(s=n.if.call(r,null!=a?a.advancedPanelVisible:a,{name:"if",hash:{},fn:t.program(20,e,0),inverse:t.noop,data:e}))?s:"")+'" data-id="'+o((i=null!=(i=n.id||(null!=a?a.id:a))?i:u,"function"==typeof i?i.call(r,{name:"id",hash:{},data:e}):i))+'">\n\t\t\t\t\t<a title="'+o((n.intlHTMLMessage||a&&a.intlHTMLMessage||u).call(r,{name:"intlHTMLMessage",hash:{intlName:"search.TOGGLE_ADVANCED"},data:e}))+'" href="#"><span></span>'+o((n.intlHTMLMessage||a&&a.intlHTMLMessage||u).call(r,{name:"intlHTMLMessage",hash:{intlName:"search.ADVANCED"},data:e}))+"</a>\n\t\t\t\t</li>\n"},20:function(t,a,n,l,e){return" advanced-visible"},22:function(t,a,n,l,e){return'\t\t\t\t\t<li class="tool advanced-clear">\n\t\t\t\t\t\t<a href="#" class="advanced-clear-link">'+t.escapeExpression((n.intlHTMLMessage||a&&a.intlHTMLMessage||n.helperMissing).call(null!=a?a:{},{name:"intlHTMLMessage",hash:{intlName:"search.CLEAR"},data:e}))+"</a>\n\t\t\t\t\t</li>\n"},compiler:[7,">= 4.0.0"],main:function(t,a,n,l,e){var s,i=null!=a?a:{};return'<div class="search-subnav'+(null!=(s=n.if.call(i,null!=a?a.usingSlenderAdvancedPanel:a,{name:"if",hash:{},fn:t.program(1,e,0),inverse:t.noop,data:e}))?s:"")+'">\n\n\t<div class="search-subnav-sizing fluid-centered">\n\n\t\t<div class="search-subnav-content">\n\n\t\t\t<ul class="links">\n\n'+(null!=(s=n.each.call(i,null!=a?a.links:a,{name:"each",hash:{},fn:t.program(3,e,0),inverse:t.noop,data:e}))?s:"")+'\n\t\t\t</ul>\n\n\t\t\t<ul class="tools">\n\n'+(null!=(s=n.if.call(i,null!=a?a.showInactiveToggle:a,{name:"if",hash:{},fn:t.program(12,e,0),inverse:t.noop,data:e}))?s:"")+(null!=(s=n.if.call(i,null!=a?a.showTools:a,{name:"if",hash:{},fn:t.program(15,e,0),inverse:t.noop,data:e}))?s:"")+(null!=(s=n.if.call(i,null!=a?a.showSort:a,{name:"if",hash:{},fn:t.program(17,e,0),inverse:t.noop,data:e}))?s:"")+(null!=(s=n.if.call(i,null!=a?a.showAdvanced:a,{name:"if",hash:{},fn:t.program(19,e,0),inverse:t.noop,data:e}))?s:"")+(null!=(s=n.if.call(i,null!=a?a.showAdvancedClearLink:a,{name:"if",hash:{},fn:t.program(22,e,0),inverse:t.noop,data:e}))?s:"")+"\n\n\t\t\t</ul>\n\t\t</div>\n\n\t</div>\n\n</div>\n"},useData:!0}),l={};t.Array.each([],function(a){var n=t.Template.get("hermes/"+a);n&&(l[a]=n)}),t.Template.register("hermes/search-subnav",function(a,e){return e=e||{},e.partials=e.partials?t.merge(l,e.partials):l,n(a,e)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-subnav-slender-view",function(e){var r=[{id:"photos",intlKey:"search.PHOTOS",searchType:e.SearchUrl.searchTypes.PHOTOS},{id:"people",intlKey:"search.PEOPLE",searchType:e.SearchUrl.searchTypes.PEOPLE},{id:"groups",intlKey:"search.GROUPS",searchType:e.SearchUrl.searchTypes.GROUPS}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(a){var t,s=this,h=a.modelParams&&a.modelParams.apiParams?e.merge(a.modelParams.apiParams):{},i=[];return this.set("searchType",a.searchType),this.set("searchUrl",new e.SearchUrl(h,this.appContext,this.get("searchType"))),this.set("showAdvancedClearLink",this.get("searchType")===e.SearchUrl.searchTypes.PHOTOS&&this.get("searchUrl").hasAdvancedParams(!1)),r.forEach(function(r){t=e.merge(r,{title:s.intlMessage({intlName:r.intlKey}),url:s.buildTabUrl(r.id,r.searchType),selected:r.searchType===s.get("searchType")}),t.selected&&(s.set("currentTabUrl",t.url),s.set("currentTabId",t.id)),i.push(t)}),this.set("links",i),this},buildContainer:function(){return this.setContainerWithTemplate("search-subnav",{showInactiveToggle:!1,showTools:!1,selectedSort:!1,showSort:!1,showAdvanced:!1,usingSlenderAdvancedPanel:!0,links:this.get("links"),showAdvancedClearLink:this.get("showAdvancedClearLink")}),this},activate:function(){return e.SearchUrl.isSearchUrl(this.appContext.getPreviousURL())||this.clearStoredTabUrls(),this.get("currentTabUrl")&&this.get("currentTabId")&&this.storeTabUrl(this.get("currentTabUrl"),this.get("currentTabId")),this.get("showAdvancedClearLink")&&this.registerEventHandler(this.get("container").one(".advanced-clear-link").on("click",this.handleClearAdvancedSearchClick.bind(this))),this},buildTabUrl:function(r,a){var t,s=a!==this.get("searchType")?this.checkForStoredUrl(r):null,h=this.get("searchUrl").getSearchTerm();return s?(t=new e.SearchUrl(s,this.appContext,a),h!==t.getSearchTerm()&&t.removeScope().resetToUnified().setSearchTerm(h)):(t=this.get("searchUrl").clone().setSearchType(a),a!==this.get("searchType")&&(t.removeAPIParam(e.SearchHelper.API.sort),t.removeAPIParam(e.SearchHelper.API.safeSearch)),a!==e.SearchUrl.searchTypes.PHOTOS&&t.removeScope()),t.getURL()},checkForStoredUrl:function(r){var a,t;return YUI.Env.isServer||(t=this.getStorageKeyFromTabId(r),a=e.StorageHelper.getItem(t,!0)),a},clearStoredTabUrls:function(){var r,a=this;YUI.Env.isServer||this.get("links").forEach(function(t){r=a.getStorageKeyFromTabId(t.id),e.StorageHelper.remove(r,!0)})},storeTabUrl:function(r,a){var t;YUI.Env.isServer||(t=this.getStorageKeyFromTabId(a),e.StorageHelper.setItem(t,r,!0))},getStorageKeyFromTabId:function(e){return"searchUrl-"+e},handleClearAdvancedSearchClick:function(r){var a,t=this.get("searchUrl").getSearchTerm(),s=this.get("searchUrl").getAPIParams();r.halt(),e.SearchHelper.clearParamsExceptSearchScope(s),delete s[e.SearchHelper.API.commons],a=new e.SearchUrl(s,this.appContext,this.searchType),t&&a.setSearchTerm(t),this.appContext.flapp.navigate(a.getURL())}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-subnav","storage-helper","search-helper","search-url"],langBundles:["search"]});
YUI.add("hermes-template-result-card",function(n,a){var l=n.Template.Handlebars.revive({1:function(n,a,l,t,e){return" linked"},3:function(n,a,l,t,e){var r;return'\t\t<div class="coverphoto-gradient"></div>\n\t\t<div class="cover" style="background-image:url('+n.escapeExpression((r=null!=(r=l.coverPhotoUrl||(null!=a?a.coverPhotoUrl:a))?r:l.helperMissing,"function"==typeof r?r.call(null!=a?a:{},{name:"coverPhotoUrl",hash:{},data:e}):r))+')"></div>\n'},5:function(n,a,l,t,e){var r;return'<a href="'+n.escapeExpression(n.lambda(null!=(r=null!=a?a.avatar:a)?r.link:r,a))+'" data-track="groupCardOtherClick">'},7:function(n,a,l,t,e){var r;return' data-group-nsid="'+n.escapeExpression(n.lambda(null!=(r=null!=a?a.avatar:a)?r.groupNsid:r,a))+'" '},9:function(n,a,l,t,e){var r;return' data-person-nsid="'+n.escapeExpression(n.lambda(null!=(r=null!=a?a.avatar:a)?r.personNsid:r,a))+'" '},11:function(n,a,l,t,e){return"</a>"},13:function(n,a,l,t,e){var r,u=null!=a?a:{};return'\t\t\t\t<div class="subtitle">\n\t\t\t\t\t'+(null!=(r=l.if.call(u,null!=a?a.isPro:a,{name:"if",hash:{},fn:n.program(14,e,0),inverse:n.noop,data:e}))?r:"")+"\n\t\t\t\t\t"+(null!=(r=l.each.call(u,null!=a?a.subtitles:a,{name:"each",hash:{},fn:n.program(16,e,0),inverse:n.noop,data:e}))?r:"")+"\n\t\t\t\t</div>\n"},14:function(n,a,l,t,e){return'<a href="/account/upgrade/pro" class="pro-badge-inline">PRO</a>'},16:function(n,a,l,t,e){return"<span>"+n.escapeExpression(n.lambda(a,a))+"</span>"},18:function(n,a,l,t,e){var r;return null!=(r=l.if.call(null!=a?a:{},null!=a?a.subtitle:a,{name:"if",hash:{},fn:n.program(19,e,0),inverse:n.noop,data:e}))?r:""},19:function(n,a,l,t,e){var r,u,i=null!=a?a:{};return"\t\t\t\t\t"+(null!=(r=l.if.call(i,null!=a?a.isPro:a,{name:"if",hash:{},fn:n.program(14,e,0),inverse:n.noop,data:e}))?r:"")+'\n\t\t\t\t\t<div class="subtitle">'+n.escapeExpression((u=null!=(u=l.subtitle||(null!=a?a.subtitle:a))?u:l.helperMissing,"function"==typeof u?u.call(i,{name:"subtitle",hash:{},data:e}):u))+"</div>\n"},21:function(n,a,l,t,e){var r,u=null!=a?a:{};return'\t\t\t\t<div class="links">\n\t\t\t\t\t'+(null!=(r=l.each.call(u,null!=a?a.links:a,{name:"each",hash:{},fn:n.program(22,e,0),inverse:n.noop,data:e}))?r:"")+"\n\t\t\t\t\t"+(null!=(r=l.if.call(u,null!=a?a.linksMetadata:a,{name:"if",hash:{},fn:n.program(25,e,0),inverse:n.noop,data:e}))?r:"")+"\n\t\t\t\t</div>\n"},22:function(n,a,l,t,e){var r,u=null!=a?a:{};return"<span>"+(null!=(r=l.if.call(u,null!=a?a.url:a,{name:"if",hash:{},fn:n.program(23,e,0),inverse:n.noop,data:e}))?r:"")+n.escapeExpression((l.renderTrustedMarkup||a&&a.renderTrustedMarkup||l.helperMissing).call(u,null!=a?a.text:a,{name:"renderTrustedMarkup",hash:{},data:e}))+(null!=(r=l.if.call(u,null!=a?a.url:a,{name:"if",hash:{},fn:n.program(11,e,0),inverse:n.noop,data:e}))?r:"")+"</span>"},23:function(n,a,l,t,e){var r;return'<a data-track="groupCardOtherClick"  href="'+n.escapeExpression((r=null!=(r=l.url||(null!=a?a.url:a))?r:l.helperMissing,"function"==typeof r?r.call(null!=a?a:{},{name:"url",hash:{},data:e}):r))+'">'},25:function(n,a,l,t,e){var r;return'<span class="links-metadata">'+n.escapeExpression((r=null!=(r=l.linksMetadata||(null!=a?a.linksMetadata:a))?r:l.helperMissing,"function"==typeof r?r.call(null!=a?a:{},{name:"linksMetadata",hash:{},data:e}):r))+"</span>"},27:function(n,a,l,t,e){var r;return'\t\t\t<a href="'+n.escapeExpression((r=null!=(r=l.link||(null!=a?a.link:a))?r:l.helperMissing,"function"==typeof r?r.call(null!=a?a:{},{name:"link",hash:{},data:e}):r))+'" data-track="groupCardOtherClick" class="click-anywhere"></a>\n'},29:function(n,a,l,t,e){var r;return'\t\t<div class="button-content">\n'+(null!=(r=l.if.call(null!=a?a:{},null!=(r=null!=a?a.cta:a)?r.staticButton:r,{name:"if",hash:{},fn:n.program(30,e,0),inverse:n.program(33,e,0),data:e}))?r:"")+"\t\t</div>\n"},30:function(n,a,l,t,e){var r,u=n.lambda,i=n.escapeExpression;return'\t\t\t\t<a class="butt join '+(null!=(r=l.if.call(null!=a?a:{},null!=(r=null!=a?a.cta:a)?r.hasJoined:r,{name:"if",hash:{},fn:n.program(31,e,0),inverse:n.noop,data:e}))?r:"")+'" href="'+i(u(null!=(r=null!=(r=null!=a?a.cta:a)?r.staticButton:r)?r.url:r,a))+'">'+i(u(null!=(r=null!=(r=null!=a?a.cta:a)?r.staticButton:r)?r.text:r,a))+"</a>\n"},31:function(n,a,l,t,e){return" has-joined "},33:function(n,a,l,t,e){var r;return null!=(r=l.if.call(null!=a?a:{},null!=(r=null!=a?a.cta:a)?r.joinPlaceholderId:r,{name:"if",hash:{},fn:n.program(34,e,0),inverse:n.program(36,e,0),data:e}))?r:""},34:function(n,a,l,t,e){var r;return'\t\t\t\t\t<span id="'+n.escapeExpression(n.lambda(null!=(r=null!=a?a.cta:a)?r.joinPlaceholderId:r,a))+'"></span>\n'},36:function(n,a,l,t,e){var r;return null!=(r=l.if.call(null!=a?a:{},null!=(r=null!=a?a.cta:a)?r.followPlaceholderId:r,{name:"if",hash:{},fn:n.program(37,e,0),inverse:n.program(39,e,0),data:e}))?r:""},37:function(n,a,l,t,e){var r;return'\t\t\t\t\t<span id="'+n.escapeExpression(n.lambda(null!=(r=null!=a?a.cta:a)?r.followPlaceholderId:r,a))+'"></span>\n'},39:function(n,a,l,t,e){var r,u=n.lambda,i=n.escapeExpression;return"\t\t\t\t\t\t<button"+(null!=(r=l.if.call(null!=a?a:{},null!=(r=null!=a?a.avatar:a)?r.personNsid:r,{name:"if",hash:{},fn:n.program(9,e,0),inverse:n.noop,data:e}))?r:"")+' class="'+i(u(null!=(r=null!=a?a.cta:a)?r.type:r,a))+' mini not-follow-view">'+i(u(null!=(r=null!=a?a.cta:a)?r.text:r,a))+"</button>\n"},compiler:[7,">= 4.0.0"],main:function(n,a,l,t,e){var r,u=null!=a?a:{},i=n.lambda,s=n.escapeExpression;return'<div class="result-card'+(null!=(r=l.if.call(u,null!=a?a.link:a,{name:"if",hash:{},fn:n.program(1,e,0),inverse:n.noop,data:e}))?r:"")+' reboot-restyle">\n'+(null!=(r=l.if.call(u,null!=a?a.coverPhotoUrl:a,{name:"if",hash:{},fn:n.program(3,e,0),inverse:n.noop,data:e}))?r:"")+'\t<div class="sizer-cropper" title="'+s(i(null!=(r=null!=a?a.title:a)?r.text:r,a))+'">\n\t\t<div class="avatar-content">\n\t\t\t'+(null!=(r=l.if.call(u,null!=(r=null!=a?a.avatar:a)?r.link:r,{name:"if",hash:{},fn:n.program(5,e,0),inverse:n.noop,data:e}))?r:"")+"\n\t\t\t\t<div"+(null!=(r=l.if.call(u,null!=(r=null!=a?a.avatar:a)?r.groupNsid:r,{name:"if",hash:{},fn:n.program(7,e,0),inverse:n.noop,data:e}))?r:"")+(null!=(r=l.if.call(u,null!=(r=null!=a?a.avatar:a)?r.personNsid:r,{name:"if",hash:{},fn:n.program(9,e,0),inverse:n.noop,data:e}))?r:"")+' class="'+s(i(null!=(r=null!=a?a.avatar:a)?r.noMenu:r,a))+" avatar "+s(i(null!=(r=null!=a?a.avatar:a)?r.type:r,a))+' medium" title="'+s(i(null!=(r=null!=a?a.avatar:a)?r.title:r,a))+'" data-track="groupCardOtherClick" style="background-image: url('+s(i(null!=(r=null!=a?a.avatar:a)?r.url:r,a))+');"></div>\n\t\t\t'+(null!=(r=l.if.call(u,null!=(r=null!=a?a.avatar:a)?r.link:r,{name:"if",hash:{},fn:n.program(11,e,0),inverse:n.noop,data:e}))?r:"")+'\n\t\t</div>\n\t\t<div class="text-content">\n\t\t\t<div data-track="groupCardOtherClick" class="title">'+s(i(null!=(r=null!=a?a.title:a)?r.text:r,a))+"</div>\n"+(null!=(r=l.if.call(u,null!=a?a.subtitles:a,{name:"if",hash:{},fn:n.program(13,e,0),inverse:n.noop,data:e}))?r:"")+(null!=(r=l.unless.call(u,null!=a?a.subtitles:a,{name:"unless",hash:{},fn:n.program(18,e,0),inverse:n.noop,data:e}))?r:"")+(null!=(r=l.if.call(u,null!=a?a.links:a,{name:"if",hash:{},fn:n.program(21,e,0),inverse:n.noop,data:e}))?r:"")+"\t\t</div>\n"+(null!=(r=l.if.call(u,null!=a?a.link:a,{name:"if",hash:{},fn:n.program(27,e,0),inverse:n.noop,data:e}))?r:"")+"\t</div>\n"+(null!=(r=l.if.call(u,null!=a?a.cta:a,{name:"if",hash:{},fn:n.program(29,e,0),inverse:n.noop,data:e}))?r:"")+"</div>\n"},useData:!0}),t={};n.Array.each([],function(a){var l=n.Template.get("hermes/"+a);l&&(t[a]=l)}),n.Template.register("hermes/result-card",function(a,e){return e=e||{},e.partials=e.partials?n.merge(t,e.partials):t,l(a,e)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-search-people-results-view",function(e,a){var l=e.Template.Handlebars.revive({1:function(e,a,l,t,n){return'\t\t<div style="position: absolute; top: 150px; left: 0; right: 0;"><div class="flickr-dots small"></div></div>\n'},3:function(e,a,l,t,n){var r;return null!=(r=l.if.call(null!=a?a:{},null!=a?a.validResults:a,{name:"if",hash:{},fn:e.program(4,n,0),inverse:e.program(14,n,0),data:n}))?r:""},4:function(e,a,l,t,n){var r,s=null!=a?a:{};return'\t\t\t<div class="my-people hidden">\n\t\t\t\t<h5>'+e.escapeExpression((l.intlMessage||a&&a.intlMessage||l.helperMissing).call(s,{name:"intlMessage",hash:{intlName:"search.PEOPLE_YOU_FOLLOW"},data:n}))+'</h5>\n\t\t\t\t<div id="people-results-my">\n'+(null!=(r=l.each.call(s,null!=(r=null!=a?a.results:a)?r.myPeople:r,{name:"each",hash:{},fn:e.program(5,n,0),inverse:e.noop,data:n}))?r:"")+'\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="all-people hidden">\n\t\t\t\t<h5>'+(null!=(r=l.if.call(s,null!=a?a.scopedSearchTitle:a,{name:"if",hash:{},fn:e.program(7,n,0),inverse:e.program(9,n,0),data:n}))?r:"")+'</h5>\n\t\t\t\t<div id="people-results-all">\n'+(null!=(r=l.each.call(s,null!=(r=null!=a?a.results:a)?r.allPeople:r,{name:"each",hash:{},fn:e.program(5,n,0),inverse:e.noop,data:n}))?r:"")+"\t\t\t\t</div>\n\t\t\t</div>\n"},5:function(e,a,l,t,n){var r;return null!=(r=e.invokePartial(t["result-card"],a,{name:"result-card",data:n,indent:"\t\t\t\t\t\t",helpers:l,partials:t,decorators:e.decorators}))?r:""},7:function(e,a,l,t,n){var r;return e.escapeExpression((r=null!=(r=l.scopedSearchTitle||(null!=a?a.scopedSearchTitle:a))?r:l.helperMissing,"function"==typeof r?r.call(null!=a?a:{},{name:"scopedSearchTitle",hash:{},data:n}):r))},9:function(e,a,l,t,n){var r;return null!=(r=l.if.call(null!=a?a:{},null!=a?a.haveContacts:a,{name:"if",hash:{},fn:e.program(10,n,0),inverse:e.program(12,n,0),data:n}))?r:""},10:function(e,a,l,t,n){return e.escapeExpression((l.intlMessage||a&&a.intlMessage||l.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"search.ALL_FLICKR_MEMBERS"},data:n}))},12:function(e,a,l,t,n){return e.escapeExpression((l.intlMessage||a&&a.intlMessage||l.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"search.FLICKR_MEMBERS"},data:n}))},14:function(e,a,l,t,n){return"\t\t\t"+e.escapeExpression((l.outlet||a&&a.outlet||l.helperMissing).call(null!=a?a:{},null!=a?a["search-empty-view"]:a,{name:"outlet",hash:{},data:n}))+"\n"},compiler:[7,">= 4.0.0"],main:function(e,a,l,t,n){var r;return'<div class="main full-bleed fluid-centered" role="main">\n'+(null!=(r=l.if.call(null!=a?a:{},null!=a?a.loading:a,{name:"if",hash:{},fn:e.program(1,n,0),inverse:e.program(3,n,0),data:n}))?r:"")+"</div>\n"},usePartial:!0,useData:!0}),t={};e.Array.each(["result-card","result-card"],function(a){var l=e.Template.get("hermes/"+a);l&&(t[a]=l)}),e.Template.register("hermes/search-people-results-view",function(a,n){return n=n||{},n.partials=n.partials?e.merge(t,n.partials):t,l(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-result-card","hermes-template-result-card"]});
YUI.add("hermes-template-result-cards",function(e,a){var r=e.Template.Handlebars.revive({1:function(e,a,r,t,l){var s;return null!=(s=e.invokePartial(t["result-card"],a,{name:"result-card",data:l,indent:"\t",helpers:r,partials:t,decorators:e.decorators}))?s:""},compiler:[7,">= 4.0.0"],main:function(e,a,r,t,l){var s;return null!=(s=r.each.call(null!=a?a:{},null!=a?a.results:a,{name:"each",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l}))?s:""},usePartial:!0,useData:!0}),t={};e.Array.each(["result-card"],function(a){var r=e.Template.get("hermes/"+a);r&&(t[a]=r)}),e.Template.register("hermes/result-cards",function(a,l){return l=l||{},l.partials=l.partials?e.merge(t,l.partials):t,r(a,l)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-result-card"]});
YUI.add("collection-paginator",function(e){var t=e.CollectionPaginator=function(e,t,i){i&&i.page?this.page=this.startPage=i.page-1:this.page=this.startPage=0,i&&i.fetchPageSize?this.perPage=i.fetchPageSize:this.perPage=100,i&&i.viewPageSize?this.viewPageSize=i.viewPageSize:this.viewPageSize=Number.MAX_VALUE,this.lastPage=this.startPage+Math.ceil(this.viewPageSize/this.perPage),this.modelProxy=e,this.listAttr=t,this.prepending=!1,this._advanceToFirstIncompletePage(),this.valuesChangedHandle=this.modelProxy.on("valuesChanged",this._onValuesChanged.bind(this),!0)};t.prototype={passAttributesToFetcher:function(e){this.fetcherParamAttrs=e instanceof Array?e:[e]},next:function(e){return this.page<this.lastPage&&this.page++,this._getPage()},prev:function(e){return this.page>0&&this.page--,this._getPage()},getCollectionAsList:function(){return this.modelProxy.getValue(this.listAttr).getList()},getCurrentPageAsList:function(){var t=this.modelProxy.getValue(this.listAttr).getList(),i=this.startPage*this.perPage,s=i+this.viewPageSize;if(!i||isNaN(i))throw new Error("Unexpected page parameters in collection-paginator");return t=t.slice(i,s),t.length&&(t=e.FlickrCollection.trimArray(t)),t},currentPageIsLoaded:function(){return this.getCurrentPageAsList().length===this.viewPageSize||this.modelProxy.getValue(this.listAttr).fetchedEnd},_getPage:function(){var e,t={},i=this.modelProxy.getValue(this.listAttr).getList(),s=(this.page-1)*this.perPage,a=this.page*this.perPage,r=this.startPage*this.perPage+this.viewPageSize,g=!1,h=this;if(this.viewPageSize<1e3&&this.page&&this.perPage){for(e=a+1;e<r;e++)if(void 0!==i[e]){g=!0;break}if(g)for(e=s;e<a;e++)if(void 0===i[e]){this.prepending=!0;break}}return this.page&&(t.page=this.page),this.perPage&&(t.perPage=this.perPage),this.fetcherParamAttrs&&this.fetcherParamAttrs.forEach(function(e){t[e]=h.modelProxy.getValue(e)}),this.modelProxy.getValue(this.listAttr).getPage(t)},_onValuesChanged:function(e){var t;e[this.listAttr]&&e[this.listAttr].listDiff&&(t=e[this.listAttr].listDiff,this.prepending&&(this.prepending=!1,t.prepended=t.added),this.fire("listValueChanged",t))},_advanceToFirstIncompletePage:function(){var e,t=this.modelProxy.getValue(this.listAttr).getList();if(this.viewPageSize===Number.MAX_VALUE)this.page=Math.floor(this.getCollectionAsList().length/this.perPage);else for(;this.page<this.lastPage&&(e=t.slice(this.page*this.perPage,(this.page+1)*this.perPage),e.length>=this.perPage&&e.every(function(e){return void 0!==e}));)this.page++}},e.augment(t,e.EventTarget)},"@VERSION@",{requires:["event-custom","flickr-collection"]});
YUI.add("hermes-template-search-empty",function(e,a){var t=e.Template.Handlebars.revive({1:function(e,a,t,n,s){return" using-slender-advanced-panel"},3:function(e,a,t,n,s){var l,r=e.escapeExpression;return'\t\t\t<div class="no-results-message">\n\t\t\t\t<h5>'+r(e.lambda(null!=(l=null!=a?a.noMatchesForQuery:a)?l.noMatchesText:l,a))+"</h5>\n\t\t\t\t<h5>"+r((t.intlMessage||a&&a.intlMessage||t.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"search.TRY_DIFFERENT_BROADER"},data:s}))+"</h5>\n\t\t\t</div>\n"},5:function(e,a,t,n,s){var l=null!=a?a:{},r=t.helperMissing,i=e.escapeExpression;return'\t\t\t<div class="no-results-message">\n\t\t\t\t<h5>'+i((t.intlMessage||a&&a.intlMessage||r).call(l,{name:"intlMessage",hash:{intlName:"search.API_ERROR_HEADER"},data:s}))+"</h5>\n\t\t\t\t<h5>"+i((t.intlMessage||a&&a.intlMessage||r).call(l,{name:"intlMessage",hash:{intlName:"search.API_ERROR_SUBHEADER"},data:s}))+"</h5>\n\t\t\t</div>\n"},compiler:[7,">= 4.0.0"],main:function(e,a,t,n,s){var l,r,i=null!=a?a:{},c=t.helperMissing,h=e.escapeExpression;return'<div class="search-empty'+(null!=(l=t.if.call(i,null!=a?a.usingSlenderAdvancedPanel:a,{name:"if",hash:{},fn:e.program(1,s,0),inverse:e.noop,data:s}))?l:"")+'">\n\t<div class="no-results-message-container">\n'+(null!=(l=t.if.call(i,null!=a?a.noMatchesForQuery:a,{name:"if",hash:{},fn:e.program(3,s,0),inverse:e.noop,data:s}))?l:"")+(null!=(l=t.if.call(i,null!=a?a.apiFailed:a,{name:"if",hash:{},fn:e.program(5,s,0),inverse:e.noop,data:s}))?l:"")+'\t</div>\n\n\t<div class="search-box-container">\n\t\t<form method="GET" action="/search/" role="search">\n\t\t\t<div class="search-icon"></div>\n\t\t\t<input type="text" name="text" class="search-box" placeholder="'+h((r=null!=(r=t.searchPlaceholder||(null!=a?a.searchPlaceholder:a))?r:c,"function"==typeof r?r.call(i,{name:"searchPlaceholder",hash:{},data:s}):r))+'" role="textbox" autofocus>\n\t\t\t<button type="submit" class="large search-button">'+h((t.intlMessage||a&&a.intlMessage||c).call(i,{name:"intlMessage",hash:{intlName:"search.SEARCH"},data:s}))+"</button>\n\t\t</form>\n\t</div>\n</div>\n"},useData:!0}),n={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(n[a]=t)}),e.Template.register("hermes/search-empty",function(a,s){return s=s||{},s.partials=s.partials?e.merge(n,s.partials):n,t(a,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-empty-view",function(e){"use strict";e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(a){var t=a.modelParams&&a.modelParams.apiParams?e.merge(a.modelParams.apiParams):{};this.searchUrl=new e.SearchUrl(t,this.appContext,a.searchType||e.SearchUrl.searchTypes.UNDEFINED),this.searchType=a.searchType,this.isMobile=a.isMobile,""===this.get("container").get("innerHTML")&&this.setContainerHTML("")},buildContainer:function(){var a="search.PHOTOS_PEOPLE_OR_GROUPS";return this.isMobile&&(this.searchType===e.SearchUrl.searchTypes.PHOTOS?a="search.SEARCH_PHOTOS":this.searchType===e.SearchUrl.searchTypes.PEOPLE?a="search.SEARCH_PEOPLE":this.searchType===e.SearchUrl.searchTypes.GROUPS&&(a="search.SEARCH_GROUPS")),a=this.intlMessage({intlName:a}),this.setContainerWithTemplate("search-empty",{searchPlaceholder:a,noMatchesForQuery:this.get("noMatchesForQuery"),apiFailed:this.get("apiFailed"),usingSlenderAdvancedPanel:this.appContext.flipper.isFlipped("enable-slender-advanced-search")}),this},activate:function(){var e,a,t=this.get("container").one(".search-box-container form"),r=this;return e=t.one("input.search-box"),this.isMobile||this.registerEventHandler(e.on("keyup",this.handleSearchFieldKeyUp.bind(this))),t&&(this.registerEventHandler(t.on("submit",function(t){a=r.searchUrl.createNewSearch(e.get("value")).getURL(),t.halt(),r.appContext.flapp.navigate(a)})),setTimeout(function(){e.focus()},500)),this},enableBlankState:function(e){this.get("container").addClass("blank")},handleSearchFieldKeyUp:function(a){var t=a.target,r=t.get("value");r.length>0&&(this.enableBlankState(),e.fire("transfer-to-gn-search",r),t.set("value",""))},onParentViewEvent:function(e,a){a&&"error-msg-updated"===a[0]&&this.isBuilt&&this.buildContainer()}},{ATTRS:{noMatchesForQuery:{value:!1,validator:function(e,a){return!e||"object"==typeof e&&e.hasOwnProperty("noMatchesText")}},apiFailed:{value:!1,validator:function(a,t){return e.AttributeHelpers.validateBoolean(a)}}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","search-url","attribute-helpers","hermes-template-search-empty"],langBundles:["search"]});
YUI.add("search-people-results-view",function(e){"use strict";e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,stillLoadingResults:!1,initializer:function(t){return""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("search-people-results-view",{loading:!0}),this.searchParams=t.searchParams||{},this.searchParams.all?this.apiParams=e.merge(this.searchParams.all.apiParams):this.apiParams={},this.searchUrl=new e.SearchUrl(this.apiParams,this.appContext,e.SearchUrl.searchTypes.PEOPLE),this.apiFailed=t.apiFailed,this.searchTerm=t.searchTerm,this.allResults={collectionModel:null,paginator:null,renderedPages:[]},this.contactsResults={collectionModel:null,paginator:null,renderedPages:[]},this.scrollInterruptParams={pageCounts:[5],footerToHideWhileScrolling:".footer-full-view"},this.scrollInterruptState={nextInterrupt:this.scrollInterruptParams.pageCounts[0],numPagesLoaded:0,numInterrupts:0,isInterrupted:!1,footer:null,footerHeight:0},this},subviewConfig:{"search-empty-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var t=this,s={},r=["username","userId","loadFullContact"],a=["username","loadFullContact"];return YUI.Env.isServer||this.apiFailed||!this.searchParams?e.Promise.resolve():(this.searchParams.all&&(s.all=this.appContext.getModel("search-contacts-models",this.searchParams.all.id,this.searchParams.all.apiParams),this.searchParams.all.apiParams&&this.searchParams.all.apiParams[e.SearchHelper.PEOPLE_SEARCH_API.userId]&&(a.push("userId"),s.allTitle=e.SearchHelper.derivePeopleScopeTitle(this.searchParams.all.apiParams,this.appContext))),this.searchParams.contacts&&(s.contacts=this.appContext.getModel("search-contacts-models",this.searchParams.contacts.id,this.searchParams.contacts.apiParams)),e.FlickrPromise(s).then(function(s){s.all&&s.all.getValue("contacts").size()?(t.validResults=!0,t.allResults.collectionModel=s.all,t.allResults.paginator=new e.CollectionPaginator(t.allResults.collectionModel,"contacts",{fetchPageSize:t.searchParams.all.apiParams.perPage}),t.allResults.paginator.page=Math.ceil(s.all.getValue("contacts").size()/t.searchParams.all.apiParams.perPage),t.allResults.paginator.passAttributesToFetcher(a),s.allTitle&&(t.scopedSearchTitle=t.intlMessage(s.allTitle))):s.all&&(t.subviews["search-empty-view"].set("noMatchesForQuery",t.buildNoMatchesFoundMessage()),t.subviews["search-empty-view"].fire("parentViewEvent","error-msg-updated")),s.contacts&&s.contacts.getValue("contacts").size()&&(t.haveContacts=!0,t.contactsResults.collectionModel=s.contacts,t.contactsResults.paginator=new e.CollectionPaginator(t.contactsResults.collectionModel,"contacts",{fetchPageSize:t.searchParams.contacts.apiParams.perPage}),t.contactsResults.paginator.page=Math.ceil(s.contacts.getValue("contacts").size()/t.searchParams.contacts.apiParams.perPage),t.contactsResults.paginator.passAttributesToFetcher(r))}))},buildContainer:function(){return this.setContainerWithTemplate("search-people-results-view",{results:{myPeople:[],allPeople:[]},validResults:this.validResults,haveContacts:this.haveContacts,scopedSearchTitle:this.scopedSearchTitle}),!YUI.Env.isServer&&this.validResults&&(this.contactsResults.collectionModel&&this.renderContacts(this.contactsResults.collectionModel.getValue("contacts").getList(),!0),this.renderContacts(this.allResults.collectionModel.getValue("contacts").getList(),!1)),this},activate:function(){return this.registerEventHandler(e.globalEvents.subscribe("window:scroll",this.handleScroll.bind(this))),this},buildNoMatchesFoundMessage:function(){var t,s;return s=this.searchTerm?"search.NO_MATCHES_FOR_QUERY_TERM_WITH_SETTINGS":"search.NO_MATCHES_FOR_QUERY",t=this.searchTerm?this.intlMessage({intlName:s,searchTerm:e.flutil.unescape(this.searchTerm)}):this.intlMessage({intlName:s}),{noMatchesText:t}},loadNextPage:function(t){var s,r=t?this.contactsResults:this.allResults,a=this;if(this.scrollInterruptState.footer||(this.scrollInterruptState.footer=e.one(this.scrollInterruptParams.footerToHideWhileScrolling),this.scrollInterruptState.footer&&(this.scrollInterruptState.footerHeight=this.scrollInterruptState.footer.get("clientHeight"),this.scrollInterruptState.footer.addClass("infinite-scroll-hide-footer"))),r&&r.paginator&&(s=r.collectionModel?r.collectionModel.getValue("contacts"):null,!(s.fetchedEnd&&r.paginator.page>=s.totalPages)))return this.stillLoadingResults=!0,this.get("showThrobberDuringLoad")&&this.toggleThrobber(!0),r.paginator.next().then(function(e){a.stillLoadingResults=!1,a.get("showThrobberDuringLoad")&&a.toggleThrobber(!1),e&&(a.renderContacts(e,t),t||s.fetchedEnd||(a.scrollInterruptState.numPagesLoaded++,a.checkScrollInterruptionState(),a.handleScroll(null))),s.fetchedEnd&&a.scrollInterruptState.footer.removeClass("infinite-scroll-hide-footer")}.bind(this)).catch(e.PromiseCatcher(a.name))},renderContacts:function(t,s){var r,a=[],l=this.get("container"),i=this;return e.Array.each(t,function(t){if(t){var s={isPro:!!i.appContext.flipper.isFlipped("enable-pro-badge")&&t.getValue("isPro"),link:t.getValue("profileURL"),avatar:{type:"person",title:t.getValue("username"),url:t.getValue("buddyicon"),personNsid:t.getValue("nsid")},title:{text:t.getValue("realname")||t.getValue("username")},subtitles:[t.getValue("username")||""],links:[],linksMetadata:i.intlMessage({intlName:"search.JOINED_DATE",intlDate:t.getValue("dateJoined").toDate()}),cta:{followPlaceholderId:"follow"+t.getValue("nsid").replace("@","")}},r=e.flutil.formatNumbers(t.getValue("photosCount")),o=e.flutil.formatNumbers(t.getValue("followersCount"));t.getValue("photosCount")&&s.links.push({url:t.getValue("profileURL"),text:'<i class="photos-icon"></i>'+r}),t.getValue("followersCount")&&s.links.push({url:t.getValue("profileURL"),text:'<i class="members-icon"></i>'+o}),i.instantiateSubview("follow-view",{nsid:t.getValue("nsid"),pathAlias:t.getValue("pathAlias"),isFluid:!0}).then(function(e){return e.initialize()}).then(function(e){l.one("#"+s.cta.followPlaceholderId).replace(e.get("container")),e.normalizedActivate()}),a.push(s)}}),r=this.templates("result-cards")({results:a}),s?(this.contactsResults.renderedPages.push(r),t.length>0&&(l.one("#people-results-my").append(r),l.one(".my-people").removeClass("hidden"))):(this.allResults.renderedPages.push(r),t.length>0&&(l.one("#people-results-all").append(r),l.one(".all-people").removeClass("hidden"))),r},handleScroll:function(t){if(!(this.allResults.collectionModel&&this.allResults.collectionModel.getValue("contacts").fetchedEnd||this.scrollInterruptState.isInterrupted)){var s=this.get("container"),r=this.appContext.viewportData.getHeight(),a=s.get("clientHeight"),l=e.config.win.pageYOffset,i=s.getY()+a,o=l+r;!this.stillLoadingResults&&i-o<5*r&&this.loadNextPage()}},checkScrollInterruptionState:function(e){if(this.scrollInterruptState||e){var t;if(this.scrollInterruptState.numPagesLoaded>=this.scrollInterruptState.nextInterrupt){if(this.scrollInterruptState.numInterrupts++,t=this.scrollInterruptParams.pageCounts[this.scrollInterruptParams.pageCounts.length-1],this.scrollInterruptState.numInterrupts>=this.scrollInterruptParams.pageCounts.length)switch(this.scrollInterruptParams.repeatMode){case"exponential":this.scrollInterruptState.nextInterrupt+=t*Math.pow(2,this.scrollInterruptState.numInterrupts-this.scrollInterruptParams.pageCounts.length);break;case"linear":default:this.scrollInterruptState.nextInterrupt+=t}else this.scrollInterruptState.nextInterrupt+=this.scrollInterruptParams.pageCounts[this.scrollInterruptState.numInterrupts];e||this.interruptScroll()}}},interruptScroll:function(){this.scrollInterruptState.isInterrupted||(this.scrollInterruptState.isInterrupted=!0,this.scrollInterruptState.loadMoreElement||(this.scrollInterruptState.loadMoreElement=e.Node.create(this.templates("infinite-scroll-load-more")({}))),this.get("container").append(this.scrollInterruptState.loadMoreElement),this.scrollInterruptState.loadMoreElementHeight||(this.scrollInterruptState.loadMoreElementHeight=this.scrollInterruptState.loadMoreElement.get("clientHeight"),this.registerEventHandler(this.scrollInterruptState.loadMoreElement.on("click",this.onLoadMoreClicked.bind(this)))),this.scrollInterruptState.footer&&this.scrollInterruptState.footer.removeClass("infinite-scroll-hide-footer"))},onLoadMoreClicked:function(e){this.scrollInterruptState.isInterrupted&&(this.scrollInterruptState.isInterrupted=!1,this.scrollInterruptState.loadMoreElement.remove(),this.scrollInterruptState.footer&&this.scrollInterruptState.footer.addClass("infinite-scroll-hide-footer"),this.loadNextPage())},toggleThrobber:function(e){var t=this.get("container");void 0===e&&(e=!this.get("isThrobberShowing")),e?this.get("throbberNode").appendTo(t):this.get("throbberNode").remove(),this._set("isThrobberShowing",e)}},{ATTRS:{showThrobberDuringLoad:{value:!0,validator:function(t,s){return e.AttributeHelpers.validateBoolean(t)}},isThrobberShowing:{readOnly:!0,value:!1},throbberNode:{readOnly:!0,getter:function(t){return YUI.Env.isServer||void 0!==t||(t=e.Node.create('<div style="position: absolute; bottom: 50px; left: 0; right: 0;"><div class="flickr-dots small"></div></div>'),this._set("throbberNode",t)),t}}}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","search-url","hermes-template-search-people-results-view","hermes-template-infinite-scroll-load-more","hermes-template-result-card","hermes-template-result-cards","collection-paginator","follow-view","search-empty-view"],langBundles:["search","common"]});
YUI.add("search-people-page-view",function(e){var r=e.url("/help/forum/en-us/72157651248603362/lastpage#reply");e.namespace("Views")[this.name]=e.Base.create("search-people-page-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.apiFailed=e.apiFailed,this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-subnav-slender-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-people-results-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1},"feedback-widget-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,feedbackUrl:r,trackingSlk:"search-people-feedback",hidden:!0},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("search-people-page"),this},activate:function(){return this.fire("parentViewEvent","unhideFeedbackWidget"),this}},{ATTRS:{spaceid:{value:792600564}}})},"@VERSION@",{requires:["url","flickr-view","flickr-promise","global-nav-view","feedback-widget-view","footer-full-view","search-helper","hermes-template-search-people-page","search-subnav-slender-view","search-people-results-view"],langBundles:["search"]});
YUI.add("search-people-route",function(e,r){function a(e){a.superclass.constructor.call(this,e)}var s=require("lib/flog")(r);e.Routes[this.name]=a,e.extend(a,e.FlickrRoute,{langBundles:this.details.langBundles,run:function(r){var a,t={},l=this,i={};return t.apiParams=this.processRequest(r),t.viewerNsid=r.probableUser||this.appContext.getViewer().nsid,a=this.generateSearchParams(t),a.all&&(i.all=this.appContext.getModel("search-contacts-models",a.all.id,a.all.apiParams)),a.contacts&&(i.contacts=this.appContext.getModel("search-contacts-models",a.contacts.id,a.contacts.apiParams)),e.FlickrPromise(i).then(function(r){var s=t.apiParams&&t.apiParams.username,i=l.intlMessage({intlName:"search.SEARCH"});return void 0!==s&&(i+=": "+s),e.Promise.resolve({title:i,view:"search-people-page-view",layout:"scrolling",params:{searchParams:a,searchType:e.SearchUrl.searchTypes.PEOPLE,modelParams:t,searchTerm:s}})},function(r){s.error({err:r});var a=t.apiParams&&t.apiParams.username,i=l.intlMessage({intlName:"search.SEARCH"});return void 0!==a&&(i+=": "+a),e.Promise.resolve({title:i,view:"search-people-page-view",params:{searchTerm:a,apiFailed:!0}})})},generateSearchParams:function(r){var a,s={},t=r.apiParams||{};return e.SearchHelper.isParameterlessSearch(t)?s:(this.shouldPerformAllPeopleSearch(r,t)&&(a=new e.SearchUrl(t,this.appContext,e.SearchUrl.searchTypes.PEOPLE),s.all={id:a.getId(),apiParams:e.merge(a.getAPIParams(),{perPage:50})}),this.shouldPerformContactsSearch(r,t)&&(a=new e.SearchUrl(e.merge(t,{user_id:r.viewerNsid}),this.appContext,e.SearchUrl.searchTypes.PEOPLE),s.contacts={id:a.getId(),apiParams:e.merge(a.getAPIParams(),{perPage:200})}),s)},shouldPerformAllPeopleSearch:function(r,a){return!!a[e.SearchHelper.PEOPLE_SEARCH_API.username]},shouldPerformContactsSearch:function(r,a){return a[e.SearchHelper.PEOPLE_SEARCH_API.username]&&r.viewerNsid&&!a[e.SearchHelper.PEOPLE_SEARCH_API.userId]},processRequest:function(r){var a=null;return a=e.SearchHelper.mapClassicPeopleSearchToAPI(r.query,this.appContext),r.query.text&&(a.username=r.query.text),e.SearchHelper.addPeopleParamDefaults(a),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(a),a}}),e.mix(a.prototype,e.Localizable)},"@VERSION@",{requires:["flickr-route","flickr-promise","search-helper","querystring-stringify-simple","localizable","url","search-url","search-people-page-view"],langBundles:["search"]});
